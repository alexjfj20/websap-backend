{"version":3,"file":"js/app.6e3e3e2b.js","mappings":"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","sources":["webpack://websap/./src/services/apiService.js","webpack://websap/./src/services/authService.js","webpack://websap/./src/services/indexedDBService.js","webpack://websap/./src/config/apiConfig.js","webpack://websap/./src/services/dialogService.js","webpack://websap/./src/services/reservaService.js","webpack://websap/./src/utils/eventBus.js","webpack://websap/./src/services/imageService.js","webpack://websap/./src/App.vue","webpack://websap/./src/components/DialogContainer.vue","webpack://websap/./src/components/DialogContainer.vue?32d6","webpack://websap/./src/components/WhatsAppReservationHandler.vue","webpack://websap/./src/components/WhatsAppReservationHandler.vue?8c2a","webpack://websap/./src/components/WhatsAppSimulator.vue","webpack://websap/./src/components/WhatsAppSimulator.vue?8dd5","webpack://websap/./src/utils/whatsappSimulator.js","webpack://websap/./src/utils/testReservations.js","webpack://websap/./src/services/webSocketService.js","webpack://websap/./src/utils/connectionHandler.js","webpack://websap/./src/services/syncService.js","webpack://websap/./src/App.vue?7ccd","webpack://websap/./src/views/HomeView.vue","webpack://websap/./src/views/HomeView.vue?1da1","webpack://websap/./src/views/LoginView.vue","webpack://websap/./src/views/LoginView.vue?5755","webpack://websap/./src/router/index.js","webpack://websap/./src/services/dbInitializer.js","webpack://websap/./src/main.js","webpack://websap/webpack/bootstrap","webpack://websap/webpack/runtime/chunk loaded","webpack://websap/webpack/runtime/compat get default export","webpack://websap/webpack/runtime/create fake namespace object","webpack://websap/webpack/runtime/define property getters","webpack://websap/webpack/runtime/ensure chunk","webpack://websap/webpack/runtime/get javascript chunk filename","webpack://websap/webpack/runtime/get mini-css chunk filename","webpack://websap/webpack/runtime/global","webpack://websap/webpack/runtime/hasOwnProperty shorthand","webpack://websap/webpack/runtime/load script","webpack://websap/webpack/runtime/make namespace object","webpack://websap/webpack/runtime/publicPath","webpack://websap/webpack/runtime/css loading","webpack://websap/webpack/runtime/jsonp chunk loading","webpack://websap/webpack/startup"],"sourcesContent":["import apiConfig from '../config/apiConfig';\n\n// URL base de la API\nconst API_URL = apiConfig.API_URL;\n\n// Token de autenticación\nlet token = localStorage.getItem('token') || '';\n\n/**\n * Configura el token de autenticación\n * @param {string} newToken \n */\nconst setToken = (newToken) => {\n  token = newToken;\n  if (newToken) {\n    localStorage.setItem('token', newToken);\n  } else {\n    localStorage.removeItem('token');\n  }\n};\n\n/**\n * Realiza una petición GET a la API\n * @param {string} endpoint - Ruta de la API\n * @param {Object} options - Opciones adicionales\n * @returns {Promise<any>} - Respuesta de la API\n */\nconst get = async (endpoint, options = {}) => {\n  try {\n    const headers = {\n      'Content-Type': 'application/json',\n      ...(token && { 'Authorization': `Bearer ${token}` }),\n      ...(options.headers || {})\n    };\n    \n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'GET',\n      headers,\n      ...options\n    });\n    \n    if (options.responseType === 'blob') {\n      return response.blob();\n    }\n    \n    // Si la respuesta no es JSON, devolver el texto\n    const contentType = response.headers.get('content-type');\n    if (!contentType || !contentType.includes('application/json')) {\n      const text = await response.text();\n      return {\n        success: response.ok,\n        data: text,\n        status: response.status\n      };\n    }\n    \n    const data = await response.json();\n    \n    // Si la respuesta tiene un código 401 o 403, podría ser un problema de autenticación\n    if (response.status === 401 || response.status === 403) {\n      console.warn(`Error de autenticación en ${endpoint}:`, data);\n      \n      // Si estamos en desarrollo, permitir continuar con una respuesta simulada\n      if (process.env.NODE_ENV === 'development') {\n        console.log('Modo desarrollo: devolviendo respuesta simulada para', endpoint);\n        return {\n          success: false,\n          error: data.message || 'Error de autenticación',\n          status: response.status,\n          simulatedResponse: true\n        };\n      }\n    }\n    \n    if (!response.ok) {\n      throw new Error(data.message || 'Error en la petición');\n    }\n    \n    return data;\n  } catch (error) {\n    console.error(`Error en GET ${endpoint}:`, error);\n    throw error;\n  }\n};\n\n/**\n * Realiza una petición POST a la API\n * @param {string} endpoint - Ruta de la API\n * @param {Object} body - Cuerpo de la petición\n * @param {Object} options - Opciones adicionales\n * @returns {Promise<any>} - Respuesta de la API\n */\nconst post = async (endpoint, body = {}, options = {}) => {\n  try {\n    const headers = {\n      'Content-Type': 'application/json',\n      ...(token && { 'Authorization': `Bearer ${token}` }),\n      ...(options.headers || {})\n    };\n    \n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(body),\n      ...options\n    });\n    \n    const data = await response.json();\n    \n    if (!response.ok) {\n      throw new Error(data.message || 'Error en la petición');\n    }\n    \n    return data;\n  } catch (error) {\n    console.error(`Error en POST ${endpoint}:`, error);\n    throw error;\n  }\n};\n\n/**\n * Realiza una petición PUT a la API\n * @param {string} endpoint - Ruta de la API\n * @param {Object} body - Cuerpo de la petición\n * @param {Object} options - Opciones adicionales\n * @returns {Promise<any>} - Respuesta de la API\n */\nconst put = async (endpoint, body = {}, options = {}) => {\n  try {\n    const headers = {\n      'Content-Type': 'application/json',\n      ...(token && { 'Authorization': `Bearer ${token}` }),\n      ...(options.headers || {})\n    };\n    \n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'PUT',\n      headers,\n      body: JSON.stringify(body),\n      ...options\n    });\n    \n    const data = await response.json();\n    \n    if (!response.ok) {\n      throw new Error(data.message || 'Error en la petición');\n    }\n    \n    return data;\n  } catch (error) {\n    console.error(`Error en PUT ${endpoint}:`, error);\n    throw error;\n  }\n};\n\n/**\n * Realiza una petición DELETE a la API\n * @param {string} endpoint - Ruta de la API\n * @param {Object} options - Opciones adicionales\n * @returns {Promise<any>} - Respuesta de la API\n */\nconst del = async (endpoint, options = {}) => {\n  try {\n    const headers = {\n      'Content-Type': 'application/json',\n      ...(token && { 'Authorization': `Bearer ${token}` }),\n      ...(options.headers || {})\n    };\n    \n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'DELETE',\n      headers,\n      ...options\n    });\n    \n    const data = await response.json();\n    \n    if (!response.ok) {\n      throw new Error(data.message || 'Error en la petición');\n    }\n    \n    return data;\n  } catch (error) {\n    console.error(`Error en DELETE ${endpoint}:`, error);\n    throw error;\n  }\n};\n\nexport default {\n  setToken,\n  get,\n  post,\n  put,\n  delete: del\n};\n","import axios from 'axios';\nimport apiConfig from '../config/apiConfig';\n\nconst API_URL = apiConfig.API_URL;\n\n// Función para guardar token en localStorage\nconst saveToken = (token) => {\n  localStorage.setItem('token', token);\n};\n\n// Función para obtener token de localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Función para eliminar token de localStorage\nconst removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Configurar Axios\nconst setupAxiosInterceptors = () => {\n  // Interceptor de solicitudes\n  axios.interceptors.request.use(\n    (config) => {\n      const token = getToken();\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    },\n    (error) => {\n      return Promise.reject(error);\n    }\n  );\n  \n  // Interceptor de respuestas\n  axios.interceptors.response.use(\n    (response) => {\n      return response;\n    },\n    (error) => {\n      // Si el error es 401, puede ser que el token expiró\n      if (error.response && error.response.status === 401) {\n        removeToken();\n        // Redirigir a la página de login (esto debe ser manejado por el router)\n        if (window.location.pathname !== '/login') {\n          window.location.href = '/login';\n        }\n      }\n      return Promise.reject(error);\n    }\n  );\n};\n\n// Inicializar interceptores\nsetupAxiosInterceptors();\n\n// Función para iniciar sesión\nasync function login(email, password) {\n  console.log('Intentando iniciar sesión con:', email);\n  \n  try {\n    // Limpiar cualquier información de usuario anterior\n    removeToken();\n    localStorage.removeItem('user');\n    localStorage.removeItem('isLoggedIn');\n    \n    // Intentar iniciar sesión con el backend\n    console.log('Enviando solicitud al backend:', `${API_URL}/auth/login`);\n    const response = await axios.post(`${API_URL}/auth/login`, {\n      email,\n      password\n    }, {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      // No enviar cookies\n      withCredentials: false,\n      // Aumentar el timeout para evitar errores de conexión\n      timeout: 10000\n    });\n    \n    console.log('Respuesta del backend:', response.status, response.data);\n    \n    if (response.status === 200 && response.data.success) {\n      console.log('Login exitoso con el backend');\n      // Guardar token\n      const token = response.data.data.token;\n      saveToken(token);\n      \n      // Actualizar el token en el servicio API\n      import('./apiService').then(apiService => {\n        console.log('Actualizando token en apiService');\n        apiService.default.setToken(token);\n      });\n      \n      // Guardar información del usuario en localStorage\n      localStorage.setItem('user', JSON.stringify(response.data.data.user));\n      \n      // Establecer explícitamente el estado de autenticación\n      localStorage.setItem('isLoggedIn', 'true');\n      \n      return {\n        success: true,\n        user: response.data.data.user\n      };\n    } else {\n      console.error('Respuesta inesperada del servidor:', response.data);\n      throw new Error('Respuesta inesperada del servidor');\n    }\n  } catch (error) {\n    // Verificar si el error es de red o del servidor\n    if (error.response) {\n      // El servidor respondió con un código de estado fuera del rango 2xx\n      console.error('Error de respuesta del servidor:', error.response.status, error.response.data);\n      \n      // Verificar si es un error específico de usuario desactivado\n      if (error.response.data && error.response.data.message) {\n        // Si el mensaje contiene la palabra \"desactivado\", mostrar ese mensaje específico\n        if (error.response.data.message.includes('desactivado')) {\n          throw new Error(error.response.data.message);\n        }\n      }\n    } else if (error.request) {\n      // La solicitud se realizó pero no se recibió respuesta\n      console.error('No se recibió respuesta del servidor:', error.request);\n    } else {\n      // Algo sucedió al configurar la solicitud\n      console.error('Error al configurar la solicitud:', error.message);\n    }\n    \n    console.log('Fallback a autenticación local...');\n    \n    // Datos de usuarios locales para desarrollo/pruebas\n    const localUsers = [\n      {\n        id: 1,\n        email: 'superadmin@example.com',\n        password: '123456',\n        nombre: 'Super Administrador',\n        roles: ['Superadministrador']\n      },\n      {\n        id: 2,\n        email: 'admin@example.com',\n        password: '123456',\n        nombre: 'Administrador',\n        roles: ['Administrador']\n      },\n      {\n        id: 3,\n        email: 'empleado@example.com',\n        password: '123456',\n        nombre: 'Empleado',\n        roles: ['Empleado']\n      },\n      // Añadir el usuario alex para pruebas locales\n      {\n        id: 5,\n        email: 'alex@gmail.com',\n        password: 'password',\n        nombre: 'alex',\n        roles: ['Empleado']\n      }\n    ];\n    \n    // Buscar usuario local\n    const user = localUsers.find(u => u.email === email && u.password === password);\n    \n    if (user) {\n      console.log('Login exitoso con usuario local:', user.email);\n      // Si el usuario local es válido, establecer el estado de autenticación\n      localStorage.setItem('isLoggedIn', 'true');\n      \n      // Crear un token local\n      const localToken = `local_${btoa(JSON.stringify(user))}`;\n      saveToken(localToken);\n      \n      // Actualizar el token en el servicio API\n      import('./apiService').then(apiService => {\n        console.log('Actualizando token en apiService (local)');\n        apiService.default.setToken(localToken);\n      });\n      \n      // Guardar usuario en localStorage\n      localStorage.setItem('user', JSON.stringify({\n        id: user.id,\n        email: user.email,\n        nombre: user.nombre,\n        roles: user.roles\n      }));\n      \n      return {\n        success: true,\n        user: {\n          id: user.id,\n          email: user.email,\n          nombre: user.nombre,\n          roles: user.roles\n        }\n      };\n    }\n    \n    // Si no se encontró usuario local\n    throw new Error('Credenciales incorrectas');\n  }\n}\n\n// Función para cerrar sesión\nconst logout = () => {\n  removeToken();\n  localStorage.removeItem('user');\n  localStorage.removeItem('isLoggedIn');\n};\n\n// Función para verificar si el usuario está autenticado\nconst isAuthenticated = () => {\n  const token = getToken();\n  const isLoggedInFlag = localStorage.getItem('isLoggedIn') === 'true';\n  return !!token && isLoggedInFlag;\n};\n\n// Función para obtener el usuario actual\nconst getCurrentUser = () => {\n  try {\n    const userStr = localStorage.getItem('user');\n    if (!userStr) {\n      console.log('No hay usuario en localStorage');\n      return null;\n    }\n    \n    const user = JSON.parse(userStr);\n    console.log('Usuario actual obtenido de localStorage:', user.email);\n    return user;\n  } catch (error) {\n    console.error('Error al obtener el usuario actual:', error);\n    return null;\n  }\n};\n\n// Función para verificar si el usuario tiene un rol específico\nconst hasRole = (role) => {\n  const user = getCurrentUser();\n  return user && user.roles && user.roles.includes(role);\n};\n\n// Función para verificar si el usuario es administrador\nconst isAdmin = () => {\n  return hasRole('Administrador') || hasRole('Superadministrador');\n};\n\n// Función para verificar si el usuario es superadministrador\nconst isSuperAdmin = () => {\n  return hasRole('Superadministrador');\n};\n\nexport {\n  login,\n  logout,\n  isAuthenticated,\n  getCurrentUser,\n  hasRole,\n  isAdmin,\n  isSuperAdmin,\n  getToken,\n  removeToken\n};\n","import { openDB } from 'idb';\nimport { v4 as uuidv4 } from 'uuid';\nimport apiConfig from '../config/apiConfig';\n\nconst API_BASE_URL = apiConfig.API_DOMAIN; // URL base para la API\nconst DB_NAME = 'restauranteAppDB'; // Usar este nombre para todas las operaciones\nconst DB_VERSION = 4; // Incrementar la versión para forzar una actualización del esquema\nconst PLATOS_STORE = 'platos'; // Usar 'platos' en lugar de 'menuItems'\nconst SYNC_QUEUE_STORE = 'syncQueue';\n\n// Inicializar la base de datos\nconst initDB = () => {\n  return new Promise((resolve, reject) => {\n    console.log(`Intentando abrir la base de datos con versión: ${DB_VERSION}`);\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    \n    request.onerror = (event) => {\n      console.error('Error al abrir la base de datos IndexedDB:', event);\n      reject('Error al abrir la base de datos');\n    };\n    \n    request.onsuccess = (event) => {\n      const db = event.target.result;\n      console.log('IndexedDB inicializada correctamente');\n      resolve(db);\n    };\n    \n    request.onupgradeneeded = (event) => {\n      const db = event.target.result;\n      console.log('Actualizando estructura de la base de datos...');\n      \n      // Crear almacén para platos si no existe\n      if (!db.objectStoreNames.contains(PLATOS_STORE)) {\n        console.log('Creando almacén de platos...');\n        // Quitar autoIncrement para permitir IDs personalizados\n        const platosStore = db.createObjectStore(PLATOS_STORE, { keyPath: 'id' });\n        platosStore.createIndex('name', 'name', { unique: false });\n        platosStore.createIndex('syncStatus', 'syncStatus', { unique: false });\n        console.log('Almacén de platos creado');\n      } else {\n        console.log('El almacén de platos ya existe');\n        \n        // Si necesitamos modificar un almacén existente, primero hay que eliminarlo\n        // y luego volver a crearlo con la nueva configuración\n        try {\n          db.deleteObjectStore(PLATOS_STORE);\n          console.log('Almacén de platos eliminado para recreación');\n          \n          const platosStore = db.createObjectStore(PLATOS_STORE, { keyPath: 'id' });\n          platosStore.createIndex('name', 'name', { unique: false });\n          platosStore.createIndex('syncStatus', 'syncStatus', { unique: false });\n          console.log('Almacén de platos recreado con nueva configuración');\n        } catch (error) {\n          console.error('Error al intentar modificar el almacén de platos:', error);\n        }\n      }\n      \n      // Crear almacén para la cola de sincronización si no existe\n      if (!db.objectStoreNames.contains(SYNC_QUEUE_STORE)) {\n        console.log('Creando almacén de cola de sincronización...');\n        const syncQueueStore = db.createObjectStore(SYNC_QUEUE_STORE, { keyPath: 'id', autoIncrement: true });\n        syncQueueStore.createIndex('timestamp', 'timestamp', { unique: false });\n        syncQueueStore.createIndex('type', 'type', { unique: false });\n        console.log('Almacén de cola de sincronización creado');\n      } else {\n        console.log('El almacén de cola de sincronización ya existe');\n      }\n    };\n  });\n};\n\n// Abrir conexión a la base de datos\nconst openDatabase = async () => {\n  try {\n    return await initDB();\n  } catch (error) {\n    console.error('Error al abrir conexión a IndexedDB:', error);\n    throw error;\n  }\n};\n\n// Obtener todos los platos de IndexedDB\nconst getAllPlatos = async () => {\n  try {\n    console.log('Obteniendo todos los platos de IndexedDB...');\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([PLATOS_STORE], 'readonly');\n      const store = transaction.objectStore(PLATOS_STORE);\n      const request = store.getAll();\n      \n      request.onsuccess = (event) => {\n        const allPlatos = event.target.result;\n        console.log(`Obtenidos ${allPlatos.length} platos totales de IndexedDB`);\n        \n        // Filtrar platos eliminados\n        const activePlatos = allPlatos.filter(plato => !plato.deleted);\n        console.log(`Filtrando platos eliminados: ${allPlatos.length - activePlatos.length} platos ocultos, ${activePlatos.length} platos activos`);\n        \n        resolve(activePlatos);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al obtener platos de IndexedDB:', event);\n        reject('Error al obtener platos localmente');\n      };\n    });\n  } catch (error) {\n    console.error('Error en getAllPlatos:', error);\n    throw error;\n  }\n};\n\n// Obtener platos pendientes de sincronización\nconst getPendingPlatos = async () => {\n  try {\n    console.log('Buscando platos pendientes de sincronización...');\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([PLATOS_STORE], 'readonly');\n      const store = transaction.objectStore(PLATOS_STORE);\n      const index = store.index('syncStatus');\n      const request = index.getAll('pending');\n      \n      request.onsuccess = (event) => {\n        const pendingPlatos = event.target.result;\n        console.log(`Encontrados ${pendingPlatos.length} platos pendientes de sincronización`);\n        resolve(pendingPlatos);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al obtener platos pendientes:', event);\n        reject('Error al obtener platos pendientes');\n      };\n    });\n  } catch (error) {\n    console.error('Error en getPendingPlatos:', error);\n    throw error;\n  }\n};\n\n// Actualizar estado de sincronización de un plato\nconst updatePlatoSyncStatus = async (id, status) => {\n  console.log(`Actualizando estado de sincronización del plato ID ${id} a \"${status}\"...`);\n  \n  // Convertir booleanos a strings para compatibilidad\n  let validStatus = status;\n  if (typeof status === 'boolean') {\n    validStatus = status === true ? 'synced' : 'pending';\n    console.log(`Convertido estado booleano ${status} a \"${validStatus}\"`);\n  }\n  \n  // Validar que el estado sea uno de los permitidos\n  const validStatuses = ['pending', 'synced', 'pending_deletion'];\n  if (!validStatuses.includes(validStatus)) {\n    throw new Error(`Estado inválido: ${status}. Debe ser uno de: ${validStatuses.join(', ')}`);\n  }\n  \n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    \n    request.onerror = (event) => {\n      console.error('Error al abrir la base de datos:', event.target.error);\n      reject(new Error('No se pudo abrir la base de datos para actualizar el estado.'));\n    };\n    \n    request.onsuccess = (event) => {\n      const db = event.target.result;\n      \n      try {\n        const transaction = db.transaction([PLATOS_STORE], 'readwrite');\n        const platosStore = transaction.objectStore(PLATOS_STORE);\n        \n        // Obtener el plato primero\n        const getRequest = platosStore.get(id);\n        \n        getRequest.onerror = (event) => {\n          console.error(`Error al obtener plato ID ${id}:`, event.target.error);\n          reject(new Error(`No se pudo obtener el plato ID ${id}.`));\n        };\n        \n        getRequest.onsuccess = (event) => {\n          const plato = event.target.result;\n          \n          if (!plato) {\n            console.error(`No se encontró plato con ID ${id}.`);\n            reject(new Error(`No se encontró plato con ID ${id}.`));\n            return;\n          }\n          \n          // Actualizar el estado de sincronización\n          plato.syncStatus = validStatus;\n          \n          // Si es pending_deletion, marcar como no disponible también\n          if (validStatus === 'pending_deletion') {\n            plato.is_available = false;\n          }\n          \n          // Guardar el plato actualizado\n          const updateRequest = platosStore.put(plato);\n          \n          updateRequest.onerror = (event) => {\n            console.error(`Error al actualizar plato ID ${id}:`, event.target.error);\n            reject(new Error(`No se pudo actualizar el estado del plato ID ${id}.`));\n          };\n          \n          updateRequest.onsuccess = () => {\n            console.log(`Estado de sincronización del plato ID ${id} actualizado a \"${validStatus}\".`);\n            resolve(true);\n          };\n        };\n        \n        transaction.oncomplete = () => {\n          db.close();\n        };\n      } catch (error) {\n        console.error('Error en la transacción:', error);\n        reject(error);\n      }\n    };\n  });\n};\n\n// Agregar elemento a la cola de sincronización\nconst addToSyncQueue = async (item) => {\n  try {\n    console.log('Agregando elemento a la cola de sincronización:', item);\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([SYNC_QUEUE_STORE], 'readwrite');\n      const store = transaction.objectStore(SYNC_QUEUE_STORE);\n      \n      const request = store.add(item);\n      \n      request.onsuccess = (event) => {\n        console.log('Elemento agregado a la cola de sincronización');\n        resolve(event.target.result);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al agregar a la cola de sincronización:', event);\n        reject('Error al agregar a la cola de sincronización');\n      };\n    });\n  } catch (error) {\n    console.error('Error en addToSyncQueue:', error);\n    throw error;\n  }\n};\n\n// Obtener elementos de la cola de sincronización\nconst getSyncQueue = async () => {\n  try {\n    console.log('Obteniendo cola de sincronización...');\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([SYNC_QUEUE_STORE], 'readonly');\n      const store = transaction.objectStore(SYNC_QUEUE_STORE);\n      const request = store.getAll();\n      \n      request.onsuccess = (event) => {\n        const queue = event.target.result;\n        console.log(`Obtenidos ${queue.length} elementos de la cola de sincronización`);\n        resolve(queue);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al obtener cola de sincronización:', event);\n        reject('Error al obtener cola de sincronización');\n      };\n    });\n  } catch (error) {\n    console.error('Error en getSyncQueue:', error);\n    throw error;\n  }\n};\n\n// Eliminar elemento de la cola de sincronización\nconst removeFromSyncQueue = async (id) => {\n  try {\n    console.log(`Eliminando elemento ${id} de la cola de sincronización...`);\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([SYNC_QUEUE_STORE], 'readwrite');\n      const store = transaction.objectStore(SYNC_QUEUE_STORE);\n      \n      const request = store.delete(id);\n      \n      request.onsuccess = () => {\n        console.log(`Elemento ${id} eliminado de la cola de sincronización`);\n        resolve(true);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al eliminar de la cola de sincronización:', event);\n        reject('Error al eliminar de la cola de sincronización');\n      };\n    });\n  } catch (error) {\n    console.error('Error en removeFromSyncQueue:', error);\n    throw error;\n  }\n};\n\n// Eliminar un plato de IndexedDB y sincronizar con el servidor\nconst deletePlato = async (id) => {\n  try {\n    console.log(`Iniciando proceso de eliminación para plato ID: ${id}`);\n    \n    // Verificar si estamos en línea\n    const online = typeof navigator !== 'undefined' && navigator.onLine;\n    \n    if (online) {\n      try {\n        console.log(`Enviando solicitud al servidor para eliminar plato ID: ${id}`);\n        \n        // Usamos una URL absoluta para asegurarnos de que la solicitud llegue al servidor correcto\n        const serverUrl = 'http://localhost:3000/api/sync/platos';\n        console.log(`URL completa para sincronización: ${serverUrl}`);\n        \n        // Enviar una solicitud POST con operation=delete en lugar de DELETE\n        // Esto es más compatible con algunos servidores y proxies\n        const response = await fetch(serverUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            id: id,\n            operation: 'delete'\n          })\n        });\n        \n        // Registrar detalles completos de la respuesta para depuración\n        console.log(`Respuesta del servidor: Status ${response.status}`);\n        let responseText = '';\n        try {\n          responseText = await response.text();\n          console.log(`Respuesta completa: ${responseText}`);\n          const data = JSON.parse(responseText);\n          \n          if (response.ok) {\n            console.log(`✅ Plato ID ${id} eliminado con éxito del servidor:`, data);\n            \n            // Si se eliminó correctamente del servidor, ahora lo eliminamos de IndexedDB\n            await deleteFromIndexedDB(id);\n            return true;\n          } else {\n            console.error(`❌ Error al eliminar plato ID ${id} del servidor:`, data);\n            // Si hay error en el servidor, marcamos para eliminación y eliminamos localmente\n            await markPlatoForDeletion(id);\n            return true;\n          }\n        } catch (parseError) {\n          console.error(`Error al procesar respuesta: ${responseText}`, parseError);\n          await markPlatoForDeletion(id);\n          return true;\n        }\n      } catch (syncError) {\n        console.error(`❌ Error de red al sincronizar eliminación del plato ID ${id}:`, syncError);\n        // Si hay error de red, marcamos para eliminación y eliminamos localmente\n        await markPlatoForDeletion(id);\n        return true;\n      }\n    } else {\n      console.log(`Sin conexión a internet, marcando plato ID ${id} para eliminación futura`);\n      // Si estamos offline, marcamos para eliminación y eliminamos localmente\n      await markPlatoForDeletion(id);\n      return true;\n    }\n  } catch (error) {\n    console.error(`❌ Error general al eliminar plato ID ${id}:`, error);\n    throw error;\n  }\n};\n\n// Función auxiliar para eliminar un plato solo de IndexedDB\nconst deleteFromIndexedDB = async (id) => {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    \n    request.onerror = (event) => {\n      console.error('Error al abrir la base de datos:', event.target.error);\n      reject(new Error('No se pudo abrir la base de datos para eliminar el plato'));\n    };\n    \n    request.onsuccess = (event) => {\n      const db = event.target.result;\n      \n      try {\n        const transaction = db.transaction([PLATOS_STORE], 'readwrite');\n        const platosStore = transaction.objectStore(PLATOS_STORE);\n        \n        const deleteRequest = platosStore.delete(id);\n        \n        deleteRequest.onerror = (event) => {\n          console.error(`Error al eliminar plato ID ${id}:`, event.target.error);\n          reject(new Error(`No se pudo eliminar el plato ID ${id}`));\n        };\n        \n        deleteRequest.onsuccess = () => {\n          console.log(`Plato ID ${id} eliminado con éxito de IndexedDB`);\n          resolve(true);\n        };\n        \n        transaction.oncomplete = () => {\n          db.close();\n        };\n      } catch (error) {\n        console.error('Error en la transacción:', error);\n        reject(error);\n      }\n    };\n  });\n};\n\n// Función para marcar un plato para eliminación\nconst markPlatoForDeletion = async (id) => {\n  try {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    \n    return new Promise((resolve, reject) => {\n      request.onerror = (event) => {\n        console.error('Error al abrir la base de datos:', event.target.error);\n        reject(new Error('No se pudo abrir la base de datos'));\n      };\n      \n      request.onsuccess = (event) => {\n        const db = event.target.result;\n        \n        try {\n          const transaction = db.transaction([PLATOS_STORE], 'readwrite');\n          const platosStore = transaction.objectStore(PLATOS_STORE);\n          \n          // Primero obtenemos el plato\n          const getRequest = platosStore.get(id);\n          \n          getRequest.onerror = (event) => {\n            console.error(`Error al obtener plato ID ${id}:`, event.target.error);\n            reject(new Error(`No se pudo obtener el plato ID ${id}`));\n          };\n          \n          getRequest.onsuccess = (event) => {\n            const plato = event.target.result;\n            \n            if (!plato) {\n              console.warn(`Plato ID ${id} no encontrado, no se puede marcar para eliminación`);\n              resolve(false);\n              return;\n            }\n            \n            // Marcar para eliminación\n            plato.syncStatus = 'pending_deletion';\n            plato.updated_at = new Date().toISOString();\n            \n            // Guardar los cambios\n            const updateRequest = platosStore.put(plato);\n            \n            updateRequest.onerror = (event) => {\n              console.error(`Error al marcar plato ID ${id} para eliminación:`, event.target.error);\n              reject(new Error(`No se pudo marcar el plato ID ${id} para eliminación`));\n            };\n            \n            updateRequest.onsuccess = () => {\n              console.log(`Plato ID ${id} marcado para eliminación`);\n              \n              // Ahora lo eliminamos de la vista del usuario (pero se mantiene en la base de datos para sincronización)\n              // Esto se hace añadiendo un flag 'deleted' que usamos para filtrar en las consultas\n              plato.deleted = true;\n              const finalUpdateRequest = platosStore.put(plato);\n              \n              finalUpdateRequest.onsuccess = () => {\n                console.log(`Plato ID ${id} marcado como eliminado para el usuario`);\n                resolve(true);\n              };\n              \n              finalUpdateRequest.onerror = (event) => {\n                console.error(`Error al marcar plato ID ${id} como eliminado:`, event.target.error);\n                reject(new Error(`No se pudo marcar el plato ID ${id} como eliminado`));\n              };\n            };\n          };\n          \n          transaction.oncomplete = () => {\n            db.close();\n          };\n        } catch (error) {\n          console.error('Error en la transacción:', error);\n          reject(error);\n        }\n      };\n    });\n  } catch (error) {\n    console.error(`Error general al marcar plato ID ${id} para eliminación:`, error);\n    throw error;\n  }\n};\n\n// Añadir esto al principio del archivo para depuración\nconst logDB = async () => {\n  const db = await openDB();\n  console.log('Bases de datos disponibles:', db.name, 'versión:', db.version);\n  console.log('Almacenes disponibles:', Array.from(db.objectStoreNames));\n};\n\n// Y llamarlo periódicamente para verificar\nsetInterval(logDB, 10000);\n\n// Verificar si un plato fue guardado correctamente (con timeout)\nconst verifyPlatoStorage = async (id) => {\n  try {\n    console.log(`Verificando almacenamiento del plato ID ${id}...`);\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([PLATOS_STORE], 'readonly');\n      const store = transaction.objectStore(PLATOS_STORE);\n      const request = store.get(id);\n      \n      request.onsuccess = (event) => {\n        const plato = event.target.result;\n        if (plato) {\n          console.log(`Verificación exitosa: Plato ID ${id} encontrado en IndexedDB:`, plato);\n          resolve(plato);\n        } else {\n          console.error(`Verificación fallida: Plato ID ${id} NO encontrado en IndexedDB`);\n          resolve(null);\n        }\n      };\n      \n      request.onerror = (event) => {\n        console.error(`Error al verificar plato ID ${id}:`, event.target.error);\n        reject(new Error(`Error al verificar plato ID ${id}: ${event.target.error.message}`));\n      };\n      \n      transaction.oncomplete = () => {\n        console.log('Transacción de verificación completada');\n      };\n    });\n  } catch (error) {\n    console.error('Error en verifyPlatoStorage:', error);\n    throw error;\n  }\n};\n\n/**\n * Crea un nuevo plato en la base de datos\n * @param {Object} plato - Datos del plato a crear\n * @returns {Promise<Object>} - Plato creado con su ID asignado\n */\nasync function createPlato(plato) {\n  console.log('🍽️ INICIO - Creando nuevo plato en IndexedDB:', plato);\n  \n  try {\n    // Validación de datos\n    if (!plato || typeof plato !== 'object') {\n      console.error('❌ ERROR: El plato debe ser un objeto válido', plato);\n      throw new Error('El plato debe ser un objeto válido');\n    }\n    \n    if (!plato.name || plato.name.trim() === '') {\n      console.error('❌ ERROR: El plato debe tener un nombre válido', plato);\n      throw new Error('El plato debe tener un nombre válido');\n    }\n    \n    console.log('✅ Validación inicial del plato exitosa');\n    \n    // Abrimos la BD con registro detallado\n    console.log('🔄 Abriendo base de datos...');\n    const db = await openDB();\n    console.log('✅ Base de datos abierta correctamente');\n    \n    return new Promise((resolve, reject) => {\n      console.log('🔄 Iniciando transacción para guardar plato...');\n      \n      try {\n        const transaction = db.transaction([PLATOS_STORE], 'readwrite');\n        console.log('✅ Transacción creada correctamente');\n        \n        const store = transaction.objectStore(PLATOS_STORE);\n        console.log('✅ Almacén obtenido correctamente');\n        \n        // Preparar el plato con todos los campos necesarios\n        const platoToCreate = {\n          ...plato,\n          createdAt: plato.createdAt || new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n          syncStatus: 'pending',\n          localTimestamp: new Date().getTime()\n        };\n        \n        // Asegurarse de que el plato tenga un ID\n        if (!platoToCreate.id) {\n          platoToCreate.id = `plato_${Date.now()}_${Math.floor(Math.random() * 10000)}`;\n          console.log(`🆔 Generando ID para el plato: ${platoToCreate.id}`);\n        }\n        \n        console.log('📦 Intentando guardar plato con datos:', platoToCreate);\n        // Usar put en lugar de add para actualizar si el ID ya existe\n        const request = store.put(platoToCreate);\n        \n        request.onsuccess = async (event) => {\n          // El ID ahora viene del objeto, no del evento\n          const id = platoToCreate.id;\n          console.log(`✅ ÉXITO: Plato guardado con ID: ${id}`);\n          \n          // Crear objeto completo con el ID\n          const createdPlato = { ...platoToCreate };\n          \n          // Agregar a la cola de sincronización\n          try {\n            console.log('🔄 Agregando plato a cola de sincronización...');\n            await addToSyncQueue({\n              type: 'create',\n              entityType: 'plato',\n              entityId: id,\n              data: createdPlato,\n              timestamp: new Date().getTime()\n            });\n            console.log('✅ Plato agregado a la cola de sincronización correctamente');\n          } catch (syncError) {\n            console.warn('⚠️ Error al agregar a cola de sincronización:', syncError);\n            // Continuamos a pesar de error en cola\n          }\n          \n          // Verificación inmediata para depuración\n          console.log('🔍 Verificando inmediatamente el almacenamiento del plato...');\n          try {\n            const platos = await getAllPlatos();\n            console.log(`📊 Total de platos en BD: ${platos.length}`);\n            console.log('📋 Lista de platos:', platos);\n            \n            const found = platos.find(p => p.id === id);\n            if (found) {\n              console.log('✅ VERIFICACIÓN EXITOSA: Plato encontrado en la lista completa');\n            } else {\n              console.error('❌ VERIFICACIÓN FALLIDA: Plato NO encontrado en la lista completa');\n            }\n          } catch (listError) {\n            console.error('❌ Error al listar platos para verificación:', listError);\n          }\n          \n          // Verificación posterior para asegurar persistencia\n          setTimeout(async () => {\n            try {\n              console.log(`🔍 Verificando persistencia del plato ID ${id}...`);\n              const verified = await verifyPlatoStorage(id);\n              if (verified) {\n                console.log('✅ VERIFICACIÓN POSTERIOR: Plato confirmado en base de datos');\n              } else {\n                console.error('❌ VERIFICACIÓN POSTERIOR FALLIDA: Plato no encontrado en verificación');\n              }\n            } catch (verifyError) {\n              console.error('❌ Error en verificación posterior:', verifyError);\n            }\n          }, 1000);\n          \n          console.log('🏁 Finalizando creación del plato con éxito');\n          resolve(createdPlato);\n        };\n        \n        request.onerror = (event) => {\n          console.error('❌ ERROR al crear plato:', event.target.error);\n          reject(new Error(`Error al crear plato: ${event.target.error.message}`));\n        };\n        \n        transaction.onerror = (event) => {\n          console.error('❌ ERROR en transacción:', event.target.error);\n          reject(new Error(`Error en transacción: ${event.target.error.message}`));\n        };\n        \n        transaction.oncomplete = () => {\n          console.log('✅ Transacción completada correctamente');\n        };\n      } catch (transactionError) {\n        console.error('❌ ERROR al crear transacción:', transactionError);\n        reject(new Error(`Error al crear transacción: ${transactionError.message}`));\n      }\n    });\n  } catch (error) {\n    console.error('❌ ERROR GENERAL en createPlato:', error);\n    throw error;\n  }\n}\n\n/**\n * Función de depuración para verificar el contenido de la base de datos\n * @returns {Promise<void>}\n */\nasync function debugIndexedDB() {\n  console.log('🔍 INICIANDO DEPURACIÓN DE INDEXEDDB...');\n  \n  try {\n    // Verificar la existencia de la base de datos\n    const databases = await window.indexedDB.databases();\n    console.log('📊 Bases de datos disponibles:', databases);\n    \n    // Abrir la base de datos y verificar su estructura\n    const db = await openDB();\n    console.log('📦 Almacenes en la base de datos:', Array.from(db.objectStoreNames));\n    \n    // Verificar contenido del almacén de platos\n    const platos = await getAllPlatos();\n    console.log(`📋 Platos almacenados (${platos.length}):`, platos);\n    \n    // Verificar cola de sincronización\n    const syncQueue = await getSyncQueue();\n    console.log(`🔄 Cola de sincronización (${syncQueue.length}):`, syncQueue);\n    \n    console.log('✅ DEPURACIÓN COMPLETADA');\n    return {\n      databases,\n      stores: Array.from(db.objectStoreNames),\n      platos,\n      syncQueue\n    };\n  } catch (error) {\n    console.error('❌ ERROR EN DEPURACIÓN:', error);\n    throw error;\n  }\n}\n\n/**\n * Función auxiliar para asegurar que los datos del plato sean consistentes antes de guardar\n * @param {Object} platoData - Datos del plato a guardar\n * @returns {Object} Datos del plato normalizados\n */\nfunction normalizePlatoData(platoData) {\n  // Crear una copia para no modificar el original\n  const normalizedData = { ...platoData };\n  \n  // Asegurar que los campos necesarios tengan valores válidos\n  normalizedData.name = normalizedData.name?.trim() || 'Plato sin nombre';\n  normalizedData.price = typeof normalizedData.price === 'string' \n    ? parseFloat(normalizedData.price) || 0 \n    : (normalizedData.price || 0);\n  normalizedData.is_available = normalizedData.is_available !== false;\n  normalizedData.availableQuantity = parseInt(normalizedData.availableQuantity) || 0;\n  normalizedData.includesDrink = normalizedData.includesDrink === true;\n  \n  // Asegurar que los campos de fecha estén presentes\n  if (!normalizedData.createdAt) normalizedData.createdAt = new Date().toISOString();\n  normalizedData.updatedAt = new Date().toISOString();\n  \n  // Añadir estado de sincronización si no existe\n  if (!normalizedData.syncStatus) normalizedData.syncStatus = 'pending';\n  \n  // Limitar el tamaño de la imagen si existe (para evitar error 431)\n  if (normalizedData.image && typeof normalizedData.image === 'string' && \n      normalizedData.image.length > 200000) { // Si es mayor a ~200KB\n    console.warn('⚠️ Imagen demasiado grande, se reducirá para evitar problemas de sincronización');\n    \n    // Crear miniatura para sincronización\n    normalizedData.image_thumbnail = compressImageForSync(normalizedData.image);\n    \n    // Marcar que la imagen original está almacenada localmente\n    normalizedData.has_local_image = true;\n  }\n  \n  return normalizedData;\n}\n\n/**\n * Función para comprimir imágenes y reducir su tamaño para sincronización\n * @param {string} imageDataUrl - Imagen en formato data URL (base64)\n * @returns {string} Imagen comprimida como data URL\n */\nfunction compressImageForSync(imageDataUrl) {\n  try {\n    // Si no es una data URL, devolver como está\n    if (!imageDataUrl || !imageDataUrl.startsWith('data:')) {\n      return imageDataUrl;\n    }\n    \n    // Extraer información de tipo y datos\n    const match = imageDataUrl.match(/^data:([A-Za-z-+/]+);base64,(.+)$/);\n    if (!match) {\n      console.warn('⚠️ Formato de imagen no válido para compresión');\n      return imageDataUrl;\n    }\n    \n    // Crear una versión reducida (ejemplo: recortar a los primeros 50KB)\n    // Esto es una solución temporal; una implementación adecuada usaría canvas\n    // para redimensionar la imagen manteniendo la proporción\n    const maxLength = 50000; // ~50KB\n    const actualData = match[2];\n    \n    if (actualData.length <= maxLength) {\n      return imageDataUrl; // Ya es lo suficientemente pequeña\n    }\n    \n    // Crear una versión recortada para sincronización\n    // Nota: En producción, sería mejor usar canvas para redimensionar correctamente\n    return `data:${match[1]};base64,${actualData.substring(0, maxLength)}`;\n    \n  } catch (error) {\n    console.error('❌ Error al comprimir imagen:', error);\n    return imageDataUrl; // Devolver la original en caso de error\n  }\n}\n\n/**\n * Prepara un plato para sincronización con el servidor\n * @param {Object} plato - Plato a preparar para sincronización\n * @returns {Object} Plato optimizado para envío al servidor\n */\nfunction preparePlatoForSync(plato) {\n  // Si la función no existe, implementarla\n  if (!plato) {\n    console.error('❌ Error: Se intentó preparar un plato nulo para sincronización');\n    return {};\n  }\n  \n  console.log('🔄 Preparando plato para sincronización:', plato.id);\n  \n  // Crear una copia para no modificar el objeto original\n  const syncPlato = { ...plato };\n  \n  // PASO 1: Eliminar propiedades que no necesita el servidor\n  delete syncPlato.syncStatus;\n  delete syncPlato.localTimestamp;\n  delete syncPlato.needsSimplification;\n  delete syncPlato.image_thumbnail; // Si existe, la eliminaremos y usaremos una versión comprimida\n  delete syncPlato._id; // Eliminar posibles _id de MongoDB si existen\n  delete syncPlato.has_local_image;\n  \n  // PASO 2: Ser aún más agresivos con el tamaño de la imagen\n  if (syncPlato.image && typeof syncPlato.image === 'string') {\n    const imageSize = syncPlato.image.length;\n    console.log(`📊 Tamaño original de imagen: ${imageSize} bytes`);\n    \n    // Establecer un límite mucho más estricto (50KB máximo)\n    const maxImageSize = 50000; // 50KB\n    \n    if (imageSize > maxImageSize) {\n      console.warn('⚠️ Imagen demasiado grande, reduciendo drásticamente...');\n      \n      try {\n        // Si empieza con data:, es una data URL\n        if (syncPlato.image.startsWith('data:')) {\n          const match = syncPlato.image.match(/^data:([A-Za-z-+/]+);base64,(.+)$/);\n          if (match) {\n            const imageType = match[1];\n            const base64Data = match[2];\n            \n            // Crear una versión muy reducida\n            const reducedData = base64Data.substring(0, maxImageSize);\n            syncPlato.image = `data:${imageType};base64,${reducedData}`;\n            \n            console.log(`📊 Imagen reducida a: ${syncPlato.image.length} bytes`);\n          } else {\n            // Si no podemos extraer los datos, simplemente truncamos\n            syncPlato.image = syncPlato.image.substring(0, maxImageSize);\n          }\n        } else {\n          // Para URL normales, podríamos mantenerlas o reemplazarlas por un placeholder\n          // Por ahora, conservamos la URL ya que debería ser pequeña\n        }\n      } catch (imageError) {\n        console.error('❌ Error al procesar imagen para sincronización:', imageError);\n        // Si hay error, eliminamos la imagen para garantizar la sincronización\n        delete syncPlato.image;\n        syncPlato.image_error = 'Error al procesar imagen para sincronización';\n      }\n    }\n  }\n  \n  // PASO 3: Limitar todos los campos de texto\n  if (syncPlato.description && syncPlato.description.length > 500) {\n    syncPlato.description = syncPlato.description.substring(0, 500) + '...';\n  }\n  \n  if (syncPlato.name && syncPlato.name.length > 100) {\n    syncPlato.name = syncPlato.name.substring(0, 100);\n  }\n  \n  // PASO 4: Asegurar que todos los campos numéricos sean realmente números\n  syncPlato.price = Number(syncPlato.price) || 0;\n  syncPlato.availableQuantity = Number(syncPlato.availableQuantity) || 0;\n  syncPlato.includesDrink = Boolean(syncPlato.includesDrink);\n  \n  // PASO 5: Verificar el tamaño final del objeto serializado\n  const serializedSize = JSON.stringify(syncPlato).length;\n  console.log(`📊 Tamaño final del plato serializado: ${serializedSize} bytes`);\n  \n  // Si aún es mayor a 100KB, tomamos medidas drásticas\n  if (serializedSize > 100000) {\n    console.warn('⚠️ ADVERTENCIA: Plato demasiado grande incluso después de optimizaciones');\n    \n    // Crear objeto mínimo que contenga solo campos esenciales\n    const minimalPlato = {\n      id: syncPlato.id,\n      name: syncPlato.name,\n      price: syncPlato.price,\n      description: syncPlato.description ? syncPlato.description.substring(0, 100) + '...' : '',\n      includesDrink: syncPlato.includesDrink,\n      availableQuantity: syncPlato.availableQuantity,\n      is_available: syncPlato.is_available !== false,\n      // Eliminar imagen completamente\n      image: null,\n      oversized: true\n    };\n    \n    console.log('🔄 Usando versión mínima del plato para sincronización');\n    return minimalPlato;\n  }\n  \n  console.log('✅ Plato preparado para sincronización');\n  return syncPlato;\n}\n\n/**\n * Función auxiliar para guardar platos desde cualquier formulario de la aplicación\n * @param {Object} platoData - Datos del plato a guardar\n * @returns {Promise<Object>} El plato guardado\n */\nasync function guardarPlato(platoData) {\n  console.log('🔄 Iniciando guardado de plato con guardarPlato():', platoData);\n  \n  try {\n    // Validación de datos\n    if (!platoData || typeof platoData !== 'object') {\n      throw new Error('Los datos del plato deben ser un objeto válido');\n    }\n    \n    if (!platoData.name || platoData.name.trim() === '') {\n      throw new Error('El plato debe tener un nombre válido');\n    }\n    \n    // Normalizar los datos del plato\n    const platoParaGuardar = normalizePlatoData(platoData);\n    console.log('✅ Datos normalizados:', platoParaGuardar);\n    \n    // Usar la función createPlato\n    const platoGuardado = await createPlato(platoParaGuardar);\n    \n    console.log('✅ Plato guardado exitosamente:', platoGuardado);\n    return platoGuardado;\n  } catch (error) {\n    console.error('❌ Error en guardarPlato():', error);\n    throw error;\n  }\n}\n\n// Guardar un plato en IndexedDB\nconst savePlato = async (platoData) => {\n  console.log('Intentando guardar el plato:', platoData);\n  return new Promise(async (resolve, reject) => {\n    try {\n      console.log('Iniciando guardado en IndexedDB:', platoData);\n      \n      // Validación adicional de campos obligatorios\n      if (!platoData.name) {\n        throw new Error('El plato debe tener un nombre');\n      }\n      \n      const db = await openDB();\n      \n      // Usar la constante PLATOS_STORE\n      const transaction = db.transaction([PLATOS_STORE], 'readwrite');\n      const store = transaction.objectStore(PLATOS_STORE);\n      \n      // Agregar estado de sincronización al plato\n      const platoToSave = {\n        ...platoData,\n        syncStatus: 'pending',\n        localTimestamp: new Date().getTime()\n      };\n      \n      console.log('Guardando plato con datos finales:', platoToSave);\n      const request = store.add(platoToSave);\n      \n      request.onsuccess = async (event) => {\n        const savedId = event.target.result;\n        console.log(`Plato guardado localmente con ID: ${savedId}`);\n        \n        // Resolver la promesa con el objeto completo del plato\n        const savedPlato = { ...platoToSave, id: savedId };\n        \n        // Agregar a la cola de sincronización\n        try {\n          await addToSyncQueue({\n            type: 'create',\n            entityType: 'plato',\n            entityId: savedId,\n            data: platoToSave,\n            timestamp: new Date().getTime()\n          });\n          console.log('Plato agregado a la cola de sincronización');\n        } catch (syncError) {\n          console.error('Error al agregar a la cola de sincronización:', syncError);\n          // Continuamos a pesar del error en la cola\n        }\n        \n        // Verificación inmediata para depuración\n        setTimeout(async () => {\n          try {\n            const verificationResult = await verifyPlatoStorage(savedId);\n            if (verificationResult) {\n              console.log('Verificación exitosa del guardado del plato');\n            } else {\n              console.warn('⚠️ Advertencia: El plato no se pudo verificar en IndexedDB');\n            }\n          } catch (verifyError) {\n            console.error('Error al verificar almacenamiento:', verifyError);\n          }\n        }, 500);\n        \n        resolve(savedPlato);\n      };\n      \n      request.onerror = (event) => {\n        console.error('Error al guardar plato en IndexedDB:', event.target.error);\n        reject(new Error('Error al guardar plato localmente: ' + event.target.error.message));\n      };\n      \n      // Manejar errores de transacción\n      transaction.onerror = (event) => {\n        console.error('Error en la transacción de guardado:', event.target.error);\n        reject(new Error('Error en la transacción: ' + event.target.error.message));\n      };\n      \n      transaction.oncomplete = () => {\n        console.log('Transacción de guardado completada exitosamente');\n      };\n      \n    } catch (error) {\n      console.error('Error general en savePlato:', error);\n      reject(error);\n    }\n  });\n};\n\n// Implementar y exportar getPlato si no existe\nconst getPlato = async (id) => {\n  try {\n    console.log(`Obteniendo plato con ID ${id} de IndexedDB...`);\n    const db = await openDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([PLATOS_STORE], 'readonly');\n      const store = transaction.objectStore(PLATOS_STORE);\n      const request = store.get(id);\n      \n      request.onsuccess = (event) => {\n        const plato = event.target.result;\n        if (plato) {\n          console.log(`Plato con ID ${id} encontrado:`, plato);\n          resolve(plato);\n        } else {\n          console.log(`No se encontró plato con ID ${id}`);\n          resolve(null);\n        }\n      };\n      \n      request.onerror = (event) => {\n        console.error(`Error al obtener plato con ID ${id}:`, event);\n        reject(`Error al obtener plato con ID ${id}`);\n      };\n    });\n  } catch (error) {\n    console.error(`Error en getPlato:`, error);\n    throw error;\n  }\n};\n\n// Simplificar la exposición de la función de depuración\nif (typeof window !== 'undefined') {\n  window.debugDB = debugIndexedDB;\n  // Exponer la función guardarPlato para debug y uso directo\n  window.guardarPlato = guardarPlato;\n}\n\nexport {\n  openDatabase,\n  savePlato,\n  getAllPlatos,\n  getPendingPlatos,\n  updatePlatoSyncStatus,\n  addToSyncQueue,\n  getSyncQueue,\n  removeFromSyncQueue,\n  deletePlato,\n  verifyPlatoStorage,\n  createPlato,\n  debugIndexedDB,\n  normalizePlatoData,\n  guardarPlato,  \n  preparePlatoForSync,\n  compressImageForSync,\n  getPlato\n};\n\nexport default {\n  openDatabase,\n  savePlato,\n  getAllPlatos,\n  getPendingPlatos,\n  updatePlatoSyncStatus,\n  addToSyncQueue,\n  getSyncQueue,\n  removeFromSyncQueue,\n  deletePlato,\n  verifyPlatoStorage,\n  createPlato,\n  debugIndexedDB,\n  normalizePlatoData,\n  guardarPlato,  \n  preparePlatoForSync,\n  compressImageForSync,\n  getPlato\n};","// apiConfig.js - Configuración centralizada para URLs de API\r\n\r\n// Determinar el entorno actual \r\nconst isProd = process.env.NODE_ENV === 'production';\r\n\r\n// Verificar si hay una API URL especificada en localStorage\r\nconst storedApiUrl = localStorage.getItem('apiUrl');\r\n\r\n// API real sin subdirectorios 'api' o 'raw' al final\r\nconst apiDomain = storedApiUrl || (isProd ? 'https://websap-backend.onrender.com' : 'http://localhost:3000');\r\n\r\n// Configuración para entorno de producción y desarrollo\r\nconst config = {\r\n  // URLs para producción (servidor real)\r\n  production: {\r\n    API_URL: `${apiDomain}/api`,\r\n    RAW_URL: `${apiDomain}/raw`,\r\n    API_TEST_ENDPOINT: `${apiDomain}/api/test/ping`,\r\n    API_DOMAIN: apiDomain\r\n  },\r\n  // URLs para desarrollo local\r\n  development: {\r\n    API_URL: `${apiDomain}/api`,\r\n    RAW_URL: `${apiDomain}/raw`,\r\n    API_TEST_ENDPOINT: `${apiDomain}/api/test/ping`,\r\n    API_DOMAIN: apiDomain\r\n  }\r\n};\r\n\r\n// Exportar la configuración según el entorno\r\nconst currentConfig = isProd ? config.production : config.development;\r\n\r\nexport default currentConfig;","import { createApp, h, reactive } from 'vue';\r\n\r\n// Estado global del diálogo usando reactive para asegurar reactividad\r\nexport const dialogState = reactive({\r\n  show: false,\r\n  title: 'Mensaje',\r\n  message: '',\r\n  confirmText: 'Aceptar',\r\n  cancelText: 'Cancelar',\r\n  showCancel: false,\r\n  resolvePromise: null\r\n});\r\n\r\n// Componente de modal para confirmaciones\r\nconst ModalComponent = {\r\n  props: {\r\n    title: {\r\n      type: String,\r\n      default: 'Confirmar'\r\n    },\r\n    message: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    confirmText: {\r\n      type: String,\r\n      default: 'Aceptar'\r\n    },\r\n    cancelText: {\r\n      type: String,\r\n      default: 'Cancelar'\r\n    },\r\n    showCancel: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  emits: ['confirm', 'cancel'],\r\n  template: `\r\n    <div class=\"dialog-overlay\" v-if=\"dialogState.show\">\r\n      <div class=\"dialog-container\">\r\n        <div class=\"dialog-header\">\r\n          <h3>{{ dialogState.title }}</h3>\r\n        </div>\r\n        <div class=\"dialog-content\">\r\n          <p>{{ dialogState.message }}</p>\r\n        </div>\r\n        <div class=\"dialog-footer\">\r\n          <button v-if=\"dialogState.showCancel\" @click=\"handleCancel\" class=\"dialog-button cancel-button\">{{ dialogState.cancelText }}</button>\r\n          <button @click=\"handleConfirm\" class=\"dialog-button confirm-button\">{{ dialogState.confirmText }}</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `,\r\n  mounted() {\r\n    // Agregar estilo inline si no está en el DOM\r\n    const style = document.createElement('style');\r\n    style.innerHTML = `\r\n      .dialog-overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        background-color: rgba(0, 0, 0, 0.5);\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        z-index: 9999;\r\n      }\r\n      .dialog-container {\r\n        background-color: #fff;\r\n        border-radius: 8px;\r\n        width: 90%;\r\n        max-width: 500px;\r\n        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\r\n        overflow: hidden;\r\n        animation: dialogFadeIn 0.3s;\r\n      }\r\n      .dialog-header {\r\n        padding: 15px 20px;\r\n        border-bottom: 1px solid #eee;\r\n      }\r\n      .dialog-header h3 {\r\n        margin: 0;\r\n        color: #333;\r\n      }\r\n      .dialog-content {\r\n        padding: 20px;\r\n      }\r\n      .dialog-footer {\r\n        padding: 15px 20px;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        gap: 10px;\r\n        border-top: 1px solid #eee;\r\n      }\r\n      .dialog-button {\r\n        padding: 10px 20px;\r\n        border-radius: 4px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        border: none;\r\n        transition: all 0.2s;\r\n      }\r\n      .confirm-button {\r\n        background-color: #4CAF50;\r\n        color: white;\r\n      }\r\n      .confirm-button:hover {\r\n        background-color: #45a049;\r\n      }\r\n      .cancel-button {\r\n        background-color: #f1f1f1;\r\n        color: #333;\r\n      }\r\n      .cancel-button:hover {\r\n        background-color: #e1e1e1;\r\n      }\r\n      @keyframes dialogFadeIn {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(-20px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n  },\r\n  methods: {\r\n    handleConfirm() {\r\n      if (dialogState.resolvePromise) {\r\n        dialogState.resolvePromise(true);\r\n        dialogState.resolvePromise = null;\r\n      }\r\n      dialogState.show = false;\r\n    },\r\n    handleCancel() {\r\n      if (dialogState.resolvePromise) {\r\n        dialogState.resolvePromise(false);\r\n        dialogState.resolvePromise = null;\r\n      }\r\n      dialogState.show = false;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Muestra un diálogo de confirmación\r\n * @param {String} message Mensaje a mostrar\r\n * @param {Object} options Opciones adicionales (title, confirmText, cancelText)\r\n * @returns {Promise<Boolean>} Promesa que se resuelve con true si se confirma, false si se cancela\r\n */\r\nexport function confirm(message, options = {}) {\r\n  return new Promise((resolve) => {\r\n    dialogState.show = true;\r\n    dialogState.message = message;\r\n    dialogState.title = options.title || 'Confirmar';\r\n    dialogState.confirmText = options.confirmText || 'Aceptar';\r\n    dialogState.cancelText = options.cancelText || 'Cancelar';\r\n    dialogState.showCancel = true;\r\n    dialogState.resolvePromise = resolve;\r\n  });\r\n}\r\n\r\n/**\r\n * Muestra un mensaje de alerta\r\n * @param {String} message Mensaje a mostrar\r\n * @param {Object} options Opciones adicionales (title, confirmText)\r\n * @returns {Promise<void>} Promesa que se resuelve cuando se cierra la alerta\r\n */\r\nexport function alert(message, options = {}) {\r\n  return new Promise((resolve) => {\r\n    dialogState.show = true;\r\n    dialogState.message = message;\r\n    dialogState.title = options.title || 'Mensaje';\r\n    dialogState.confirmText = options.confirmText || 'Aceptar';\r\n    dialogState.showCancel = false;\r\n    dialogState.resolvePromise = resolve;\r\n  });\r\n}\r\n\r\n/**\r\n * Maneja el evento de confirmación del diálogo\r\n */\r\nexport function handleConfirm() {\r\n  if (dialogState.resolvePromise) {\r\n    dialogState.resolvePromise(true);\r\n    dialogState.resolvePromise = null;\r\n  }\r\n  dialogState.show = false;\r\n}\r\n\r\n/**\r\n * Maneja el evento de cancelación del diálogo\r\n */\r\nexport function handleCancel() {\r\n  if (dialogState.resolvePromise) {\r\n    dialogState.resolvePromise(false);\r\n    dialogState.resolvePromise = null;\r\n  }\r\n  dialogState.show = false;\r\n}\r\n\r\n// Exportar un objeto por defecto para compatibilidad con importaciones anteriores\r\nexport default {\r\n  state: dialogState,\r\n  confirm,\r\n  alert,\r\n  handleConfirm,\r\n  handleCancel\r\n};\r\n","// Servicio para la gestión de reservas\nimport apiService from './apiService';\nimport eventBus from '../utils/eventBus';\n\n// Almacenamiento local para las reservas (simulando una base de datos)\nlet reservationsStore = [];\n\n// Intentar cargar reservas guardadas en localStorage al iniciar\ntry {\n  const savedReservations = localStorage.getItem('websap_reservations');\n  if (savedReservations) {\n    reservationsStore = JSON.parse(savedReservations);\n    console.log('Reservas cargadas desde localStorage:', reservationsStore.length);\n  }\n} catch (error) {\n  console.error('Error al cargar reservas desde localStorage:', error);\n}\n\n// Función para guardar las reservas en localStorage\nfunction saveReservationsToStorage() {\n  try {\n    localStorage.setItem('websap_reservations', JSON.stringify(reservationsStore));\n  } catch (error) {\n    console.error('Error al guardar reservas en localStorage:', error);\n  }\n}\n\n// Función para guardar una nueva reserva\nexport async function saveReservation(reservationData) {\n  try {\n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Generar un ID único para la reserva\n    const reservationId = 'res_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n    \n    // Crear el objeto de reserva con los datos recibidos\n    const reservation = {\n      id: reservationId,\n      fullName: reservationData.fullName,\n      mobilePhone: reservationData.mobilePhone,\n      landlinePhone: reservationData.landlinePhone || '',\n      email: reservationData.email || '',\n      address: reservationData.address || '',\n      date: reservationData.reservationDate,\n      time: reservationData.reservationTime,\n      peopleCount: reservationData.peopleCount,\n      notes: reservationData.additionalNotes || '',\n      status: 'pending', // Estado inicial: pendiente\n      createdAt: new Date().toISOString(),\n      source: reservationData.source || 'web' // Fuente de la reserva: web o whatsapp\n    };\n    \n    try {\n      // Intentar guardar en el backend\n      const response = await apiService.post('/whatsapp/reservas', {\n        nombre: reservation.fullName,\n        telefono: reservation.mobilePhone,\n        email: reservation.email,\n        fecha: reservation.date,\n        hora: reservation.time,\n        personas: reservation.peopleCount,\n        notas: reservation.notes,\n        created_by: reservationData.created_by || localStorage.getItem('userId') || null,\n        usuario_id: reservationData.usuario_id || (localStorage.getItem('userType') === 'user' ? localStorage.getItem('userId') : null)\n      });\n      \n      if (response.data && response.data.success) {\n        console.log('Reserva guardada en el backend:', response.data);\n        reservation.id = response.data.reservationId || reservation.id;\n      }\n    } catch (apiError) {\n      console.warn('No se pudo guardar la reserva en el backend, usando almacenamiento local:', apiError);\n    }\n    \n    // Guardar la reserva en nuestro almacenamiento local\n    reservationsStore.unshift(reservation);\n    saveReservationsToStorage();\n    \n    // Emitimos un evento para notificar a otros componentes sobre la nueva reserva\n    eventBus.emit('nueva-reserva', reservation);\n    \n    console.log('Reserva guardada correctamente:', reservation);\n    \n    return {\n      success: true,\n      reservation\n    };\n  } catch (error) {\n    console.error('Error al guardar la reserva:', error);\n    return {\n      success: false,\n      error: error.message || 'Error al guardar la reserva'\n    };\n  }\n}\n\n// Función para obtener todas las reservas\nexport async function getReservations() {\n  try {\n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Intentar obtener reservas desde el backend\n    try {\n      const response = await apiService.get('/whatsapp/reservas');\n      \n      if (response && response.success && Array.isArray(response.reservas)) {\n        console.log('✅ Reservas obtenidas desde el backend:', response.reservas.length);\n        \n        // Convertir las reservas del backend al formato que espera el frontend\n        const backendReservations = response.reservas.map(res => ({\n          id: res.id,\n          fullName: res.nombre,\n          mobilePhone: res.telefono,\n          email: res.email || '',\n          date: formatDateToDDMMYYYY(res.fecha),\n          time: res.hora,\n          peopleCount: res.personas,\n          notes: res.notas || '',\n          status: res.estado === 'confirmada' ? 'confirmed' : \n                 res.estado === 'cancelada' ? 'cancelled' : 'pending',\n          createdAt: res.creado_en,\n          source: res.origen || 'web',\n          created_by: res.created_by,\n          usuario_id: res.usuario_id\n        }));\n        \n        // Actualizar el almacenamiento local con las reservas del backend\n        reservationsStore = backendReservations;\n        saveReservationsToStorage();\n        \n        return {\n          success: true,\n          reservations: backendReservations\n        };\n      }\n    } catch (error) {\n      console.warn('Error al obtener reservas desde el backend, usando datos locales:', error);\n    }\n    \n    // Si no se pudieron obtener del backend o hubo un error, usar los datos locales\n    console.log('📋 Usando datos de reservas locales:', reservationsStore.length);\n    \n    // Formatear las fechas de las reservas locales\n    const formattedReservations = reservationsStore.map(res => ({\n      ...res,\n      date: formatDateToDDMMYYYY(res.date)\n    }));\n    \n    // Si no hay reservas en el almacenamiento, devolvemos un array vacío\n    if (formattedReservations.length === 0) {\n      return {\n        success: true,\n        reservations: []\n      };\n    }\n    \n    return {\n      success: true,\n      reservations: formattedReservations\n    };\n  } catch (error) {\n    console.error('❌ Error al obtener las reservas:', error);\n    return {\n      success: false,\n      error: error.message || 'Error al obtener las reservas'\n    };\n  }\n}\n\n// Función para actualizar el estado de una reserva\nexport async function updateReservationStatus(reservationId, status) {\n  try {\n    // Intentar actualizar en el backend\n    try {\n      const response = await apiService.put(`/whatsapp/reservas/${reservationId}`, {\n        estado: status === 'confirmed' ? 'confirmada' : \n                status === 'cancelled' ? 'cancelada' : 'pendiente'\n      });\n      \n      if (response.data && response.data.success) {\n        console.log('Estado de reserva actualizado en el backend:', response.data);\n      }\n    } catch (apiError) {\n      console.warn('No se pudo actualizar el estado de la reserva en el backend:', apiError);\n    }\n    \n    // Buscar la reserva en nuestro almacenamiento local\n    const reservationIndex = reservationsStore.findIndex(res => res.id === reservationId);\n    \n    if (reservationIndex === -1) {\n      throw new Error('Reserva no encontrada');\n    }\n    \n    // Actualizar el estado\n    reservationsStore[reservationIndex].status = status;\n    \n    // Guardar los cambios en localStorage\n    saveReservationsToStorage();\n    \n    // Emitir evento de actualización\n    eventBus.emit('reserva-actualizada', {\n      id: reservationId,\n      status\n    });\n    \n    return {\n      success: true,\n      message: 'Estado de reserva actualizado correctamente'\n    };\n  } catch (error) {\n    console.error('Error al actualizar el estado de la reserva:', error);\n    return {\n      success: false,\n      error: error.message || 'Error al actualizar el estado de la reserva'\n    };\n  }\n}\n\n// Función para guardar una reserva desde WhatsApp\nexport async function saveWhatsAppReservation(reserva) {\n  console.log(\"Procesando reserva desde WhatsApp:\", reserva);\n  \n  // Asegurarse de que el token esté configurado en apiService\n  const token = localStorage.getItem('token');\n  if (token) {\n    apiService.setToken(token);\n  }\n  \n  // Asegurar que los nuevos campos estén presentes en la reserva\n  const reservaCompleta = {\n    ...reserva,\n    created_by: reserva.created_by || localStorage.getItem('userId') || null,\n    usuario_id: reserva.usuario_id || (localStorage.getItem('userType') === 'user' ? localStorage.getItem('userId') : null)\n  };\n  \n  try {\n    const response = await apiService.post('/whatsapp/reservas', reservaCompleta);\n    \n    // Crear un objeto de reserva completo para devolver al frontend\n    const reservationObject = {\n      id: response.reservationId || Date.now().toString(),\n      fullName: reservaCompleta.nombre,\n      mobilePhone: reservaCompleta.telefono,\n      email: reservaCompleta.email || '',\n      date: formatDateToDDMMYYYY(reservaCompleta.fecha),\n      time: reservaCompleta.hora,\n      peopleCount: reservaCompleta.personas || 2,\n      notes: reservaCompleta.notas || '',\n      status: 'pending',\n      createdAt: new Date().toISOString(),\n      source: 'whatsapp',\n      created_by: reservaCompleta.created_by,\n      usuario_id: reservaCompleta.usuario_id\n    };\n    \n    return {\n      success: true,\n      reservation: reservationObject,\n      message: 'Reserva guardada correctamente'\n    };\n  } catch (error) {\n    console.warn('⚠️ No se pudo guardar la reserva en el backend, pero se guardó localmente:', error);\n    \n    // Guardar en IndexedDB como respaldo\n    await saveReservaLocally(reservaCompleta);\n    \n    return {\n      status: 'local',\n      success: true,\n      reservation: {\n        id: Date.now().toString(),\n        fullName: reservaCompleta.nombre,\n        mobilePhone: reservaCompleta.telefono,\n        email: reservaCompleta.email || '',\n        date: formatDateToDDMMYYYY(reservaCompleta.fecha),\n        time: reservaCompleta.hora,\n        peopleCount: reservaCompleta.personas || 2,\n        notes: reservaCompleta.notas || '',\n        status: 'pending',\n        createdAt: new Date().toISOString(),\n        source: 'whatsapp',\n        created_by: reservaCompleta.created_by,\n        usuario_id: reservaCompleta.usuario_id\n      },\n      message: 'Reserva guardada localmente debido a un error de conexión'\n    };\n  }\n}\n\n// Función para guardar una reserva localmente cuando falla el backend\nasync function saveReservaLocally(reserva) {\n  try {\n    // Añadir la reserva al almacenamiento local\n    const localReserva = {\n      id: 'local_' + Date.now(),\n      fullName: reserva.nombre || reserva.fullName,\n      mobilePhone: reserva.telefono || reserva.mobilePhone,\n      email: reserva.email || '',\n      date: formatDateToDDMMYYYY(reserva.fecha || reserva.date),\n      time: reserva.hora || reserva.time,\n      peopleCount: reserva.personas || reserva.peopleCount,\n      notes: reserva.notas || reserva.notes || '',\n      status: 'pending',\n      createdAt: new Date().toISOString(),\n      source: 'whatsapp',\n      created_by: reserva.created_by || localStorage.getItem('userId') || null,\n      usuario_id: reserva.usuario_id || (localStorage.getItem('userType') === 'user' ? localStorage.getItem('userId') : null),\n      pendingSave: true // Marcar para sincronizar cuando haya conexión\n    };\n    \n    // Añadir al store y guardar\n    reservationsStore.unshift(localReserva);\n    saveReservationsToStorage();\n    \n    // Emitir evento de nueva reserva\n    eventBus.emit('nueva-reserva', localReserva);\n    \n    return localReserva;\n  } catch (error) {\n    console.error('Error al guardar reserva localmente:', error);\n    throw error;\n  }\n}\n\n/**\n * Elimina una reserva específica\n * @param {string} reservationId - ID de la reserva a eliminar\n * @returns {Promise<Object>} - Resultado de la operación\n */\nexport async function deleteReservation(reservationId) {\n  try {\n    // Intentar eliminar en el backend primero\n    try {\n      const response = await apiService.delete(`/reservas/${reservationId}`);\n      console.log('Reserva eliminada en el backend:', response);\n    } catch (apiError) {\n      console.warn('No se pudo eliminar la reserva en el backend:', apiError);\n      // Continuamos con la eliminación local aunque falle el backend\n    }\n    \n    // Eliminar de nuestro almacenamiento local\n    const index = reservationsStore.findIndex(r => r.id === reservationId);\n    if (index !== -1) {\n      reservationsStore.splice(index, 1);\n      saveReservationsToStorage();\n      \n      // Emitir evento de actualización\n      eventBus.emit('reserva-eliminada', { id: reservationId });\n      \n      return {\n        success: true,\n        message: 'Reserva eliminada correctamente'\n      };\n    } else {\n      return {\n        success: false,\n        error: 'No se encontró la reserva especificada'\n      };\n    }\n  } catch (error) {\n    console.error('Error al eliminar reserva:', error);\n    return {\n      success: false,\n      error: error.message || 'Error al eliminar la reserva'\n    };\n  }\n}\n\n/**\n * Verifica si una reserva tiene más de X días de antigüedad\n * @param {Object} reservation - Reserva a verificar\n * @param {number} days - Número de días para considerar antigua\n * @returns {boolean} - true si la reserva es más antigua que los días especificados\n */\nexport function isReservationOlderThan(reservation, days = 30) {\n  if (!reservation || !reservation.date) return false;\n  \n  const reservationDate = new Date(reservation.date);\n  const today = new Date();\n  \n  // Calcular la diferencia en milisegundos\n  const diffTime = today - reservationDate;\n  // Convertir a días\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  \n  return diffDays > days;\n}\n\n// Función para formatear una fecha al formato DD/MM/YYYY\nfunction formatDateToDDMMYYYY(dateString) {\n  if (!dateString) return '';\n  \n  try {\n    // Caso específico para el formato problemático: \"29T05:00:00.000Z/05/2025\"\n    if (dateString.includes('T') && dateString.includes('/')) {\n      const parts = dateString.split('/');\n      if (parts.length === 3) {\n        const day = parts[0].split('T')[0];\n        return `${day}/${parts[1]}/${parts[2]}`;\n      }\n    }\n    \n    // Formato ISO: \"2025-05-29\"\n    if (dateString.includes('-')) {\n      const parts = dateString.split('-');\n      if (parts.length === 3) {\n        return `${parts[2]}/${parts[1]}/${parts[0]}`;\n      }\n    }\n    \n    // Si ya está en formato DD/MM/YYYY, devolverlo tal cual\n    if (dateString.includes('/') && !dateString.includes('T')) {\n      return dateString;\n    }\n    \n    // Intentar parsear como objeto Date\n    const date = new Date(dateString);\n    if (!isNaN(date.getTime())) {\n      const day = date.getDate().toString().padStart(2, '0');\n      const month = (date.getMonth() + 1).toString().padStart(2, '0');\n      const year = date.getFullYear();\n      return `${day}/${month}/${year}`;\n    }\n    \n    return dateString;\n  } catch (error) {\n    console.error('Error al formatear fecha:', error);\n    return dateString;\n  }\n}\n\n// Exportación por defecto para compatibilidad con importaciones existentes\nexport default {\n  saveReservation,\n  getReservations,\n  updateReservationStatus,\n  saveWhatsAppReservation,\n  deleteReservation,\n  isReservationOlderThan\n};\n","// Crear un simple Event Bus para Vue 3\r\nimport { reactive } from 'vue';\r\n\r\nclass EventBus {\r\n  constructor() {\r\n    this.events = reactive({});\r\n  }\r\n\r\n  on(event, callback) {\r\n    if (!this.events[event]) {\r\n      this.events[event] = [];\r\n    }\r\n    this.events[event].push(callback);\r\n  }\r\n\r\n  off(event, callback) {\r\n    if (!this.events[event]) return;\r\n    \r\n    if (callback) {\r\n      const index = this.events[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.events[event].splice(index, 1);\r\n      }\r\n    } else {\r\n      this.events[event] = [];\r\n    }\r\n  }\r\n\r\n  emit(event, payload) {\r\n    if (!this.events[event]) return;\r\n    \r\n    this.events[event].forEach(callback => {\r\n      callback(payload);\r\n    });\r\n  }\r\n}\r\n\r\nexport default new EventBus();","// src/services/imageService.js\n\n/**\n * Servicio para el manejo y optimización de imágenes\n */\n\n/**\n * Comprime una imagen en formato base64 para reducir su tamaño\n * @param {string} base64Image - Imagen en formato base64\n * @param {number} maxWidth - Ancho máximo de la imagen comprimida\n * @param {number} quality - Calidad de la imagen (0-1)\n * @returns {Promise<string>} - Imagen comprimida en formato base64\n */\nexport const compressImage = (base64Image, maxWidth = 800, quality = 0.7) => {\n  return new Promise((resolve, reject) => {\n    try {\n      // Verificar que la imagen sea válida\n      if (!base64Image || typeof base64Image !== 'string') {\n        console.warn('La imagen no es válida para compresión');\n        resolve(base64Image);\n        return;\n      }\n\n      // Crear una imagen para cargar el base64\n      const img = new Image();\n      img.onload = () => {\n        // Crear un canvas para la compresión\n        const canvas = document.createElement('canvas');\n        let width = img.width;\n        let height = img.height;\n        \n        // Redimensionar si es necesario\n        if (width > maxWidth) {\n          height = Math.round((height * maxWidth) / width);\n          width = maxWidth;\n        }\n        \n        // Establecer dimensiones del canvas\n        canvas.width = width;\n        canvas.height = height;\n        \n        // Dibujar la imagen en el canvas\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(img, 0, 0, width, height);\n        \n        // Convertir a base64 con la calidad especificada\n        const compressedBase64 = canvas.toDataURL('image/jpeg', quality);\n        \n        // Verificar si realmente se redujo el tamaño\n        if (compressedBase64.length < base64Image.length) {\n          console.log(`Imagen comprimida: ${Math.round(compressedBase64.length / 1024)}KB (original: ${Math.round(base64Image.length / 1024)}KB)`);\n          resolve(compressedBase64);\n        } else {\n          console.log('La compresión no redujo el tamaño, manteniendo original');\n          resolve(base64Image);\n        }\n      };\n      \n      img.onerror = () => {\n        console.warn('Error al cargar la imagen para compresión');\n        resolve(base64Image); // Devolver la original en caso de error\n      };\n      \n      // Asegurarse de que la imagen tenga el formato correcto\n      if (!base64Image.startsWith('data:image')) {\n        img.src = 'data:image/jpeg;base64,' + base64Image;\n      } else {\n        img.src = base64Image;\n      }\n    } catch (error) {\n      console.error('Error en la compresión de imagen:', error);\n      resolve(base64Image); // Devolver la original en caso de error\n    }\n  });\n};\n\n/**\n * Verifica si una imagen es demasiado grande y la comprime si es necesario\n * @param {string} base64Image - Imagen en formato base64\n * @param {number} maxSizeKB - Tamaño máximo en KB\n * @returns {Promise<string>} - Imagen optimizada en formato base64\n */\nexport const optimizeImageForSync = async (base64Image, maxSizeKB = 500) => {\n  try {\n    if (!base64Image || typeof base64Image !== 'string') {\n      return base64Image;\n    }\n    \n    // Calcular tamaño aproximado en KB\n    const sizeKB = Math.round(base64Image.length / 1024);\n    \n    if (sizeKB <= maxSizeKB) {\n      // La imagen ya es lo suficientemente pequeña\n      return base64Image;\n    }\n    \n    console.log(`Optimizando imagen de ${sizeKB}KB (máximo: ${maxSizeKB}KB)`);\n    \n    // Calcular calidad basada en cuánto necesitamos comprimir\n    let quality = 0.7;\n    if (sizeKB > maxSizeKB * 3) {\n      quality = 0.5; // Más compresión para imágenes muy grandes\n    } else if (sizeKB > maxSizeKB * 2) {\n      quality = 0.6; // Compresión media\n    }\n    \n    // Comprimir la imagen\n    let compressedImage = await compressImage(base64Image, 800, quality);\n    \n    // Si sigue siendo demasiado grande, intentar con más compresión\n    if (compressedImage.length / 1024 > maxSizeKB) {\n      compressedImage = await compressImage(compressedImage, 600, 0.5);\n    }\n    \n    // Si aún es demasiado grande, hacer un último intento\n    if (compressedImage.length / 1024 > maxSizeKB) {\n      compressedImage = await compressImage(compressedImage, 400, 0.4);\n    }\n    \n    return compressedImage;\n  } catch (error) {\n    console.error('Error al optimizar imagen:', error);\n    return base64Image; // Devolver la original en caso de error\n  }\n};\n","<template>\n  <div id=\"app\" :class=\"{ 'dark-mode': isDarkMode }\">\n    <!-- WebSocket Status Indicator with improved messaging -->\n    <div v-if=\"wsState.reconnecting\" class=\"ws-status reconnecting\">\n      <span class=\"loading-spinner\"></span> \n      Reconectando... (Intento {{ wsState.reconnectAttempts }} de {{ wsState.maxReconnectAttempts }})\n      <button @click=\"stopReconnecting\" class=\"reconnect-btn stop-btn\">Cancelar</button>\n    </div>\n    <div v-else-if=\"wsState.error\" class=\"ws-status error\">\n      <span class=\"error-icon\">⚠️</span> Error de conexión: {{ wsState.error }}\n      <button @click=\"handleReconnect\" class=\"reconnect-btn\">Reconectar</button>\n    </div>\n    \n    <nav class=\"main-nav\" v-if=\"showNav\">\n      <div class=\"nav-container\">\n        <router-link to=\"/\" class=\"nav-logo\">WebSAP</router-link>\n        <div class=\"nav-links\">\n          <router-link to=\"/\">Inicio</router-link>\n          <router-link to=\"/about\">Acerca de</router-link>\n          <template v-if=\"isLoggedIn\">\n            <router-link to=\"/menu\">Menú</router-link>\n            <!-- Enlaces específicos según el rol -->\n            <router-link v-if=\"isSuperAdmin\" to=\"/superadmin\">Admin</router-link>\n            <router-link v-if=\"isEmployee\" to=\"/employee\">Panel Empleado</router-link>\n            <a href=\"#\" @click.prevent=\"logout\">Cerrar Sesión</a>\n          </template>\n          <template v-else>\n            <router-link to=\"/login\">Iniciar Sesión</router-link>\n            <router-link to=\"/register\">Registrarse</router-link>\n          </template>\n          \n          <!-- Dark Mode Toggle Button with Inline SVGs as fallback -->\n          <button @click=\"toggleDarkMode\" class=\"dark-mode-toggle\" aria-label=\"Cambiar modo oscuro\">\n            <template v-if=\"isDarkMode\">\n              <!-- Sol - SVG inline como respaldo -->\n              <svg v-if=\"svgFallback\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"theme-icon\">\n                <path fill=\"currentColor\" d=\"M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.758a.75.75 0 001.06-1.061l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z\" />\n              </svg>\n              <img v-else src=\"@/assets/img/sun.svg\" alt=\"Modo claro\" class=\"theme-icon\">\n            </template>\n            <template v-else>\n              <!-- Luna - SVG inline como respaldo -->\n              <svg v-if=\"svgFallback\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" class=\"theme-icon\">\n                <path fill=\"currentColor\" d=\"M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z\" />\n              </svg>\n              <img v-else src=\"@/assets/img/moon.svg\" alt=\"Modo oscuro\" class=\"theme-icon\">\n            </template>\n          </button>\n        </div>\n      </div>\n    </nav>\n    \n    <router-view />\n    \n    <!-- Componente para manejar reservas de WhatsApp (invisible) -->\n    <WhatsAppReservationHandler ref=\"whatsappHandler\" />\n    \n    <!-- Simulador de WhatsApp para pruebas -->\n    <WhatsAppSimulator />\n    \n    <!-- Dialog component for global usage -->\n    <DialogContainer />\n  </div>\n</template>\n\n<script>\nimport { ref, computed, watch, onMounted, onUnmounted, provide, nextTick } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport DialogContainer from './components/DialogContainer.vue';\nimport WhatsAppReservationHandler from './components/WhatsAppReservationHandler.vue';\nimport WhatsAppSimulator from './components/WhatsAppSimulator.vue'; // Importar el componente\nimport './utils/testReservations'; // Importar utilidades de prueba\nimport { \n  webSocketState, \n  initializeWebSocket, \n  closeWebSocket, \n  reconnect, \n  disableWebSocket \n} from './services/webSocketService';\nimport { isAuthenticated, hasRole, logout as authLogout } from './services/authService';\nimport { initSyncService } from './services/syncService';\n\nexport default {\n  name: 'App',\n  components: {\n    DialogContainer,\n    WhatsAppReservationHandler,\n    WhatsAppSimulator // Registrar el componente\n  },\n  data() {\n    return {\n      isLoggedIn: isAuthenticated(),\n      isDarkMode: localStorage.getItem('darkMode') === 'true',\n      svgFallback: false, // Variable para controlar si usamos SVG inline\n      whatsappHandler: null\n    }\n  },\n  computed: {\n    wsState() {\n      return webSocketState;\n    },\n    showNav() {\n      return !this.$route.path.match(/^\\/menu\\/[^\\/]+$/);\n    },\n    isSuperAdmin() {\n      return this.isLoggedIn && hasRole('Superadministrador');\n    },\n    isEmployee() {\n      return this.isLoggedIn && hasRole('Empleado');\n    }\n  },\n  watch: {\n    $route() {\n      this.isLoggedIn = isAuthenticated();\n    }\n  },\n  methods: {\n    logout() {\n      authLogout();\n      this.isLoggedIn = false;\n      this.$router.push('/');\n    },\n    toggleDarkMode() {\n      this.isDarkMode = !this.isDarkMode;\n      \n      // Guardar preferencia en localStorage\n      localStorage.setItem('darkMode', this.isDarkMode);\n      \n      // Aplicar el tema a la etiqueta html y al elemento body para mayor consistencia\n      nextTick(() => {\n        if (this.isDarkMode) {\n          document.documentElement.classList.add('dark-mode');\n          document.body.classList.add('dark-mode');\n        } else {\n          document.documentElement.classList.remove('dark-mode');\n          document.body.classList.remove('dark-mode');\n        }\n      });\n    },\n    handleReconnect() {\n      reconnect();\n    },\n    stopReconnecting() {\n      stopReconnecting();\n    }\n  },\n  mounted() {\n    // Verificar si podemos cargar las imágenes\n    const testImg = new Image();\n    testImg.onerror = () => {\n      console.warn('Error al cargar imágenes SVG, usando fallback inline');\n      this.svgFallback = true;\n    };\n    testImg.src = require('@/assets/img/sun.svg');\n\n    // Aplicar el tema inicial\n    if (this.isDarkMode) {\n      document.documentElement.classList.add('dark-mode');\n      document.body.classList.add('dark-mode');\n    }\n    \n    // Detectar preferencia del sistema si no hay preferencia guardada\n    if (localStorage.getItem('darkMode') === null) {\n      const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;\n      this.isDarkMode = prefersDarkMode;\n      localStorage.setItem('darkMode', prefersDarkMode);\n      \n      if (prefersDarkMode) {\n        document.documentElement.classList.add('dark-mode');\n        document.body.classList.add('dark-mode');\n      }\n    }\n    \n    // Deshabilitar WebSocket para evitar errores de conexión ya que tu backend no lo soporta aún\n    disableWebSocket();\n\n    // Inicializar el servicio de sincronización al cargar la app\n    initSyncService();\n  },\n  unmounted() {\n    closeWebSocket();\n  }\n}\n</script>\n\n<style>\n@import './assets/theme.css';\n\n/* Estilos globales */\n* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: var(--text-color);\n  background-color: var(--bg-color);\n}\n\n#app {\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n}\n\n/* Estilos para la navegación */\n.main-nav {\n  background-color: var(--nav-bg);\n  box-shadow: 0 2px 8px var(--shadow-color);\n  padding: 15px 0;\n  transition: all 0.3s ease;\n}\n\n.nav-container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.nav-logo {\n  font-size: 24px;\n  font-weight: bold;\n  color: var(--primary-color);\n  text-decoration: none;\n}\n\n.nav-links {\n  display: flex;\n  gap: 20px;\n  align-items: center;\n}\n\n.nav-links a {\n  color: var(--text-color);\n  text-decoration: none;\n  padding: 5px 10px;\n  border-radius: 4px;\n  transition: all 0.3s;\n}\n\n.nav-links a:hover {\n  background-color: rgba(76, 175, 80, 0.1);\n  color: var(--primary-color);\n}\n\n.nav-links a.router-link-exact-active {\n  color: var(--primary-color);\n  font-weight: bold;\n}\n\n/* Dark Mode Toggle Button */\n.dark-mode-toggle {\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n  color: var(--text-color);\n  margin-left: 10px;\n  position: relative;\n}\n\n.dark-mode-toggle:hover {\n  background-color: var(--shadow-color);\n}\n\n.theme-icon {\n  width: 20px;\n  height: 20px;\n  color: var(--text-color);\n  transition: transform 0.5s ease;\n}\n\n.dark-mode-toggle:hover .theme-icon {\n  transform: rotate(30deg);\n}\n\nhtml.dark-mode .dark-mode-toggle .theme-icon {\n  filter: brightness(0.9) contrast(1.5);\n}\n\n/* Ajustes responsivos */\n@media (max-width: 768px) {\n  .nav-container {\n    flex-direction: column;\n    gap: 15px;\n  }\n  \n  .nav-links {\n    flex-wrap: wrap;\n    justify-content: center;\n  }\n}\n\n/* WebSocket status styles */\n.ws-status {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  padding: 6px 15px;\n  font-size: 12px;\n  color: white;\n  z-index: 2000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.ws-status.reconnecting {\n  background-color: #ff9800;\n}\n\n.ws-status.error {\n  background-color: #f44336;\n}\n\n.reconnect-btn, .stop-btn {\n  background-color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 2px 8px;\n  font-size: 11px;\n  cursor: pointer;\n  margin-left: 8px;\n}\n\n.reconnect-btn {\n  color: #f44336;\n}\n\n.stop-btn {\n  color: #ff9800;\n}\n\n.reconnect-btn:hover, .stop-btn:hover {\n  background-color: #f9f9f9;\n}\n\n.loading-spinner {\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  border-radius: 50%;\n  border-top-color: white;\n  animation: spin 1s linear infinite;\n}\n\n.error-icon {\n  font-size: 14px;\n}\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>","<template>\r\n  <div>\r\n    <!-- Alert Dialog -->\r\n    <div v-if=\"dialogState.show\" class=\"dialog-overlay\">\r\n      <div class=\"dialog-container\">\r\n        <div class=\"dialog-header\">\r\n          <h3>{{ dialogState.title }}</h3>\r\n        </div>\r\n        <div class=\"dialog-content\">\r\n          <p>{{ dialogState.message }}</p>\r\n        </div>\r\n        <div class=\"dialog-footer\">\r\n          <button \r\n            v-if=\"dialogState.showCancel\" \r\n            @click=\"handleCancel\" \r\n            class=\"dialog-button cancel-button\"\r\n          >\r\n            {{ dialogState.cancelText }}\r\n          </button>\r\n          <button \r\n            @click=\"handleConfirm\" \r\n            class=\"dialog-button confirm-button\"\r\n          >\r\n            {{ dialogState.confirmText }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { dialogState, handleConfirm, handleCancel } from '../services/dialogService';\r\n\r\nexport default {\r\n  name: 'DialogContainer',\r\n  setup() {\r\n    return {\r\n      dialogState,\r\n      handleConfirm,\r\n      handleCancel\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.dialog-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 9999;\r\n}\r\n.dialog-container {\r\n  background-color: #fff;\r\n  border-radius: 8px;\r\n  width: 90%;\r\n  max-width: 500px;\r\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\r\n  overflow: hidden;\r\n  animation: dialogFadeIn 0.3s;\r\n}\r\n.dialog-header {\r\n  padding: 15px 20px;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n.dialog-header h3 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n.dialog-content {\r\n  padding: 20px;\r\n}\r\n.dialog-footer {\r\n  padding: 15px 20px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n  border-top: 1px solid #eee;\r\n}\r\n.dialog-button {\r\n  padding: 10px 20px;\r\n  border-radius: 4px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  border: none;\r\n  transition: all 0.2s;\r\n}\r\n.confirm-button {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n.confirm-button:hover {\r\n  background-color: #45a049;\r\n}\r\n.cancel-button {\r\n  background-color: #f1f1f1;\r\n  color: #333;\r\n}\r\n.cancel-button:hover {\r\n  background-color: #e1e1e1;\r\n}\r\n@keyframes dialogFadeIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(-20px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./DialogContainer.vue?vue&type=template&id=4242f3ee\"\nimport script from \"./DialogContainer.vue?vue&type=script&lang=js\"\nexport * from \"./DialogContainer.vue?vue&type=script&lang=js\"\n\nimport \"./DialogContainer.vue?vue&type=style&index=0&id=4242f3ee&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <!-- Este componente no tiene representación visual, solo maneja la lógica -->\n  <div style=\"display: none;\">\n    <p>Manejador de reservas de WhatsApp activo</p>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport { saveWhatsAppReservation } from '../services/reservaService';\nimport eventBus from '../utils/eventBus';\n\nconst isProcessing = ref(false);\nconst lastProcessedMessage = ref('');\n\n// Función para procesar mensajes de WhatsApp\nconst processWhatsAppMessage = async (message) => {\n  try {\n    // Evitar procesar el mismo mensaje más de una vez\n    if (message === lastProcessedMessage.value) {\n      console.log('Mensaje ya procesado, ignorando duplicado:', message);\n      return;\n    }\n    \n    console.log('Procesando mensaje de WhatsApp:', message);\n    isProcessing.value = true;\n    lastProcessedMessage.value = message;\n    \n    // Extraer información del mensaje\n    const data = extractReservationData(message);\n    \n    if (!data) {\n      console.warn('No se pudo extraer información de reserva del mensaje:', message);\n      return;\n    }\n    \n    console.log('Datos extraídos del mensaje:', data);\n    \n    // Guardar la reserva\n    const result = await saveWhatsAppReservation(data);\n    \n    if (result.success) {\n      console.log('Reserva de WhatsApp guardada correctamente:', result.reservation);\n      \n      // Emitir evento para actualizar la lista de reservas\n      eventBus.emit('nueva-reserva', result.reservation);\n      eventBus.emit('refresh-reservations');\n      \n      console.log('Eventos emitidos: nueva-reserva y refresh-reservations');\n    } else {\n      console.error('Error al guardar reserva de WhatsApp:', result.error);\n    }\n  } catch (error) {\n    console.error('Error al procesar mensaje de WhatsApp:', error);\n  } finally {\n    isProcessing.value = false;\n  }\n};\n\n// Función para extraer datos de reserva del mensaje\nconst extractReservationData = (message) => {\n  // Implementación básica para extraer datos\n  // En un caso real, se usaría una expresión regular más robusta\n  try {\n    // Buscar patrones comunes en el mensaje\n    const nombreMatch = message.match(/\\*Nombre:\\*\\s*([^\\n]+)/i);\n    const telefonoMatch = message.match(/\\*Teléfono móvil:\\*\\s*([^\\n]+)/i);\n    const fechaMatch = message.match(/\\*Fecha:\\*\\s*([^\\n]+)/i);\n    const horaMatch = message.match(/\\*Hora:\\*\\s*([^\\n]+)/i);\n    const personasMatch = message.match(/\\*Personas:\\*\\s*([^\\n]+)/i);\n    const notasMatch = message.match(/\\*Notas:\\*\\s*([^\\n]+)/i);\n    const emailMatch = message.match(/\\*Email:\\*\\s*([^\\n]+)/i);\n    \n    // Si no encontramos al menos nombre y teléfono, no es una reserva válida\n    if (!nombreMatch && !telefonoMatch) {\n      console.warn('El mensaje no contiene información suficiente para una reserva');\n      return null;\n    }\n    \n    // Construir objeto de datos\n    return {\n      nombre: nombreMatch ? nombreMatch[1].trim() : 'Cliente sin nombre',\n      telefono: telefonoMatch ? telefonoMatch[1].trim() : '',\n      email: emailMatch ? emailMatch[1].trim() : '',\n      fecha: fechaMatch ? fechaMatch[1].trim() : new Date().toISOString().split('T')[0],\n      hora: horaMatch ? horaMatch[1].trim() : '19:00',\n      personas: personasMatch ? parseInt(personasMatch[1].trim(), 10) || 2 : 2,\n      notas: notasMatch ? notasMatch[1].trim() : 'Reserva desde WhatsApp'\n    };\n  } catch (error) {\n    console.error('Error al extraer datos del mensaje:', error);\n    return null;\n  }\n};\n\n// Función para simular la recepción de un mensaje de WhatsApp\nconst simulateWhatsAppMessage = (message) => {\n  console.log('Mensaje de WhatsApp simulado recibido');\n  processWhatsAppMessage(message);\n};\n\n// Escuchar eventos de mensajes de WhatsApp\nonMounted(() => {\n  console.log('WhatsAppReservationHandler montado');\n  eventBus.on('whatsapp-message', simulateWhatsAppMessage);\n  \n  // Para pruebas, podemos simular un mensaje después de 5 segundos\n  /*\n  setTimeout(() => {\n    simulateWhatsAppMessage(`\n      *NUEVA RESERVA DE MESA*\n      ---------------------------\n      *Nombre:* Juan Pérez\n      *Teléfono móvil:* 123456789\n      *Email:* juan@example.com\n      *Fecha:* 2023-05-15\n      *Hora:* 20:30\n      *Personas:* 4\n      *Notas:* Mesa cerca de la ventana\n      ---------------------------\n    `);\n  }, 5000);\n  */\n});\n\n// Limpiar listeners al desmontar\nonUnmounted(() => {\n  console.log('WhatsAppReservationHandler desmontado');\n  eventBus.off('whatsapp-message', simulateWhatsAppMessage);\n});\n\n// Exponer funciones para uso externo\ndefineExpose({\n  processWhatsAppMessage,\n  simulateWhatsAppMessage\n});\n</script>\n","import script from \"./WhatsAppReservationHandler.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./WhatsAppReservationHandler.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n  <div class=\"whatsapp-simulator\" v-if=\"shouldShowSimulator\">\n    <button @click=\"toggleSimulator\" class=\"toggle-button\">\n      <span v-if=\"showSimulator\">❌ Cerrar Simulador</span>\n      <span v-else>📱 Simular WhatsApp</span>\n    </button>\n    \n    <div v-if=\"showSimulator\" class=\"simulator-panel\">\n      <h3>Simulador de Reservas WhatsApp</h3>\n      \n      <div class=\"form-group\">\n        <label for=\"nombre\">Nombre:</label>\n        <input type=\"text\" id=\"nombre\" v-model=\"reservationData.nombre\" placeholder=\"Nombre del cliente\">\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"telefono\">Teléfono:</label>\n        <input type=\"text\" id=\"telefono\" v-model=\"reservationData.telefono\" placeholder=\"612345678\">\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"email\">Email:</label>\n        <input type=\"email\" id=\"email\" v-model=\"reservationData.email\" placeholder=\"cliente@example.com\">\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"fecha\">Fecha:</label>\n        <input type=\"date\" id=\"fecha\" v-model=\"reservationData.fecha\">\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"hora\">Hora:</label>\n        <select id=\"hora\" v-model=\"reservationData.hora\">\n          <option value=\"13:00\">13:00</option>\n          <option value=\"13:30\">13:30</option>\n          <option value=\"14:00\">14:00</option>\n          <option value=\"14:30\">14:30</option>\n          <option value=\"20:00\">20:00</option>\n          <option value=\"20:30\">20:30</option>\n          <option value=\"21:00\">21:00</option>\n          <option value=\"21:30\">21:30</option>\n        </select>\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"personas\">Personas:</label>\n        <select id=\"personas\" v-model=\"reservationData.personas\">\n          <option :value=\"1\">1 persona</option>\n          <option :value=\"2\">2 personas</option>\n          <option :value=\"3\">3 personas</option>\n          <option :value=\"4\">4 personas</option>\n          <option :value=\"5\">5 personas</option>\n          <option :value=\"6\">6 personas</option>\n          <option :value=\"8\">8 personas</option>\n        </select>\n      </div>\n      \n      <div class=\"form-group\">\n        <label for=\"notas\">Notas:</label>\n        <textarea id=\"notas\" v-model=\"reservationData.notas\" placeholder=\"Notas adicionales\"></textarea>\n      </div>\n      \n      <div class=\"buttons\">\n        <button @click=\"sendReservation\" class=\"send-button\" :disabled=\"isProcessing\">Enviar Reserva</button>\n      </div>\n      \n      <div v-if=\"status\" :class=\"['status', status.type]\">\n        {{ status.message }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted, onUnmounted } from 'vue';\nimport { useRoute } from 'vue-router';\nimport eventBus from '@/utils/eventBus';\n\nconst route = useRoute();\nconst showSimulator = ref(false);\nconst isProcessing = ref(false);\nconst status = ref(null);\nconst buttonEnabled = ref(false); // Inicializado en false para que esté desactivado por defecto\n\n// Determinar si estamos en la vista de login\nconst isLoginPage = computed(() => {\n  const isLoginRoute = route.name === 'login';\n  const isLoginPath = route.path === '/login' || route.path === '/login/';\n  console.log(`WhatsAppSimulator - Route check: name=${route.name}, path=${route.path}, isLoginRoute=${isLoginRoute}, isLoginPath=${isLoginPath}`);\n  return isLoginRoute || isLoginPath;\n});\n\n// Determinar si estamos en la vista de menú compartido\nconst isSharedMenuView = computed(() => {\n  return route.name === 'shared-menu' || route.path.startsWith('/menu/');\n});\n\n// Determinar si debemos mostrar el simulador basado en la página actual y la configuración\nconst shouldShowSimulator = computed(() => {\n  // No mostrar en login o menu compartido (lógica existente)\n  const showBasedOnRoute = !isLoginPage.value && !isSharedMenuView.value;\n  // No mostrar si está desactivado en la configuración\n  const result = showBasedOnRoute && buttonEnabled.value;\n  console.log(`WhatsAppSimulator - Visibility check: isLoginPage=${isLoginPage.value}, isSharedMenuView=${isSharedMenuView.value}, shouldShow=${result}`);\n  return result;\n});\n\n// Función que maneja los cambios en la configuración del botón\nconst handleConfigChange = (isEnabled) => {\n  console.log(`WhatsAppSimulator - Config changed: button enabled = ${isEnabled}`);\n  buttonEnabled.value = isEnabled;\n};\n\n// Cargar la configuración al montar el componente\nonMounted(() => {\n  console.log(`WhatsAppSimulator - Component mounted on route: ${route.name} (${route.path})`);\n  \n  // Cargar configuración del botón desde localStorage\n  const storedValue = localStorage.getItem('whatsappButtonEnabled');\n  if (storedValue !== null) {\n    buttonEnabled.value = storedValue === 'true';\n    console.log(`WhatsAppSimulator - Loaded config: button enabled = ${buttonEnabled.value}`);\n  }\n  \n  // Escuchar eventos de cambio de configuración\n  eventBus.on('whatsapp-button-config-changed', handleConfigChange);\n});\n\n// Limpiar suscripciones al desmontar el componente\nonUnmounted(() => {\n  eventBus.off('whatsapp-button-config-changed', handleConfigChange);\n});\n\n// Datos de la reserva\nconst reservationData = reactive({\n  nombre: '',\n  telefono: '',\n  email: '',\n  fecha: new Date().toISOString().split('T')[0],\n  hora: '20:00',\n  personas: 2,\n  notas: ''\n});\n\n// Función para mostrar/ocultar el simulador\nconst toggleSimulator = () => {\n  showSimulator.value = !showSimulator.value;\n};\n\n// Función para enviar la reserva\nconst sendReservation = async () => {\n  try {\n    isProcessing.value = true;\n    status.value = { type: 'info', message: 'Enviando reserva...' };\n    \n    // Validar datos mínimos\n    if (!reservationData.nombre || !reservationData.telefono) {\n      alert('Por favor, completa al menos el nombre y teléfono');\n      status.value = { type: 'error', message: 'Faltan datos obligatorios' };\n      return;\n    }\n    \n    console.log('Enviando reserva desde WhatsApp Simulator:', reservationData);\n    \n    // Construir el mensaje de WhatsApp\n    const message = `\n*NUEVA RESERVA DE MESA*\n---------------------------\n*Nombre:* ${reservationData.nombre}\n*Teléfono móvil:* ${reservationData.telefono}\n${reservationData.email ? `*Email:* ${reservationData.email}` : ''}\n*Fecha:* ${reservationData.fecha}\n*Hora:* ${reservationData.hora}\n*Personas:* ${reservationData.personas}\n${reservationData.notas ? `*Notas:* ${reservationData.notas}` : ''}\n---------------------------\nReserva enviada desde WhatsApp Simulator\n`;\n    \n    // Emitir el evento con el mensaje\n    console.log('Emitiendo evento whatsapp-message con el mensaje:', message);\n    eventBus.emit('whatsapp-message', message);\n    \n    // Emitir evento para refrescar la lista de reservas\n    console.log('Emitiendo evento refresh-reservations');\n    eventBus.emit('refresh-reservations');\n    \n    // Mostrar confirmación\n    status.value = { type: 'success', message: 'Reserva enviada correctamente' };\n    \n    // Limpiar formulario\n    clearForm();\n  } catch (error) {\n    console.error('Error al enviar reserva:', error);\n    status.value = { type: 'error', message: 'Error al enviar la reserva: ' + error.message };\n  } finally {\n    isProcessing.value = false;\n    \n    // Ocultar el mensaje después de 5 segundos\n    setTimeout(() => {\n      status.value = null;\n    }, 5000);\n  }\n};\n\n// Función para limpiar el formulario\nconst clearForm = () => {\n  reservationData.nombre = '';\n  reservationData.telefono = '';\n  reservationData.email = '';\n  reservationData.fecha = new Date().toISOString().split('T')[0];\n  reservationData.hora = '20:00';\n  reservationData.personas = 2;\n  reservationData.notas = '';\n};\n\n// Exponer funciones para uso externo\ndefineExpose({\n  toggleSimulator,\n  sendReservation\n});\n</script>\n\n<style scoped>\n.whatsapp-simulator {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  z-index: 1000;\n}\n\n.toggle-button {\n  background-color: #25D366;\n  color: white;\n  border: none;\n  border-radius: 50px;\n  padding: 10px 15px;\n  font-size: 14px;\n  cursor: pointer;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 5px;\n}\n\n.toggle-button:hover {\n  background-color: #128C7E;\n}\n\n.simulator-panel {\n  position: absolute;\n  bottom: 50px;\n  right: 0;\n  width: 300px;\n  background-color: white;\n  border-radius: 10px;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);\n  padding: 15px;\n  max-height: 80vh;\n  overflow-y: auto;\n}\n\nh3 {\n  color: #128C7E;\n  margin-top: 0;\n  text-align: center;\n  font-size: 16px;\n}\n\n.form-group {\n  margin-bottom: 10px;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-size: 14px;\n  color: #333;\n}\n\ninput, select, textarea {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\ntextarea {\n  height: 60px;\n  resize: vertical;\n}\n\n.buttons {\n  display: flex;\n  gap: 10px;\n  margin-top: 15px;\n}\n\n.send-button {\n  flex: 1;\n  padding: 8px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n  background-color: #25D366;\n  color: white;\n}\n\n.send-button:hover {\n  background-color: #128C7E;\n}\n\n.send-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.status {\n  margin-top: 15px;\n  padding: 10px;\n  border-radius: 4px;\n  font-size: 14px;\n  text-align: center;\n}\n\n.status.success {\n  background-color: #d4edda;\n  color: #155724;\n}\n\n.status.error {\n  background-color: #f8d7da;\n  color: #721c24;\n}\n\n.status.info {\n  background-color: #d1ecf1;\n  color: #0c5460;\n}\n</style>\n","import script from \"./WhatsAppSimulator.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./WhatsAppSimulator.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./WhatsAppSimulator.vue?vue&type=style&index=0&id=40696f3f&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-40696f3f\"]])\n\nexport default __exports__","// Simulador de mensajes de WhatsApp para pruebas\nimport eventBus from './eventBus';\n\n/**\n * Utilidad para simular el envío de reservas desde WhatsApp\n * Esta es una herramienta de desarrollo que permite probar la funcionalidad\n * de recepción de reservas desde WhatsApp sin necesidad de integrar realmente\n * con la API de WhatsApp.\n */\n\n/**\n * Función para simular el envío de una reserva desde WhatsApp\n * @param {Object} customData - Datos personalizados para la reserva\n * @returns {Promise<boolean>} - Resultado de la operación\n */\nexport function simulateWhatsAppReservation(customData = {}) {\n  try {\n    // Datos por defecto para la reserva\n    const defaultData = {\n      nombre: 'Cliente de Prueba WhatsApp',\n      telefono: '612345678',\n      email: 'whatsapp@example.com',\n      fecha: new Date().toISOString().split('T')[0], // Hoy\n      hora: '20:00',\n      personas: 2,\n      notas: 'Reserva realizada desde WhatsApp'\n    };\n\n    // Combinar datos por defecto con datos personalizados\n    const whatsappData = { ...defaultData, ...customData };\n    \n    console.log(' Simulando mensaje de WhatsApp con datos:', whatsappData);\n    \n    // Crear un evento con la estructura esperada por el handler\n    const whatsappEvent = {\n      type: 'whatsapp_reservation',\n      reservation: whatsappData,\n      timestamp: Date.now(),\n      id: 'whatsapp_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)\n    };\n    \n    // Enviar el evento a través de eventBus (método principal)\n    eventBus.emit('whatsapp_message', whatsappEvent);\n    \n    // También notificar que se debe actualizar la lista de reservas\n    setTimeout(() => {\n      eventBus.emit('refresh-reservations');\n    }, 1000);\n    \n    console.log(' Simulación de mensaje de WhatsApp completada');\n    return true;\n  } catch (error) {\n    console.error(' Error al simular mensaje de WhatsApp:', error);\n    return false;\n  }\n}\n\n/**\n * Función para configurar el simulador de WhatsApp en la consola\n * Esta función es necesaria para mantener compatibilidad con el código existente\n */\nexport function setupWhatsAppSimulatorForConsole() {\n  // Esta función ahora solo expone la función de simulación en el objeto window\n  // pero no hace nada más para evitar duplicación de mensajes\n  console.log('Simulador de WhatsApp configurado. Usa window.testWhatsAppReservation() para probar.');\n  return true;\n}\n\n// Exponer la función en window para poder llamarla desde la consola\nwindow.testWhatsAppReservation = simulateWhatsAppReservation;\n\nexport default {\n  simulateWhatsAppReservation,\n  setupWhatsAppSimulatorForConsole\n};\n","// Utilidad para probar reservas desde la consola del navegador\nimport { simulateWhatsAppReservation } from './whatsappSimulator';\n\n/**\n * Genera una reserva de prueba con datos aleatorios\n * @returns {Object} Datos de reserva aleatorios\n */\nfunction generateRandomReservation() {\n  const nombres = [\n    'Juan Pérez', 'María García', 'Carlos Rodríguez', 'Ana Martínez', \n    'Luis López', 'Laura Sánchez', 'Pedro González', 'Sofía Fernández'\n  ];\n  \n  const telefonos = [\n    '612345678', '623456789', '634567890', '645678901', \n    '656789012', '667890123', '678901234', '689012345'\n  ];\n  \n  const fechas = [];\n  const hoy = new Date();\n  for (let i = 1; i <= 7; i++) {\n    const fecha = new Date(hoy);\n    fecha.setDate(hoy.getDate() + i);\n    fechas.push(fecha.toISOString().split('T')[0]);\n  }\n  \n  const horas = ['13:00', '13:30', '14:00', '14:30', '20:00', '20:30', '21:00', '21:30'];\n  const personas = [1, 2, 2, 2, 3, 4, 5, 6, 8];\n  \n  return {\n    nombre: nombres[Math.floor(Math.random() * nombres.length)],\n    telefono: telefonos[Math.floor(Math.random() * telefonos.length)],\n    email: Math.random() > 0.5 ? `cliente${Math.floor(Math.random() * 100)}@example.com` : '',\n    fecha: fechas[Math.floor(Math.random() * fechas.length)],\n    hora: horas[Math.floor(Math.random() * horas.length)],\n    personas: personas[Math.floor(Math.random() * personas.length)],\n    notas: Math.random() > 0.7 ? 'Mesa cerca de la ventana si es posible' : \n           Math.random() > 0.5 ? 'Celebración de cumpleaños' : \n           Math.random() > 0.3 ? 'Alergias: gluten' : ''\n  };\n}\n\n/**\n * Envía una reserva de prueba con datos aleatorios\n */\nfunction sendRandomReservation() {\n  const randomData = generateRandomReservation();\n  console.log('Enviando reserva aleatoria:', randomData);\n  return simulateWhatsAppReservation(randomData);\n}\n\n/**\n * Envía múltiples reservas de prueba\n * @param {number} count - Número de reservas a enviar\n * @param {number} interval - Intervalo entre reservas en ms\n */\nfunction sendMultipleReservations(count = 3, interval = 2000) {\n  console.log(`Enviando ${count} reservas aleatorias con intervalo de ${interval}ms`);\n  \n  let sent = 0;\n  \n  const sendNext = () => {\n    if (sent < count) {\n      sendRandomReservation();\n      sent++;\n      setTimeout(sendNext, interval);\n    } else {\n      console.log(`✅ ${count} reservas enviadas correctamente`);\n    }\n  };\n  \n  sendNext();\n}\n\n// Exponer funciones en window para uso desde la consola\nwindow.testReservations = {\n  random: sendRandomReservation,\n  multiple: sendMultipleReservations,\n  generate: generateRandomReservation\n};\n\nexport default {\n  sendRandomReservation,\n  sendMultipleReservations,\n  generateRandomReservation\n};\n","import { reactive } from 'vue';\r\n\r\n// Estado reactivo del WebSocket\r\nexport const webSocketState = reactive({\r\n  connected: false,\r\n  reconnecting: false,\r\n  error: null,\r\n  reconnectAttempts: 0,\r\n  maxReconnectAttempts: 5,\r\n  socket: null,\r\n  messages: [],\r\n  enableWebsocket: false // Nueva bandera para habilitar/deshabilitar conexiones WebSocket\r\n});\r\n\r\n// Opciones de configuración\r\nlet config = {\r\n  reconnectInterval: 2000,\r\n  reconnectAttempts: 5\r\n};\r\n\r\n// Variable para almacenar el temporizador de reconexión\r\nlet reconnectTimer = null;\r\n\r\n/**\r\n * Inicializa la conexión WebSocket\r\n * @param {string} url - URL del servidor WebSocket\r\n * @param {Object} options - Opciones de configuración\r\n */\r\nexport function initializeWebSocket(url, options = {}) {\r\n  config = { ...config, ...options };\r\n  webSocketState.maxReconnectAttempts = config.reconnectAttempts;\r\n  \r\n  // Comprobar si el navegador soporta WebSocket\r\n  if (!('WebSocket' in window)) {\r\n    console.warn('Este navegador no soporta WebSocket');\r\n    return;\r\n  }\r\n  \r\n  // Permitir deshabilitar WebSocket en entornos de desarrollo\r\n  // o cuando el backend no soporta WebSockets\r\n  if (process.env.NODE_ENV === 'development' && !webSocketState.enableWebsocket) {\r\n    console.info('WebSocket deshabilitado en entorno de desarrollo. ' +\r\n                 'Para habilitarlo, use enableWebSocket()');\r\n    return;\r\n  }\r\n  \r\n  // Si ya existe una conexión activa, cerrarla primero\r\n  if (webSocketState.socket) {\r\n    webSocketState.socket.close();\r\n  }\r\n\r\n  try {\r\n    webSocketState.reconnecting = false;\r\n    webSocketState.error = null;\r\n    \r\n    // Crear nueva conexión\r\n    console.log(`Intentando conectar a WebSocket: ${url}`);\r\n    const socket = new WebSocket(url);\r\n    \r\n    socket.onopen = () => {\r\n      console.log('Conexión WebSocket establecida');\r\n      webSocketState.connected = true;\r\n      webSocketState.reconnecting = false;\r\n      webSocketState.error = null;\r\n      webSocketState.reconnectAttempts = 0;\r\n    };\r\n    \r\n    socket.onmessage = (event) => {\r\n      try {\r\n        const data = JSON.parse(event.data);\r\n        webSocketState.messages.push(data);\r\n        console.log('Mensaje recibido:', data);\r\n      } catch (err) {\r\n        console.error('Error al parsear mensaje WebSocket:', event.data);\r\n      }\r\n    };\r\n    \r\n    socket.onclose = (event) => {\r\n      webSocketState.connected = false;\r\n      \r\n      if (!event.wasClean) {\r\n        console.log('Conexión WebSocket cerrada inesperadamente');\r\n        scheduleReconnect();\r\n      } else {\r\n        console.log('Conexión WebSocket cerrada');\r\n      }\r\n    };\r\n    \r\n    socket.onerror = (error) => {\r\n      console.error('Error WebSocket:', error);\r\n      webSocketState.error = 'Error de conexión';\r\n      webSocketState.connected = false;\r\n      \r\n      // Solo programar reconexión si no estamos ya en ese proceso\r\n      if (!webSocketState.reconnecting) {\r\n        scheduleReconnect();\r\n      }\r\n    };\r\n    \r\n    // Guardar referencia al socket\r\n    webSocketState.socket = socket;\r\n    \r\n  } catch (error) {\r\n    console.error('Error al inicializar WebSocket:', error);\r\n    webSocketState.error = `Error al inicializar: ${error.message}`;\r\n    webSocketState.connected = false;\r\n    scheduleReconnect();\r\n  }\r\n}\r\n\r\n/**\r\n * Habilita las conexiones WebSocket\r\n */\r\nexport function enableWebSocket() {\r\n  webSocketState.enableWebsocket = true;\r\n  console.log('WebSocket habilitado. Para conectar, llame a initializeWebSocket() con la URL apropiada');\r\n}\r\n\r\n/**\r\n * Deshabilita las conexiones WebSocket\r\n */\r\nexport function disableWebSocket() {\r\n  webSocketState.enableWebsocket = false;\r\n  if (webSocketState.socket) {\r\n    closeWebSocket();\r\n  }\r\n  console.log('WebSocket deshabilitado');\r\n}\r\n\r\n/**\r\n * Programa un intento de reconexión después del intervalo configurado\r\n */\r\nfunction scheduleReconnect() {\r\n  // Limpiar cualquier temporizador existente\r\n  if (reconnectTimer) {\r\n    clearTimeout(reconnectTimer);\r\n  }\r\n  \r\n  // Verificar si debemos intentar reconectar\r\n  if (webSocketState.reconnectAttempts >= webSocketState.maxReconnectAttempts) {\r\n    console.log('Número máximo de reconexiones alcanzado');\r\n    webSocketState.reconnecting = false;\r\n    return;\r\n  }\r\n  \r\n  if (!webSocketState.enableWebsocket && process.env.NODE_ENV === 'development') {\r\n    console.log('WebSocket deshabilitado. No se intentará reconectar.');\r\n    return;\r\n  }\r\n  \r\n  // Programar reconexión\r\n  webSocketState.reconnecting = true;\r\n  webSocketState.reconnectAttempts++;\r\n  console.log(`Programando reconexión ${webSocketState.reconnectAttempts}/${webSocketState.maxReconnectAttempts} en ${config.reconnectInterval}ms`);\r\n  \r\n  reconnectTimer = setTimeout(() => {\r\n    if (webSocketState.socket && webSocketState.socket.url) {\r\n      console.log('Intentando reconexión...');\r\n      initializeWebSocket(webSocketState.socket.url);\r\n    }\r\n  }, config.reconnectInterval);\r\n}\r\n\r\n/**\r\n * Intenta reconectar inmediatamente\r\n */\r\nexport function reconnect() {\r\n  if (webSocketState.socket && webSocketState.socket.url) {\r\n    initializeWebSocket(webSocketState.socket.url);\r\n  }\r\n}\r\n\r\n/**\r\n * Detiene los intentos de reconexión\r\n */\r\nexport function stopReconnecting() {\r\n  if (reconnectTimer) {\r\n    clearTimeout(reconnectTimer);\r\n  }\r\n  webSocketState.reconnecting = false;\r\n  console.log('Intentos de reconexión detenidos');\r\n}\r\n\r\n/**\r\n * Cierra la conexión WebSocket\r\n */\r\nexport function closeWebSocket() {\r\n  stopReconnecting();\r\n  \r\n  if (webSocketState.socket) {\r\n    try {\r\n      webSocketState.socket.close();\r\n    } catch (error) {\r\n      console.error('Error al cerrar WebSocket:', error);\r\n    }\r\n    webSocketState.socket = null;\r\n  }\r\n  \r\n  webSocketState.connected = false;\r\n  console.log('Conexión WebSocket cerrada manualmente');\r\n}\r\n\r\n/**\r\n * Envía un mensaje a través del WebSocket\r\n * @param {Object} data - Datos a enviar\r\n * @returns {boolean} - true si el mensaje se envió correctamente\r\n */\r\nexport function sendMessage(data) {\r\n  if (!webSocketState.socket || webSocketState.socket.readyState !== WebSocket.OPEN) {\r\n    console.error('WebSocket no está conectado');\r\n    return false;\r\n  }\r\n  \r\n  try {\r\n    const message = JSON.stringify(data);\r\n    webSocketState.socket.send(message);\r\n    console.log('Mensaje enviado:', data);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error al enviar mensaje:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Deshabilitar WebSocket por defecto en desarrollo\r\nif (process.env.NODE_ENV === 'development') {\r\n  webSocketState.enableWebsocket = false;\r\n}\r\n\r\nexport default {\r\n  webSocketState,\r\n  initializeWebSocket,\r\n  reconnect,\r\n  closeWebSocket,\r\n  sendMessage,\r\n  stopReconnecting,\r\n  enableWebSocket,\r\n  disableWebSocket\r\n};\r\n","// connectionHandler.js - Utilidad para manejar problemas de conexión\r\n\r\nimport apiConfig from '../config/apiConfig';\r\n\r\n// Estado de la conexión\r\nlet isConnected = navigator.onLine;\r\nlet apiAvailable = false;\r\nlet connectionTestInProgress = false;\r\nlet offlineMode = localStorage.getItem('offlineMode') === 'true';\r\n\r\n/**\r\n * Prueba la conexión al API con diferentes dominios alternativos\r\n * @returns {Promise<boolean>} - true si se encuentra una API disponible\r\n */\r\nexport const testApiConnection = async () => {\r\n  // Si ya está en progreso una prueba, esperar\r\n  if (connectionTestInProgress) {\r\n    return apiAvailable;\r\n  }\r\n\r\n  connectionTestInProgress = true;\r\n  console.log('🔄 Probando conexión con la API...');\r\n  // Dominios a probar (en orden de preferencia)\r\n  const domains = [\r\n    apiConfig.API_DOMAIN,                   // Dominio configurado actual\r\n    'https://websap-backend.onrender.com',  // Servidor principal de producción (Render)\r\n    'https://allseo.xyz',                  // Servidor principal sin subdominio\r\n    'https://api.websap.app',              // Servidor alternativo\r\n    'http://localhost:3000'                // Local para desarrollo\r\n  ];\r\n\r\n  // Evitar duplicados\r\n  const uniqueDomains = [...new Set(domains)];\r\n  \r\n  // Probar cada dominio\r\n  for (const domain of uniqueDomains) {\r\n    try {\r\n      console.log(`🔍 Probando API en: ${domain}`);\r\n      \r\n      // Usar un timeout para evitar esperar demasiado\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 3000);\r\n      \r\n      const response = await fetch(`${domain}/api/test/ping`, {\r\n        method: 'GET',\r\n        signal: controller.signal,\r\n        headers: { 'Accept': 'application/json' },\r\n        mode: 'cors',\r\n        credentials: 'omit'\r\n      });\r\n      \r\n      clearTimeout(timeoutId);\r\n      \r\n      if (response.ok) {\r\n        console.log(`✅ Conexión exitosa con: ${domain}`);\r\n        \r\n        // Guardar el dominio que funciona\r\n        localStorage.setItem('apiUrl', domain);\r\n        \r\n        // Actualizar configuración\r\n        apiAvailable = true;\r\n        offlineMode = false;\r\n        localStorage.setItem('offlineMode', 'false');\r\n        \r\n        connectionTestInProgress = false;\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.warn(`❌ Error al conectar con ${domain}:`, error.name === 'AbortError' ? 'Timeout' : error.message);\r\n    }\r\n  }\r\n  \r\n  console.error('❌ No se pudo conectar con ningún servidor API');\r\n  \r\n  // Si no hay conexión, activar modo offline\r\n  apiAvailable = false;\r\n  offlineMode = true;\r\n  localStorage.setItem('offlineMode', 'true');\r\n  \r\n  connectionTestInProgress = false;\r\n  return false;\r\n};\r\n\r\n/**\r\n * Comprueba si la aplicación está en modo offline\r\n * @returns {boolean} - true si está en modo offline\r\n */\r\nexport const isOfflineMode = () => offlineMode;\r\n\r\n/**\r\n * Establece manualmente el modo offline\r\n * @param {boolean} status - true para activar el modo offline\r\n */\r\nexport const setOfflineMode = (status) => {\r\n  offlineMode = status;\r\n  localStorage.setItem('offlineMode', status ? 'true' : 'false');\r\n  console.log(`${status ? '🔌 Modo offline activado' : '🌐 Modo offline desactivado'}`);\r\n};\r\n\r\n/**\r\n * Configurar los listeners para eventos de conexión\r\n */\r\nexport const setupConnectionListeners = () => {\r\n  // Escuchar cambios en la conexión\r\n  window.addEventListener('online', async () => {\r\n    isConnected = true;\r\n    console.log('🌐 Conexión a Internet detectada');\r\n    \r\n    // Probar si la API está disponible\r\n    const apiIsAvailable = await testApiConnection();\r\n    \r\n    // Notificar a la aplicación del cambio\r\n    window.dispatchEvent(new CustomEvent('api-connection-change', { detail: { connected: apiIsAvailable } }));\r\n  });\r\n  \r\n  window.addEventListener('offline', () => {\r\n    isConnected = false;\r\n    apiAvailable = false;\r\n    console.log('🔌 Conexión a Internet perdida');\r\n    \r\n    // Notificar a la aplicación del cambio\r\n    window.dispatchEvent(new CustomEvent('api-connection-change', { detail: { connected: false } }));\r\n  });\r\n  \r\n  // Realizar un test inicial al cargar\r\n  setTimeout(() => {\r\n    testApiConnection().then(available => {\r\n      window.dispatchEvent(new CustomEvent('api-connection-change', { detail: { connected: available } }));\r\n    });\r\n  }, 1000);\r\n};\r\n\r\n// Inicializar\r\nsetupConnectionListeners();\r\n\r\nexport default {\r\n  testApiConnection,\r\n  isOfflineMode,\r\n  setOfflineMode,\r\n  apiAvailable,\r\n  isConnected\r\n};","// src/services/syncService.js\n\n// Servicio para gestionar la sincronización y el estado de la conexión\nimport { \n  getPendingPlatos, \n  updatePlatoSyncStatus, \n  getSyncQueue, \n  removeFromSyncQueue,\n  getPlato\n} from './indexedDBService';\nimport { adaptPlatoData } from '../utils/dataAdapters';\nimport { optimizeImageForSync } from './imageService';\nimport apiConfig from '../config/apiConfig';\nimport { testApiConnection, isOfflineMode } from '../utils/connectionHandler';\n\n// Función para obtener las URLs actualizadas del API\nconst getApiUrls = () => {\n  // Si el API URL fue actualizado por el connectionHandler, actualizar la configuración\n  const storedApiUrl = localStorage.getItem('apiUrl');\n  if (storedApiUrl) {\n    // Construir URLs con el dominio correcto\n    return {\n      API_URL: `${storedApiUrl}/api`,\n      RAW_URL: `${storedApiUrl}/raw`\n    };\n  }\n  \n  // Usar configuración por defecto\n  return {\n    API_URL: apiConfig.API_URL,\n    RAW_URL: apiConfig.RAW_URL\n  };\n};\n\n// URLs dinámicas que pueden actualizarse en tiempo de ejecución\nlet { API_URL, RAW_URL } = getApiUrls();\n\n// Función para actualizar las URLs de la API en tiempo de ejecución\nconst refreshApiUrls = () => {\n  const urls = getApiUrls();\n  API_URL = urls.API_URL;\n  RAW_URL = urls.RAW_URL;\n  console.log('🔄 URLs de API actualizadas:', { API_URL, RAW_URL });\n};\n\n// Escuchar los cambios de conexión para actualizar las URLs\nwindow.addEventListener('api-connection-change', (event) => {\n  console.log('🌐 Estado de conexión API cambiado:', event.detail.connected);\n  refreshApiUrls();\n});\n\n// Configuración específica para mejorar la sincronización\nconst SYNC_CONFIG = {\n  skipServerAvailabilityCheck: true,\n  maxPlatoSize: 30000, // 30KB máximo\n  retryIntervals: [5000, 15000, 30000],\n  maxRetries: 2,\n  platoUrl: `${API_URL}/sync/platos`,\n  emergencyPlatoUrl: `${API_URL}/platos/minimal`,\n  useEmergencyEndpoint: true\n};\n\n// Estado de la sincronización\nlet isSyncing = false;\nlet _isOnline = navigator.onLine;\n\n// Alternativa más simple para verificar la conexión\nconst isOnline = async () => {\n  // Primero comprobamos el estado de navigator.onLine\n  if (!navigator.onLine) {\n    return false;\n  }\n  \n  // Intentamos hacer un fetch a un recurso pequeño (como un favicon)\n  try {\n    const response = await fetch(`${API_URL}/favicon.ico`, {\n      method: 'HEAD',\n      mode: 'no-cors',\n      cache: 'no-store',\n      credentials: 'omit'\n    });\n    \n    return true; // Si no hay excepción, asumimos que estamos en línea\n  } catch (error) {\n    console.error('Error al verificar estado de conexión:', error);\n    return false;\n  }\n};\n\n// Configurar escuchas para eventos de conexión\nconst setupConnectionListeners = () => {\n  window.addEventListener('online', async () => {\n    console.log('Evento online detectado');\n    _isOnline = await isOnline();\n    if (_isOnline) {\n      console.log('Conexión a Internet restablecida');\n      // Sincronizar cuando se recupera la conexión\n      syncData();\n    }\n  });\n  \n  window.addEventListener('offline', () => {\n    console.log('Evento offline detectado');\n    _isOnline = false;\n    console.log('Conexión a Internet perdida');\n  });\n  \n  // Verificar estado inicial\n  isOnline().then(online => {\n    console.log(`Estado inicial de conexión: ${online ? 'En línea' : 'Fuera de línea'}`);\n  });\n};\n\n// Función para probar la conexión con el servidor (modo ultra-ligero)\nconst testServerConnection = async () => {\n  console.log('🔄 Probando conexión con el servidor (modo emergencia)...');\n  \n  try {\n    // Usar XMLHttpRequest sin cookies ni headers personalizados\n    const xhr = new XMLHttpRequest();\n    \n    const responsePromise = new Promise((resolve) => {\n      const timeoutId = setTimeout(() => {\n        console.warn('⏱️ Timeout en la prueba de conexión');\n        xhr.abort();\n        resolve(false);\n      }, 5000);\n      \n      xhr.onreadystatechange = function() {\n        if (xhr.readyState === 4) {\n          clearTimeout(timeoutId);\n          if (xhr.status >= 200 && xhr.status < 300) {\n            console.log('✅ Conexión básica establecida');\n            resolve(true);\n          } else if (xhr.status === 431) {\n            console.error('❌ Error 431: Request Header Fields Too Large');\n            console.log('👉 Necesitas reducir el tamaño de las cookies o headers');\n            resolve(false);\n          } else {\n            console.error(`❌ Error en prueba de conexión: ${xhr.status}`);\n            resolve(false);\n          }\n        }\n      };\n      \n      xhr.onerror = function() {\n        clearTimeout(timeoutId);\n        console.error('❌ Error de red en prueba de conexión');\n        // Intentar con endpoint de emergencia sin headers\n        checkAlternativePort().then(resolve);\n      };\n      \n      // Realizar una solicitud GET simple sin headers\n      xhr.open('GET', `${API_URL}/test/ping`, true);\n      // No añadir ningún header\n      xhr.withCredentials = false; // Importante: evitar enviar cookies\n      xhr.send();\n    });\n    \n    return await responsePromise;\n  } catch (error) {\n    console.error('❌ Error en prueba de conexión:', error);\n    return false;\n  }\n};\n\n// Comprobar puerto alternativo\nconst checkAlternativePort = async () => {\n  console.log('🔄 Probando puertos alternativos...');\n  \n  // Lista de puertos comunes para probar\n  const ports = [8080, 3000, 5000, 8000];\n  \n  for (const port of ports) {\n    try {\n      console.log(`Probando en puerto: ${port}`);\n      const response = await fetch(`http://localhost:${port}/raw/ping`, {\n        method: 'GET',\n        mode: 'no-cors',\n        cache: 'no-store',\n        credentials: 'omit'\n      });\n      \n      if (response.ok || response.status === 0) {\n        console.log(`✅ Servidor encontrado en puerto ${port}`);\n        // Actualizar URL global para usar este puerto\n        window.SERVER_PORT = port;\n        return true;\n      }\n    } catch (error) {\n      console.log(`Puerto ${port} no disponible`);\n    }\n  }\n  \n  console.error('❌ No se encontró el servidor en ningún puerto común');\n  return false;\n};\n\n// Función para probar la conexión a MySQL\nconst testMySQLConnection = async () => {\n  console.log('🔄 Probando conexión a MySQL...');\n  \n  try {\n    const response = await fetch(`${API_URL}/test/db`, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json'\n      }\n    });\n    \n    if (response.ok) {\n      const data = await response.json();\n      console.log('✅ Conexión a MySQL establecida:', data);\n      \n      // Mostrar información clara sobre la base de datos\n      if (data.data && data.data.database) {\n        console.log(`📊 Base de datos MySQL: ${data.data.database}`);\n        console.log(`📊 Tablas disponibles: ${data.data.tables.join(', ')}`);\n      }\n      \n      return true;\n    } else {\n      console.error('❌ Error al conectar con MySQL:', await response.text());\n      return false;\n    }\n  } catch (error) {\n    console.error('❌ Error de red al probar la conexión MySQL:', error);\n    return false;\n  }\n};\n\n// Función para sincronizar datos entre IndexedDB y el servidor\nconst syncData = async () => {\n  if (!await isOnline()) {\n    console.log('Sin conexión a Internet, la sincronización no es posible');\n    return false;\n  }\n  \n  if (isSyncing) {\n    console.log('Ya hay una sincronización en progreso');\n    return false;\n  }\n  \n  isSyncing = true;\n  \n  console.log('🔄 Iniciando sincronización de datos...');\n  \n  try {\n    // Procesar la cola de sincronización\n    const syncQueue = await getSyncQueue();\n    console.log(`📋 Cola de sincronización: ${syncQueue.length} elementos`);\n    \n    for (const item of syncQueue) {\n      if (item.entityType === 'plato') {\n        // Obtener el plato completo de IndexedDB\n        const plato = await getPlato(item.entityId);\n        \n        if (plato) {\n          console.log(`🍽️ Sincronizando plato: ${plato.name} (${plato.id})`);\n          \n          try {\n            // Intentar sincronización minimalista\n            const success = await syncPlato(plato);\n            \n            if (success.success) {\n              console.log(`✅ Plato ${plato.id} sincronizado correctamente`);\n              await removeFromSyncQueue(item.id);\n            } else {\n              console.error(`❌ Error al sincronizar plato ${plato.id}`);\n            }\n          } catch (syncError) {\n            console.error(`❌ Excepción al sincronizar plato ${plato.id}:`, syncError);\n          }\n        } else {\n          console.warn(`⚠️ Plato ${item.entityId} no encontrado en IndexedDB`);\n          await removeFromSyncQueue(item.id);\n        }\n      }\n    }\n    \n    // Buscar platos pendientes que no estén en la cola\n    console.log('🔍 Buscando platos pendientes de sincronización...');\n    const pendingPlatos = await getPendingPlatos();\n    console.log(`📋 Platos pendientes: ${pendingPlatos.length}`);\n    \n    for (const plato of pendingPlatos) {\n      try {\n        console.log(`🍽️ Sincronizando plato pendiente: ${plato.name} (${plato.id})`);\n        const success = await syncPlato(plato);\n        \n        if (success.success) {\n          console.log(`✅ Plato pendiente ${plato.id} sincronizado correctamente`);\n        } else {\n          console.error(`❌ Error al sincronizar plato pendiente ${plato.id}: ${success.error}`);\n        }\n      } catch (syncError) {\n        console.error(`❌ Excepción al sincronizar plato pendiente ${plato.id}: ${syncError}`);\n      }\n    }\n    \n    console.log('✅ Sincronización completada');\n    return true;\n  } catch (error) {\n    console.error('❌ Error durante la sincronización:', error);\n    return false;\n  } finally {\n    isSyncing = false;\n  }\n};\n\n// Método ultra-minimal usando XMLHttpRequest sin headers\nconst tryUltraMinimalSync = async (data, platoId) => {\n  try {\n    console.log('🚨 Intentando sincronización ultra-minimal para plato:', platoId);\n    \n    // Crear un objeto XMLHttpRequest directamente\n    const xhr = new XMLHttpRequest();\n    \n    // Configurar una promesa para manejar la respuesta\n    const responsePromise = new Promise((resolve) => {\n      // Configurar timeout\n      const timeoutId = setTimeout(() => {\n        console.warn('⏱️ Timeout en sincronización ultra-minimal');\n        xhr.abort();\n        resolve(false);\n      }, 15000);\n      \n      xhr.onreadystatechange = async function() {\n        if (xhr.readyState === 4) {\n          clearTimeout(timeoutId);\n          if (xhr.status >= 200 && xhr.status < 300) {\n            console.log('✅ Sincronización ultra-minimal exitosa');\n            try {\n              await updatePlatoSyncStatus(platoId, 'synced');\n            } catch (dbError) {\n              console.error('Error al actualizar estado en BD:', dbError);\n            }\n            resolve(true);\n          } else {\n            console.error(`❌ Error en sincronización ultra-minimal: ${xhr.status}`);\n            resolve(false);\n          }\n        }\n      };\n      \n      xhr.onerror = function() {\n        clearTimeout(timeoutId);\n        console.error('❌ Error de red en sincronización ultra-minimal');\n        resolve(false);\n      };\n    });\n    \n    // Usar método POST con datos minimalistas\n    xhr.open('POST', `${API_URL}/platos/emergency-sync`, true);\n    \n    // Solo agregar Content-Type, nada más\n    xhr.setRequestHeader('Content-Type', 'application/json');\n    \n    // Preparar datos ultra-minimalistas\n    const adaptedData = await adaptPlatoDataWithImageOptimization(data);\n    const minimalData = {\n      id: adaptedData.id,\n      name: (adaptedData.name || \"\").substring(0, 30),\n      price: Number(adaptedData.price) || 0\n    };\n    \n    // Enviar los datos\n    xhr.send(JSON.stringify(minimalData));\n    \n    return await responsePromise;\n  } catch (error) {\n    console.error('❌ Error en sincronización ultra-minimal:', error);\n    return false;\n  }\n};\n\n// Procesar la cola de sincronización\nconst processSyncQueue = async () => {\n  if (!await isOnline() || isSyncing) {\n    console.log(`No se puede procesar la cola. En línea: ${_isOnline}, Sincronizando: ${isSyncing}`);\n    return false;\n  }\n  \n  isSyncing = true;\n  console.log('Iniciando procesamiento de cola de sincronización...');\n  \n  try {\n    const syncItems = await getSyncQueue();\n    \n    if (syncItems.length === 0) {\n      console.log('No hay elementos en la cola de sincronización');\n      isSyncing = false;\n      return true;\n    }\n    \n    console.log(`Procesando ${syncItems.length} elementos en la cola de sincronización`);\n    \n    // Procesar cada elemento de la cola\n    for (const item of syncItems) {\n      let syncSuccess = false;\n      \n      if (item.type === 'create' && item.entityType === 'plato') {\n        syncSuccess = await syncPlatoToServer(item.data);\n      }\n      // Aquí pueden agregarse más tipos de sincronización según sea necesario\n      \n      if (syncSuccess) {\n        // Eliminar de la cola si la sincronización fue exitosa\n        await removeFromSyncQueue(item.id);\n        console.log(`Elemento ${item.id} eliminado de la cola de sincronización`);\n      } else {\n        console.log(`No se pudo sincronizar el elemento ${item.id}, se reintentará más tarde`);\n      }\n    }\n    \n    console.log('Procesamiento de cola de sincronización completado');\n    return true;\n  } catch (error) {\n    console.error('Error al procesar cola de sincronización:', error);\n    return false;\n  } finally {\n    isSyncing = false;\n  }\n};\n\n// Método de sincronización extremadamente simplificado para problemas persistentes\nexport const syncMinimalDataOnly = async (data, platoId, retryCount = 0) => {\n  const maxRetries = SYNC_CONFIG.maxRetries;\n  \n  // Usar datos minimalistas pero incluir la imagen optimizada\n  const adaptedData = await adaptPlatoDataWithImageOptimization(data);\n  const minimalData = {\n    id: adaptedData.id,\n    name: adaptedData.name?.substring(0, 50) || 'Plato sin nombre',\n    price: Number(adaptedData.price) || 0,\n    description: adaptedData.description?.substring(0, 100) || '',\n    category: adaptedData.category || 'principal',\n    image: adaptedData.image, // Incluir la imagen optimizada\n    is_available: Boolean(adaptedData.is_available),\n    minimal_sync: true\n  };\n  \n  return new Promise((resolve) => {\n    // Establecer timeout para toda la operación\n    const operationTimeoutId = setTimeout(() => {\n      console.warn('⏱️ Timeout global de la operación de sincronización');\n      resolve(false);\n    }, 30000);\n    \n    const xhr = new XMLHttpRequest();\n    \n    // Configurar timeouts más estrictos\n    xhr.timeout = 15000;\n    \n    xhr.onreadystatechange = async function() {\n      if (xhr.readyState === 4) {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          clearTimeout(operationTimeoutId);\n          try {\n            await updatePlatoSyncStatus(platoId, 'synced');\n            console.log(`✅ Sincronización exitosa para plato ${platoId}`);\n          } catch (error) {\n            console.error('Error al actualizar estado:', error);\n          }\n          resolve(true);\n        } else if (xhr.status === 0) {\n          // Conexión abortada o no establecida\n          console.warn('⚠️ Conexión interrumpida');\n          handleRetry();\n        } else if (xhr.status === 431) {\n          console.error(`❌ Error 431 (Headers demasiado grandes) - Intentando método ultraminimal`);\n          tryUltraMinimalSync(adaptedData, platoId).then(success => {\n            clearTimeout(operationTimeoutId);\n            resolve(success);\n          });\n        } else {\n          console.error(`❌ Error HTTP ${xhr.status} en sincronización`);\n          handleRetry();\n        }\n      }\n    };\n    \n    xhr.ontimeout = function() {\n      console.warn('⏱️ Timeout de la petición HTTP');\n      handleRetry();\n    };\n    \n    xhr.onerror = function() {\n      console.error('❌ Error de red en sincronización');\n      handleRetry();\n    };\n    \n    // Función para manejar reintentos\n    const handleRetry = () => {\n      if (retryCount < maxRetries) {\n        const delay = SYNC_CONFIG.retryIntervals[retryCount] || 5000;\n        console.log(`🔄 Reintentando en ${delay}ms... (${retryCount + 1}/${maxRetries})`);\n        \n        setTimeout(() => {\n          clearTimeout(operationTimeoutId);\n          syncMinimalDataOnly(data, platoId, retryCount + 1)\n            .then(success => resolve(success));\n        }, delay);\n      } else {\n        clearTimeout(operationTimeoutId);\n        console.warn('❌ Agotados todos los reintentos de sincronización');\n        resolve(false);\n      }\n    };\n    \n    try {\n      // Usar método POST con headers mínimos\n      xhr.open('POST', `${API_URL}/platos`, true);\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      \n      // Enviar los datos minimalistas\n      xhr.send(JSON.stringify(minimalData));\n    } catch (error) {\n      console.error('❌ Error al iniciar la petición:', error);\n      handleRetry();\n    }\n  });\n};\n\n// Sincronizar un plato con el servidor\nconst syncPlatoToServer = async (plato, retryCount = 0) => {\n  const maxRetries = SYNC_CONFIG.maxRetries;\n  \n  // Si el plato está marcado como problemático, omitirlo\n  if (plato.sync_problematic) {\n    console.warn(`⚠️ Omitiendo plato ${plato.id} marcado como problemático para sincronización`);\n    return false;\n  }\n  \n  console.log(`Sincronizando plato ${plato.id} con el servidor (intento ${retryCount + 1}/${maxRetries + 1})...`);\n  \n  try {\n    // Omitir verificación si está desactivada\n    if (!SYNC_CONFIG.skipServerAvailabilityCheck) {\n      // Verificar si el servidor está disponible\n      const serverAvailable = await checkServerAvailability();\n      if (!serverAvailable) {\n        console.error('❌ El servidor no está disponible. Posponiendo sincronización.');\n        return false;\n      }\n    }\n    \n    // Preparar datos para sincronización incluyendo la imagen\n    let adaptedData = await adaptPlatoDataWithImageOptimization(plato);\n    let syncData = {\n      id: adaptedData.id,\n      name: adaptedData.name?.substring(0, 50) || 'Plato sin nombre',\n      price: Number(adaptedData.price) || 0,\n      description: adaptedData.description?.substring(0, 100) || '',\n      availableQuantity: Number(adaptedData.availableQuantity) || 0,\n      is_available: Boolean(adaptedData.is_available),\n      image: adaptedData.image || null, // Incluir la imagen\n      minimal_sync: true\n    };\n    \n    // Usar el método más confiable para sincronización\n    return await syncPlato(adaptedData);\n  } catch (error) {\n    console.error('❌ Error en sincronización:', error);\n    \n    if (retryCount >= maxRetries) {\n      try {\n        await markPlatoAsSyncProblematic(plato.id);\n      } catch (markError) {\n        console.error('Error al marcar plato como problemático:', markError);\n      }\n    }\n    \n    return false;\n  }\n};\n\n// Verificar estado de sincronización con el backend\nconst checkSyncStatus = async () => {\n  try {\n    console.log('🔄 Verificando estado de sincronización...');\n    \n    const response = await fetch(`${API_URL}/sync/status`, {\n      method: 'GET',\n      headers: { 'Accept': 'application/json' },\n      credentials: 'omit' // Importante: no enviar cookies\n    });\n    \n    if (response.ok) {\n      const data = await response.json();\n      console.log('📊 Estado de sincronización:', data);\n      \n      // Si no existe la tabla, intentar crearla\n      if (!data.data.mysql.tablaPlatos) {\n        console.log('⚠️ La tabla platos no existe, intentando configurar...');\n        await setupSync();\n      }\n      \n      return data.data;\n    } else {\n      console.error('❌ Error al verificar estado de sincronización:', await response.text());\n      return null;\n    }\n  } catch (error) {\n    console.error('❌ Error al verificar estado de sincronización:', error);\n    return null;\n  }\n};\n\n// Configurar la sincronización - crear tablas necesarias\nconst setupSync = async () => {\n  try {\n    console.log('🔄 Configurando sincronización...');\n    \n    const response = await fetch(`${API_URL}/sync/setup`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'omit',\n      body: JSON.stringify({ force: false })\n    });\n    \n    if (response.ok) {\n      const data = await response.json();\n      console.log('✅ Configuración de sincronización completada:', data);\n      return true;\n    } else {\n      console.error('❌ Error al configurar sincronización:', await response.text());\n      return false;\n    }\n  } catch (error) {\n    console.error('❌ Error al configurar sincronización:', error);\n    return false;\n  }\n};\n\n// Inicializar el servicio de sincronización\nconst initSyncService = () => {\n  console.log('🔄 Inicializando servicio de sincronización...');\n  \n  // Probar conexiones y configurar sincronización\n  Promise.all([\n    testServerConnection(),\n    checkSyncStatus()\n  ]).then(([isApiConnected, syncStatus]) => {\n    console.log(`✅ Estado de conexión directa - API: ${isApiConnected}`);\n    \n    if (isApiConnected) {\n      // Configurar escuchas para eventos de conexión\n      setupConnectionListeners();\n      \n      // Si hay estado de sincronización, proceder con la sincronización\n      if (syncStatus && syncStatus.mysql && syncStatus.mysql.connected) {\n        console.log('📊 MySQL conectado, procediendo con sincronización');\n        syncData();\n        \n        // Reactivar la sincronización periódica (cada 1 minuto)\n        const syncInterval = setInterval(syncData, 60000);\n      } else {\n        console.log('⚠️ MySQL no está configurado correctamente, intentando configurar...');\n        setupSync().then(success => {\n          if (success) {\n            console.log('✅ Configuración exitosa, iniciando sincronización');\n            syncData();\n            \n            // Reactivar la sincronización periódica (cada 1 minuto)\n            const syncInterval = setInterval(syncData, 60000);\n          }\n        });\n      }\n    } else {\n      console.error('❌ No se pudo establecer conexión con el servidor.');\n    }\n  });\n  \n  console.log('⚙️ Servicio de sincronización inicializado');\n};\n\n// Exportar las funciones necesarias\nexport {\n  initSyncService,\n  syncData,\n  isOnline,\n  _isOnline,\n  testServerConnection,\n  testMySQLConnection,\n  checkSyncStatus,\n  setupSync,\n  syncPlato,\n  adaptPlatoDataWithImageOptimization\n};\n\n// Asegúrate de que la función que maneja la sincronización tenga un mejor manejo de errores\n\n/**\n * Función para sincronizar un plato con el servidor, asegurando que la imagen se incluya\n * @param {Object} plato - El plato a sincronizar\n * @returns {Promise<Object>} - Resultado de la sincronización\n */\nconst syncPlato = async (plato) => {\n  console.log(`🔄 Sincronizando plato: ${plato.name} (ID: ${plato.id})`);\n  \n  try {\n    // Preparar los datos para enviar (incluir la imagen optimizada)\n    const platoToSync = await adaptPlatoDataWithImageOptimization(plato);\n    \n    // Omitir la imagen en los logs para evitar mensajes demasiado largos\n    console.log('📤 Datos a enviar:', { \n      ...platoToSync, \n      image: platoToSync.image ? 'Imagen en base64 (omitida en log)' : null \n    });\n    \n    // Imprimir la URL exacta para depuración\n    const url = SYNC_CONFIG.platoUrl; // Usar la configuración existente\n    console.log(`🔗 URL de sincronización: ${url}`);\n    \n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(platoToSync),\n      // Evitar que se incluyan cookies u otros datos de autenticación si no son necesarios\n      credentials: 'omit'\n    });\n    \n    // Verificar si la respuesta es exitosa\n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error(`❌ Error de sincronización (${response.status}): ${errorText}`);\n      \n      // Intentar con el método de sincronización minimalista si hay un error\n      if (response.status >= 400) {\n        console.log('⚠️ Intentando sincronización minimalista como fallback...');\n        return await syncMinimalDataOnly(plato);\n      }\n      \n      return {\n        success: false,\n        message: `Error de servidor: ${response.status} ${response.statusText}`,\n        error: errorText\n      };\n    }\n    \n    // Procesar la respuesta exitosa\n    const responseData = await response.json();\n    console.log('✅ Sincronización exitosa:', responseData);\n    \n    // Actualizar el estado de sincronización en IndexedDB\n    try {\n      await updatePlatoSyncStatus(plato.id, true);\n      console.log(`✅ Estado de sincronización actualizado para plato ID: ${plato.id}`);\n    } catch (syncStatusError) {\n      console.warn(`⚠️ No se pudo actualizar el estado de sincronización: ${syncStatusError.message}`);\n    }\n    \n    return {\n      success: true,\n      message: 'Plato sincronizado correctamente',\n      data: responseData\n    };\n  } catch (error) {\n    console.error('❌ Error en sincronización:', error);\n    \n    // Intentar con el método de sincronización minimalista si hay un error\n    console.log('⚠️ Intentando sincronización minimalista como fallback...');\n    return await syncMinimalDataOnly(plato);\n  }\n};\n\n// Función para adaptar los datos del plato antes de sincronizar, con optimización de imágenes\nconst adaptPlatoDataWithImageOptimization = async (plato) => {\n  // Crear una copia para no modificar el original\n  const adaptedData = { ...plato };\n  \n  // Asegurarse de que todos los campos necesarios estén presentes\n  adaptedData.id = plato.id;\n  adaptedData.name = plato.name || 'Plato sin nombre';\n  adaptedData.price = parseFloat(plato.price) || 0;\n  adaptedData.description = plato.description || '';\n  adaptedData.category = plato.category || 'principal';\n  \n  // Optimizar la imagen si existe\n  if (plato.image && typeof plato.image === 'string' && plato.image.length > 0) {\n    try {\n      adaptedData.image = await optimizeImageForSync(plato.image);\n      console.log(`Imagen optimizada para ${plato.name}`);\n    } catch (error) {\n      console.warn(`Error al optimizar imagen para ${plato.name}:`, error);\n      adaptedData.image = plato.image; // Usar la original en caso de error\n    }\n  } else {\n    adaptedData.image = plato.image || null;\n  }\n  \n  adaptedData.image_url = plato.image_url || '';\n  adaptedData.is_available = plato.is_available !== false;\n  adaptedData.includesDrink = plato.includesDrink || false;\n  adaptedData.availableQuantity = plato.availableQuantity || 0;\n  \n  return adaptedData;\n};\n\n/**\n * Actualiza el estado de sincronización de un elemento\n * @param {string} id - ID del elemento\n * @param {string|boolean} status - Estado de sincronización ('pending', 'synced', 'pending_deletion' o un booleano)\n * @returns {Promise<boolean>} - true si se actualizó correctamente\n */\nexport async function updateSyncStatus(id, status) {\n  try {\n    // Validar que el status sea uno de los valores permitidos o convertir booleano a string\n    let validStatus = status;\n    \n    // Si es booleano, convertirlo al estado correspondiente\n    if (typeof status === 'boolean') {\n      validStatus = status === true ? 'synced' : 'pending';\n    }\n    \n    // Ahora validar que sea uno de los estados permitidos\n    if (!['pending', 'synced', 'pending_deletion'].includes(validStatus)) {\n      console.warn(`⚠️ No se pudo actualizar el estado de sincronización: Estado inválido: ${status}. Debe ser uno de: pending, synced, pending_deletion`);\n      return false;\n    }\n    \n    // Continuar con la lógica existente para actualizar el estado\n    // ...existing code...\n    \n    return true;\n  } catch (error) {\n    console.error('Error al actualizar estado de sincronización:', error);\n    return false;\n  }\n}","import { render } from \"./App.vue?vue&type=template&id=7a64aa75\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=7a64aa75&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <div class=\"home-container\">\r\n    <h1>Sistema de Gestión de Menú</h1>\r\n    \r\n    <div class=\"auth-options\">\r\n      <router-link to=\"/login\" class=\"auth-button login\">Iniciar Sesión</router-link>\r\n      <router-link to=\"/register\" class=\"auth-button register\">Registrarse</router-link>\r\n    </div>\r\n    \r\n    <div class=\"login-info\">\r\n      <p>Para probar la aplicación, puedes usar estas credenciales:</p>\r\n      <ul>\r\n        <li><strong>Email:</strong> superadmin@example.com | <strong>Contraseña:</strong>SuperAdmin2023</li>\r\n        <li><strong>Email:</strong> admin@example.com      | <strong>Contraseña:</strong>Admin2023</li>\r\n        <li><strong>Email:</strong> empleado@example.com   | <strong>Contraseña:</strong>Empleado2023</li>\r\n      </ul>\r\n    </div>\r\n    \r\n    <div class=\"menu-options\">\r\n      <div class=\"option-card\" @click=\"goToMenu\">\r\n        <h2>Gestionar Menú</h2>\r\n        <p>Configura tu menú, precios y formas de pago</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRouter } from 'vue-router';\r\n\r\nexport default {\r\n  name: 'HomeView',\r\n  setup() {\r\n    const router = useRouter();\r\n    \r\n    const goToMenu = () => {\r\n      router.push('/menu');\r\n    };\r\n    \r\n    return {\r\n      goToMenu\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.home-container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 40px 20px;\r\n  text-align: center;\r\n}\r\n\r\nh1 {\r\n  margin-bottom: 40px;\r\n  color: #4CAF50;\r\n}\r\n\r\n.auth-options {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 20px;\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.auth-button {\r\n  padding: 12px 30px;\r\n  border-radius: 4px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  text-decoration: none;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.auth-button.login {\r\n  background-color: #007bff;\r\n  color: white;\r\n}\r\n\r\n.auth-button.login:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n.auth-button.register {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.auth-button.register:hover {\r\n  background-color: #218838;\r\n}\r\n\r\n.menu-options {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 30px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.option-card {\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  padding: 30px;\r\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\r\n  width: 300px;\r\n  cursor: pointer;\r\n  transition: transform 0.3s, box-shadow 0.3s;\r\n}\r\n\r\n.option-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\r\n}\r\n\r\nh2 {\r\n  margin-bottom: 15px;\r\n  color: #333;\r\n}\r\n\r\np {\r\n  color: #666;\r\n  line-height: 1.5;\r\n}\r\n\r\n/* Estilos para la información de inicio de sesión */\r\n.login-info {\r\n  margin: 20px auto;\r\n  padding: 15px;\r\n  background-color: #f0f7ff;\r\n  border-radius: 8px;\r\n  border-left: 4px solid #007bff;\r\n  max-width: 600px;\r\n  text-align: left;\r\n}\r\n\r\n.login-info p {\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n.login-info ul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\n.login-info li {\r\n  padding: 5px 0;\r\n  font-size: 14px;\r\n}\r\n\r\n/* garantizar una buena experiencia en dispositivos móviles */\r\n@media (max-width: 480px) {\r\n  .payment-options {\r\n    flex-direction: column;\r\n    gap: 8px;\r\n  }\r\n  \r\n  .payment-option {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./HomeView.vue?vue&type=template&id=4e8e3a5c&scoped=true\"\nimport script from \"./HomeView.vue?vue&type=script&lang=js\"\nexport * from \"./HomeView.vue?vue&type=script&lang=js\"\n\nimport \"./HomeView.vue?vue&type=style&index=0&id=4e8e3a5c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4e8e3a5c\"]])\n\nexport default __exports__","<template>\n  <div class=\"login-container\">\n    <div class=\"login-card\">\n      <h1 class=\"login-title\">Iniciar Sesión</h1>\n      \n      <form @submit.prevent=\"handleLogin\" class=\"login-form\">\n        <div class=\"form-group\">\n          <label for=\"email\">Correo electrónico</label>\n          <input \n            type=\"email\" \n            id=\"email\" \n            v-model=\"email\" \n            required \n            placeholder=\"Ingresa tu correo\" \n          />\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"password\">Contraseña</label>\n          <input \n            type=\"password\" \n            id=\"password\" \n            v-model=\"password\" \n            required \n            placeholder=\"Ingresa tu contraseña\" \n          />\n        </div>\n        \n        <div v-if=\"errorMessage\" class=\"error-message\">\n          {{ errorMessage }}\n        </div>\n        \n        <button type=\"submit\" :disabled=\"isLoading\" class=\"login-button\">\n          {{ isLoading ? 'Iniciando sesión...' : 'Iniciar Sesión' }}\n        </button>\n      </form>\n      \n      <div class=\"login-options\">\n        <router-link to=\"/register\">¿No tienes cuenta? Regístrate</router-link>\n        <a href=\"#\" @click.prevent=\"handleForgotPassword\">¿Olvidaste tu contraseña?</a>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue';\nimport { useRouter, useRoute } from 'vue-router';\nimport { login } from '@/services/authService';\nimport { alert } from '../services/dialogService';\n\nexport default {\n  name: 'LoginView',\n  setup() {\n    const router = useRouter();\n    const route = useRoute();\n    const email = ref('');\n    const password = ref('');\n    const isLoading = ref(false);\n    const errorMessage = ref('');\n\n    const handleLogin = async () => {\n      // Limpiar mensajes de error previos\n      errorMessage.value = '';\n      isLoading.value = true;\n      \n      try {\n        // Limpiar completamente cualquier sesión anterior\n        localStorage.clear(); // Limpia todo el localStorage\n        sessionStorage.clear(); // Limpia todo el sessionStorage\n        \n        // Intentar iniciar sesión\n        console.log('Intentando login con:', email.value);\n        const result = await login(email.value, password.value);\n        \n        console.log('Login exitoso:', result);\n        \n        // Establecer el estado de autenticación\n        localStorage.setItem('isLoggedIn', 'true');\n        \n        // Redirigir según el rol del usuario\n        if (result.user.roles && result.user.roles.includes('Superadministrador')) {\n          // Redirigir a vista de SuperAdmin\n          router.push('/superadmin');\n        } else if (result.user.roles && result.user.roles.includes('Administrador')) {\n          // Redirigir a vista de Admin\n          router.push('/admin');\n        } else {\n          // Redirigir a vista de Empleado para cualquier otro rol\n          router.push('/employee');\n        }\n      } catch (error) {\n        console.error('Error de login:', error);\n        errorMessage.value = error.message || 'Error al iniciar sesión';\n      } finally {\n        isLoading.value = false;\n      }\n    };\n\n    const handleForgotPassword = async () => {\n      await alert('Función de recuperación de contraseña no implementada en esta versión de demostración.');\n    };\n\n    return {\n      email,\n      password,\n      isLoading,\n      errorMessage,\n      handleLogin,\n      handleForgotPassword\n    };\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: calc(100vh - 100px);\n  padding: 20px;\n  background-color: #f5f5f5;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 400px;\n  padding: 25px;\n  background-color: white;\n  border-radius: 10px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n}\n\n.login-title {\n  text-align: center;\n  color: #4CAF50;\n  margin-bottom: 25px;\n  font-size: 28px;\n}\n\n.login-form {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.form-group {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-group label {\n  font-weight: 600;\n  color: #333;\n}\n\n.form-group input {\n  padding: 12px 15px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 16px;\n  transition: border-color 0.3s;\n  background-color: #f0f8ff;\n}\n\n.form-group input:focus {\n  border-color: #4CAF50;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);\n}\n\n.login-button {\n  padding: 12px;\n  background-color: #4CAF50;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  height: 45px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.login-button:hover:not(:disabled) {\n  background-color: #45a049;\n}\n\n.login-button:disabled {\n  background-color: #a5d6a7;\n  cursor: not-allowed;\n}\n\n.loading-spinner {\n  width: 20px;\n  height: 20px;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  border-radius: 50%;\n  border-top-color: white;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.login-options {\n  margin-top: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 10px;\n}\n\n.login-options a {\n  color: #4CAF50;\n  text-decoration: none;\n  font-size: 14px;\n}\n\n.login-options a:hover {\n  text-decoration: underline;\n}\n\n.credentials-info {\n  background-color: #f9f9f9;\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n  padding: 15px;\n  font-size: 14px;\n}\n\n.credentials-info p {\n  margin-top: 0;\n  margin-bottom: 8px;\n}\n\n.credentials-info ul {\n  margin: 0;\n  padding-left: 20px;\n}\n\n.credentials-info li {\n  margin-bottom: 5px;\n}\n\n.error-message {\n  color: #d32f2f;\n  margin-bottom: 1rem;\n  font-size: 0.9rem;\n  text-align: center;\n}\n\n@media (max-width: 480px) {\n  .login-card {\n    padding: 20px;\n  }\n  \n  .login-title {\n    font-size: 24px;\n  }\n  \n  .form-group input {\n    padding: 10px;\n  }\n}\n\n.login-form button[type=\"submit\"] {\n  padding: 12px;\n  background-color: #4CAF50;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  width: 100%;\n}\n\n.login-form button[type=\"submit\"]:hover:not(:disabled) {\n  background-color: #45a049;\n}\n\n.login-form button[type=\"submit\"]:disabled {\n  background-color: #a5d6a7;\n  cursor: not-allowed;\n}\n</style>\n","import { render } from \"./LoginView.vue?vue&type=template&id=7af9a333&scoped=true\"\nimport script from \"./LoginView.vue?vue&type=script&lang=js\"\nexport * from \"./LoginView.vue?vue&type=script&lang=js\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=7af9a333&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7af9a333\"]])\n\nexport default __exports__","import { createRouter, createWebHistory } from 'vue-router'\nimport HomeView from '../views/HomeView.vue'\nimport { isAuthenticated, hasRole, getCurrentUser, removeToken } from '../services/authService'\nimport { alert } from '../services/dialogService'\nimport LoginView from '../views/LoginView.vue'\n\nconst routes = [\n  {\n    path: '/',\n    name: 'home',\n    component: HomeView\n  },\n  {\n    path: '/about',\n    name: 'about',\n    component: () => import(/* webpackChunkName: \"about\" */ '../views/AboutView.vue')\n  },\n  {\n    path: '/login',\n    name: 'login',\n    component: LoginView,\n    meta: { requiresGuest: true }\n  },\n  {\n    path: '/register',\n    name: 'register',\n    component: () => import(/* webpackChunkName: \"register\" */ '../views/RegisterView.vue')\n  },\n  {\n    path: '/menu',\n    name: 'menu',\n    component: () => import(/* webpackChunkName: \"menu\" */ '../components/MenuComponent.vue'),\n    meta: { requiresAuth: true }\n  },\n  {\n    path: '/menu/:id',\n    name: 'shared-menu',\n    component: () => import(/* webpackChunkName: \"shared-menu\" */ '../views/SharedMenuView.vue'),\n    props: true\n  },\n  {\n    path: '/superadmin',\n    name: 'superadmin',\n    component: () => import(/* webpackChunkName: \"superadmin\" */ '../views/SuperAdminView.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Superadministrador']\n    }\n  },\n  {\n    path: '/admin',\n    name: 'admin',\n    component: () => import(/* webpackChunkName: \"admin\" */ '../views/AdminView.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador']\n    }\n  },\n  {\n    path: '/admin/sync-business-info',\n    name: 'sync-business-info',\n    component: () => import(/* webpackChunkName: \"sync-business-info\" */ '../components/admin/SyncBusinessInfo.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador']\n    }\n  },\n  {\n    path: '/employee',\n    name: 'employee',\n    component: () => import(/* webpackChunkName: \"employee\" */ '../views/EmployeeView.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Empleado']\n    }\n  },\n  {\n    path: '/platos',\n    name: 'platos',\n    component: () => import(/* webpackChunkName: \"platos\" */ '../views/PlatosView.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador']\n    }\n  },\n  {\n    path: '/admin/usuarios',\n    name: 'admin-usuarios',\n    component: () => import(/* webpackChunkName: \"admin-usuarios\" */ '../components/admin/AdminUsuarios.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador']\n    }\n  },\n  {\n    path: '/admin/restaurantes',\n    name: 'admin-restaurantes',\n    component: () => import(/* webpackChunkName: \"admin-restaurantes\" */ '../components/admin/AdminRestaurantes.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador']\n    }\n  },\n  {\n    path: '/reservas',\n    name: 'reservas',\n    component: () => import(/* webpackChunkName: \"reservas\" */ '../views/ReservasView.vue'),\n    meta: { \n      requiresAuth: true,\n      roles: ['Administrador', 'Superadministrador', 'Empleado']\n    }\n  },\n  {\n    path: '/:pathMatch(.*)*',\n    name: 'notFound',\n    component: () => import('../views/NotFound.vue')\n  }\n]\n\nconst router = createRouter({\n  history: createWebHistory(process.env.NODE_ENV === 'production' ? '/websap/' : '/'),\n  routes\n})\n\n// Navegación con protección de rutas\nrouter.beforeEach(async (to, from, next) => {\n  const requiresAuth = to.matched.some(record => record.meta.requiresAuth)\n  const requiresGuest = to.matched.some(record => record.meta.requiresGuest)\n  const requiresRoles = to.meta.roles\n  \n  // Limpiar cualquier información de usuario incorrecta o desactualizada\n  if (to.path === '/login') {\n    localStorage.removeItem('user');\n    localStorage.removeItem('isLoggedIn');\n    removeToken();\n  }\n  \n  // Si la ruta requiere autenticación y el usuario no está autenticado\n  if (requiresAuth && !isAuthenticated()) {\n    await alert('Debe iniciar sesión para acceder a esta página', {\n      title: 'Acceso Restringido'\n    });\n    next({ name: 'login' })\n  }\n  // Si la ruta requiere ser invitado y el usuario está autenticado\n  else if (requiresGuest && isAuthenticated()) {\n    // Determinar a dónde redirigir basado en el rol\n    const user = getCurrentUser();\n    if (user && user.roles) {\n      if (user.roles.includes('Superadministrador')) {\n        next({ name: 'superadmin' });\n      } else if (user.roles.includes('Administrador')) {\n        next({ name: 'admin' });\n      } else {\n        next({ name: 'employee' });\n      }\n    } else {\n      next({ name: 'home' });\n    }\n  }\n  // Si la ruta requiere roles específicos\n  else if (requiresRoles && isAuthenticated()) {\n    const userHasRequiredRole = requiresRoles.some(role => hasRole(role))\n    if (!userHasRequiredRole) {\n      // Redirigir a una página de acceso denegado o dashboard por defecto\n      await alert('No tiene permisos para acceder a esta sección', {\n        title: 'Acceso Denegado'\n      });\n      next({ name: 'home' })\n    } else {\n      next()\n    }\n  }\n  else {\n    next()\n  }\n})\n\nexport default router","const DB_NAME = 'websapDatabase';\r\nconst DB_VERSION = 3;\r\n\r\n// Definir todos los almacenes necesarios\r\nconst REQUIRED_STORES = [\r\n  { name: 'menuItems', keyPath: 'id' },\r\n  { name: 'menuImages', keyPath: 'id' },\r\n  { name: 'soldItems', keyPath: 'id' },\r\n  { name: 'businessInfo', keyPath: 'id' },\r\n  { name: 'users', keyPath: 'id' },\r\n  { name: 'sharedMenus', keyPath: 'id' }\r\n];\r\n\r\nexport async function initializeDatabase() {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      const request = indexedDB.open(DB_NAME, DB_VERSION);\r\n      \r\n      request.onerror = (event) => {\r\n        console.error('Error al abrir la base de datos:', event.target.error);\r\n        reject(event.target.error);\r\n      };\r\n      \r\n      request.onsuccess = (event) => {\r\n        const db = event.target.result;\r\n        console.log('Base de datos abierta correctamente, versión:', db.version);\r\n        \r\n        // Verificar que todos los almacenes existen\r\n        const existingStores = Array.from(db.objectStoreNames);\r\n        let allStoresExist = true;\r\n        \r\n        const missingStores = REQUIRED_STORES.filter(store => !existingStores.includes(store.name));\r\n        \r\n        if (missingStores.length > 0) {\r\n          console.error('Faltan los siguientes almacenes:', missingStores.map(s => s.name).join(', '));\r\n          allStoresExist = false;\r\n          \r\n          // Cerrar la conexión antes de intentar aumentar la versión\r\n          db.close();\r\n          \r\n          // Incrementar la versión para forzar la creación de los almacenes faltantes\r\n          const newVersion = DB_VERSION + 1;\r\n          console.log(`Intentando actualizar a versión ${newVersion} para crear almacenes faltantes`);\r\n          \r\n          const updateRequest = indexedDB.open(DB_NAME, newVersion);\r\n          \r\n          updateRequest.onupgradeneeded = (event) => {\r\n            const db = event.target.result;\r\n            for (const store of missingStores) {\r\n              if (!db.objectStoreNames.contains(store.name)) {\r\n                db.createObjectStore(store.name, { keyPath: store.keyPath });\r\n                console.log(`Almacén creado: ${store.name}`);\r\n              }\r\n            }\r\n          };\r\n          \r\n          updateRequest.onerror = (err) => {\r\n            console.error('Error al actualizar la base de datos:', err.target.error);\r\n            reject(err.target.error);\r\n          };\r\n          \r\n          updateRequest.onsuccess = () => {\r\n            console.log('Base de datos actualizada correctamente con los nuevos almacenes');\r\n            resolve();\r\n          };\r\n        } else {\r\n          console.log('Todos los almacenes existen en la base de datos');\r\n          resolve();\r\n        }\r\n      };\r\n      \r\n      request.onupgradeneeded = (event) => {\r\n        const db = event.target.result;\r\n        \r\n        for (const store of REQUIRED_STORES) {\r\n          if (!db.objectStoreNames.contains(store.name)) {\r\n            db.createObjectStore(store.name, { keyPath: store.keyPath });\r\n            console.log(`Almacén creado: ${store.name}`);\r\n          }\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('Error crítico al inicializar la base de datos:', error);\r\n      reject(error);\r\n    }\r\n  });\r\n}\r\n","import { createApp } from 'vue'\nimport App from './App.vue'\nimport router from './router'\nimport { initializeDatabase } from './services/dbInitializer'\n\n// Añadir estilos globales\nimport './assets/global.css'\n// Añadir estilos de tema\nimport './assets/theme.css'\n\n// Importar utilidades de prueba para WhatsApp\nimport './utils/whatsappSimulator';\nimport './utils/testReservations';\n\n// Función para formatear fechas\nfunction formatDate(dateString) {\n    if (!dateString) return '';\n    \n    try {\n        // Formato específico con T y Z: \"29T05:00:00.000Z/05/2025\"\n        if (typeof dateString === 'string' && dateString.includes('T') && dateString.includes('/')) {\n            const parts = dateString.split('/');\n            if (parts.length === 3) {\n                const day = parts[0].split('T')[0];\n                return `${day}/${parts[1]}/${parts[2]}`;\n            }\n        }\n        \n        // Formato ISO: \"2025-05-29\"\n        if (typeof dateString === 'string' && dateString.includes('-')) {\n            const parts = dateString.split('-');\n            if (parts.length === 3) {\n                return `${parts[2]}/${parts[1]}/${parts[0]}`;\n            }\n        }\n        \n        // Intentar parsear como objeto Date\n        const date = new Date(dateString);\n        if (!isNaN(date.getTime())) {\n            const day = date.getDate().toString().padStart(2, '0');\n            const month = (date.getMonth() + 1).toString().padStart(2, '0');\n            const year = date.getFullYear();\n            return `${day}/${month}/${year}`;\n        }\n        \n        // Si no se puede formatear, devolver el string original\n        return dateString;\n    } catch (error) {\n        console.error('Error al formatear fecha:', error);\n        return dateString;\n    }\n}\n\n// Inicializar la base de datos antes de montar la aplicación\nasync function init() {\n    try {\n        await initializeDatabase();\n        console.log('Base de datos inicializada correctamente');\n        \n        // Crear y montar la aplicación solo después de que la BD esté lista\n        const app = createApp(App);\n        \n        // Registrar filtro global para formatear fechas\n        app.config.globalProperties.$filters = {\n            formatDate\n        };\n        \n        app.use(router);\n        app.mount('#app');\n    } catch (error) {\n        console.error('Error al inicializar la aplicación:', error);\n    }\n}\n\ninit();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + ({\"83\":\"employee\",\"140\":\"reservas\",\"224\":\"register\",\"260\":\"shared-menu\",\"328\":\"admin-restaurantes\",\"441\":\"superadmin\",\"594\":\"about\",\"654\":\"admin-usuarios\",\"770\":\"platos\",\"884\":\"admin\"}[chunkId] || chunkId) + \".\" + {\"70\":\"23a9c7a1\",\"83\":\"c1af6227\",\"140\":\"dca8d07a\",\"207\":\"af4c0005\",\"224\":\"aeadf46b\",\"260\":\"1f75a3f7\",\"328\":\"811fa75c\",\"441\":\"cb464c08\",\"457\":\"783786d0\",\"460\":\"ef1c2356\",\"463\":\"71b0ceb1\",\"594\":\"bc4f37bc\",\"654\":\"b50025b2\",\"668\":\"335d74e6\",\"770\":\"af87abfb\",\"869\":\"8943b79c\",\"884\":\"64249cfc\",\"970\":\"bf0aa9bd\",\"982\":\"84da56ab\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"css/\" + ({\"83\":\"employee\",\"140\":\"reservas\",\"224\":\"register\",\"260\":\"shared-menu\",\"328\":\"admin-restaurantes\",\"441\":\"superadmin\",\"594\":\"about\",\"654\":\"admin-usuarios\",\"770\":\"platos\",\"838\":\"sync-business-info\",\"854\":\"menu\",\"884\":\"admin\"}[chunkId] || chunkId) + \".\" + {\"83\":\"3d5ca415\",\"140\":\"e1c71206\",\"224\":\"2f3b7f9e\",\"260\":\"3b5ce1dd\",\"328\":\"4d8e7f9a\",\"441\":\"d9ebc473\",\"463\":\"9936a330\",\"594\":\"187c5855\",\"654\":\"4bcf276b\",\"770\":\"40de06ea\",\"838\":\"183a93b2\",\"854\":\"e5de4efe\",\"869\":\"7aa96af8\",\"884\":\"a3789379\"}[chunkId] + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"websap:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/websap/\";","if (typeof document === \"undefined\") return;\nvar createStylesheet = function(chunkId, fullhref, oldTag, resolve, reject) {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tif (__webpack_require__.nc) {\n\t\tlinkTag.nonce = __webpack_require__.nc;\n\t}\n\tvar onLinkComplete = function(event) {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && event.type;\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + errorType + \": \" + realHref + \")\");\n\t\t\terr.name = \"ChunkLoadError\";\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tif (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\n\tif (oldTag) {\n\t\toldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);\n\t} else {\n\t\tdocument.head.appendChild(linkTag);\n\t}\n\treturn linkTag;\n};\nvar findStylesheet = function(href, fullhref) {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = function(chunkId) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, null, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t524: 0\n};\n\n__webpack_require__.f.miniCss = function(chunkId, promises) {\n\tvar cssChunks = {\"83\":1,\"140\":1,\"224\":1,\"260\":1,\"328\":1,\"441\":1,\"463\":1,\"594\":1,\"654\":1,\"770\":1,\"838\":1,\"854\":1,\"869\":1,\"884\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(function() {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, function(e) {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr\n\n// no prefetching\n\n// no preloaded","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(!/^8(38|54)$/.test(chunkId)) {\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkwebsap\"] = self[\"webpackChunkwebsap\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(9864); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["API_URL","apiConfig","token","localStorage","getItem","setToken","newToken","setItem","removeItem","get","async","endpoint","options","headers","response","fetch","method","responseType","blob","contentType","includes","text","success","ok","data","status","json","console","warn","Error","message","error","post","body","JSON","stringify","put","del","delete","saveToken","getToken","removeToken","setupAxiosInterceptors","axios","interceptors","request","use","config","Authorization","Promise","reject","window","location","pathname","href","login","email","password","log","withCredentials","timeout","then","apiService","default","user","localUsers","id","nombre","roles","find","u","localToken","btoa","logout","isAuthenticated","isLoggedInFlag","getCurrentUser","userStr","parse","hasRole","role","API_DOMAIN","DB_NAME","DB_VERSION","PLATOS_STORE","SYNC_QUEUE_STORE","getAllPlatos","db","openDB","resolve","transaction","store","objectStore","getAll","onsuccess","event","allPlatos","target","result","length","activePlatos","filter","plato","deleted","onerror","getPendingPlatos","index","pendingPlatos","updatePlatoSyncStatus","validStatus","validStatuses","join","indexedDB","open","platosStore","getRequest","syncStatus","is_available","updateRequest","oncomplete","close","addToSyncQueue","item","add","getSyncQueue","queue","removeFromSyncQueue","logDB","name","version","Array","from","objectStoreNames","setInterval","verifyPlatoStorage","createPlato","trim","platoToCreate","createdAt","Date","toISOString","updatedAt","localTimestamp","getTime","now","Math","floor","random","createdPlato","type","entityType","entityId","timestamp","syncError","platos","found","p","listError","setTimeout","verified","verifyError","transactionError","debugIndexedDB","databases","syncQueue","stores","normalizePlatoData","platoData","normalizedData","price","parseFloat","availableQuantity","parseInt","includesDrink","image","image_thumbnail","compressImageForSync","has_local_image","imageDataUrl","startsWith","match","maxLength","actualData","substring","guardarPlato","platoParaGuardar","platoGuardado","getPlato","debugDB","isProd","process","storedApiUrl","apiDomain","production","RAW_URL","API_TEST_ENDPOINT","development","currentConfig","dialogState","reactive","show","title","confirmText","cancelText","showCancel","resolvePromise","Boolean","confirm","alert","handleConfirm","handleCancel","reservationsStore","savedReservations","saveReservationsToStorage","saveReservation","reservationData","reservationId","toString","substr","reservation","fullName","mobilePhone","landlinePhone","address","date","reservationDate","time","reservationTime","peopleCount","notes","additionalNotes","source","telefono","fecha","hora","personas","notas","created_by","usuario_id","apiError","unshift","eventBus","emit","getReservations","isArray","reservas","backendReservations","map","res","formatDateToDDMMYYYY","estado","creado_en","origen","reservations","formattedReservations","updateReservationStatus","reservationIndex","findIndex","saveWhatsAppReservation","reserva","reservaCompleta","reservationObject","saveReservaLocally","localReserva","pendingSave","deleteReservation","r","splice","isReservationOlderThan","days","today","diffTime","diffDays","ceil","dateString","parts","split","day","isNaN","getDate","padStart","month","getMonth","year","getFullYear","EventBus","constructor","this","events","on","callback","push","off","indexOf","payload","forEach","compressImage","base64Image","maxWidth","quality","img","Image","onload","canvas","document","createElement","width","height","round","ctx","getContext","drawImage","compressedBase64","toDataURL","src","optimizeImageForSync","maxSizeKB","sizeKB","compressedImage","key","class","xmlns","viewBox","_imports_0","alt","_imports_1","_createElementBlock","_normalizeClass","$data","isDarkMode","$options","wsState","reconnecting","_hoisted_1","_createElementVNode","_createTextVNode","_toDisplayString","reconnectAttempts","maxReconnectAttempts","onClick","_cache","args","stopReconnecting","_hoisted_2","handleReconnect","_createCommentVNode","showNav","_hoisted_3","_hoisted_4","_createVNode","_component_router_link","to","_withCtx","_","_hoisted_5","isLoggedIn","_Fragment","isSuperAdmin","_createBlock","isEmployee","_withModifiers","toggleDarkMode","svgFallback","_hoisted_6","fill","d","_hoisted_7","_hoisted_8","_hoisted_9","_component_router_view","_component_WhatsAppReservationHandler","ref","_component_WhatsAppSimulator","_component_DialogContainer","$setup","setup","__exports__","isProcessing","lastProcessedMessage","processWhatsAppMessage","value","extractReservationData","nombreMatch","telefonoMatch","fechaMatch","horaMatch","personasMatch","notasMatch","emailMatch","simulateWhatsAppMessage","onMounted","onUnmounted","__expose","route","useRoute","showSimulator","buttonEnabled","isLoginPage","computed","isLoginRoute","isLoginPath","path","isSharedMenuView","shouldShowSimulator","showBasedOnRoute","handleConfigChange","isEnabled","storedValue","toggleSimulator","sendReservation","clearForm","simulateWhatsAppReservation","customData","defaultData","whatsappData","whatsappEvent","testWhatsAppReservation","generateRandomReservation","nombres","telefonos","fechas","hoy","i","setDate","horas","sendRandomReservation","randomData","sendMultipleReservations","count","interval","sent","sendNext","testReservations","multiple","generate","webSocketState","connected","socket","messages","enableWebsocket","reconnectInterval","reconnectTimer","initializeWebSocket","url","WebSocket","onopen","onmessage","err","onclose","wasClean","scheduleReconnect","disableWebSocket","closeWebSocket","clearTimeout","reconnect","isConnected","navigator","onLine","apiAvailable","connectionTestInProgress","offlineMode","testApiConnection","domains","uniqueDomains","Set","domain","controller","AbortController","timeoutId","abort","signal","mode","credentials","setupConnectionListeners","addEventListener","apiIsAvailable","dispatchEvent","CustomEvent","detail","available","getApiUrls","refreshApiUrls","urls","SYNC_CONFIG","skipServerAvailabilityCheck","maxPlatoSize","retryIntervals","maxRetries","platoUrl","emergencyPlatoUrl","useEmergencyEndpoint","isSyncing","_isOnline","isOnline","cache","syncData","online","testServerConnection","xhr","XMLHttpRequest","responsePromise","onreadystatechange","readyState","checkAlternativePort","send","ports","port","SERVER_PORT","syncPlato","tryUltraMinimalSync","platoId","dbError","setRequestHeader","adaptedData","adaptPlatoDataWithImageOptimization","minimalData","Number","syncMinimalDataOnly","retryCount","description","category","minimal_sync","operationTimeoutId","handleRetry","ontimeout","delay","checkSyncStatus","mysql","tablaPlatos","setupSync","force","initSyncService","all","isApiConnected","platoToSync","errorText","statusText","responseData","syncStatusError","image_url","components","DialogContainer","WhatsAppReservationHandler","WhatsAppSimulator","whatsappHandler","$route","watch","methods","authLogout","$router","nextTick","documentElement","classList","remove","mounted","testImg","require","prefersDarkMode","matchMedia","matches","unmounted","render","_createStaticVNode","goToMenu","router","useRouter","onSubmit","handleLogin","for","$event","required","placeholder","errorMessage","disabled","isLoading","handleForgotPassword","clear","sessionStorage","routes","component","HomeView","LoginView","meta","requiresGuest","requiresAuth","props","createRouter","history","createWebHistory","beforeEach","next","matched","some","record","requiresRoles","userHasRequiredRole","REQUIRED_STORES","keyPath","initializeDatabase","existingStores","allStoresExist","missingStores","s","newVersion","onupgradeneeded","contains","createObjectStore","formatDate","init","app","createApp","App","globalProperties","$filters","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","n","getter","__esModule","a","leafPrototypes","getProto","getPrototypeOf","obj","__proto__","t","ns","create","def","current","getOwnPropertyNames","definition","o","defineProperty","enumerable","f","e","chunkId","reduce","promises","miniCssF","g","globalThis","Function","prop","prototype","hasOwnProperty","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","setAttribute","onScriptComplete","prev","doneFns","parentNode","removeChild","bind","head","appendChild","Symbol","toStringTag","createStylesheet","fullhref","oldTag","linkTag","rel","nonce","onLinkComplete","errorType","realHref","code","insertBefore","nextSibling","findStylesheet","existingLinkTags","tag","dataHref","existingStyleTags","loadStylesheet","installedCssChunks","miniCss","cssChunks","installedChunks","installedChunkData","test","promise","loadingEnded","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}