{"version":3,"file":"js/462.9fa985ef.js","mappings":"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","sources":["webpack://websap/./src/components/admin/SyncBusinessInfo.vue","webpack://websap/./src/services/businessInfoService.js","webpack://websap/./src/components/admin/SyncBusinessInfo.vue?9654"],"sourcesContent":["<template>\n  <div class=\"sync-business-info\">\n    <h2>Sincronización de Información del Negocio</h2>\n    \n    <div v-if=\"message\" class=\"alert\" :class=\"{ 'alert-success': success, 'alert-danger': !success && message }\">\n      {{ message }}\n    </div>\n    \n    <div class=\"status-info\">\n      <div class=\"status-item\">\n        <strong>Estado de sincronización:</strong> \n        <span :class=\"isAutoSyncEnabled ? 'status-active' : 'status-inactive'\">\n          {{ isAutoSyncEnabled ? 'Activa' : 'Inactiva' }}\n        </span>\n      </div>\n      \n      <div class=\"status-item\">\n        <strong>Última sincronización:</strong> \n        <span>{{ lastSyncFormatted }}</span>\n      </div>\n    </div>\n    \n    <div class=\"settings-section\">\n      <h3>Configuración de Sincronización</h3>\n      \n      <div class=\"form-group\">\n        <label class=\"toggle-switch\">\n          <input type=\"checkbox\" v-model=\"isAutoSyncEnabled\" @change=\"toggleAutoSync\">\n          <span class=\"slider\"></span>\n          <span class=\"toggle-label\">Sincronización automática</span>\n        </label>\n      </div>\n      \n      <div class=\"form-group\">\n        <label>Intervalo de verificación:</label>\n        <select v-model=\"syncInterval\" @change=\"updateSyncInterval\" :disabled=\"!isAutoSyncEnabled\">\n          <option value=\"15000\">15 segundos (pruebas)</option>\n          <option value=\"30000\">30 segundos</option>\n          <option value=\"60000\">1 minuto</option>\n          <option value=\"300000\">5 minutos</option>\n        </select>\n      </div>\n    </div>\n    \n    <div class=\"actions\">\n      <button @click=\"runMigration\" class=\"btn btn-primary\" :disabled=\"loading\">\n        <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n        Ejecutar Migración\n      </button>\n      \n      <button @click=\"syncBusinessInfo\" class=\"btn btn-success\" :disabled=\"loading\">\n        <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n        Sincronizar Ahora\n      </button>\n      \n      <button @click=\"fetchFromBackend\" class=\"btn btn-info\" :disabled=\"loading\">\n        <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n        Actualizar desde Servidor\n      </button>\n      \n      <button @click=\"syncAndRefresh\" class=\"btn btn-warning\" :disabled=\"loading\">\n        <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\n        Sincronizar y Refrescar\n      </button>\n    </div>\n    \n    <div class=\"current-info\" v-if=\"businessInfo\">\n      <h3>Información Actual del Negocio</h3>\n      <div class=\"info-card\">\n        <div class=\"info-header\">\n          <h4>{{ businessInfo.name || 'Sin nombre' }}</h4>\n          <div class=\"info-badge\">{{ lastUpdateFormatted }}</div>\n        </div>\n        <div class=\"info-content\">\n          <div class=\"info-row\">\n            <strong>Descripción:</strong> {{ businessInfo.description || 'Sin descripción' }}\n          </div>\n          <div class=\"info-row\">\n            <strong>Dirección:</strong> {{ businessInfo.address || 'Sin dirección' }}\n          </div>\n          <div class=\"info-row\">\n            <strong>Contacto:</strong> {{ businessInfo.contact || 'Sin contacto' }}\n          </div>\n          <div class=\"info-row logo-preview\" v-if=\"businessInfo.logo\">\n            <strong>Logo:</strong>\n            <img :src=\"businessInfo.logo\" alt=\"Logo\" class=\"logo-thumbnail\">\n          </div>\n          <div class=\"info-row\" v-if=\"businessInfo.paymentInfo\">\n            <strong>Información de Pago:</strong>\n            <div class=\"payment-info\">\n              <div v-if=\"businessInfo.paymentInfo.qrTitle\">QR: {{ businessInfo.paymentInfo.qrTitle }}</div>\n              <div v-if=\"businessInfo.paymentInfo.nequiNumber\">Nequi: {{ businessInfo.paymentInfo.nequiNumber }}</div>\n              <div v-if=\"businessInfo.paymentInfo.bankInfo\">Banco: {{ businessInfo.paymentInfo.bankInfo }}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"sync-log\">\n      <h3>Registro de Sincronización</h3>\n      <div class=\"log-container\">\n        <div v-for=\"(log, index) in syncLogs\" :key=\"index\" class=\"log-entry\" :class=\"{'log-success': log.success, 'log-error': !log.success}\">\n          <div class=\"log-timestamp\">{{ formatTimestamp(log.timestamp) }}</div>\n          <div class=\"log-message\">{{ log.message }}</div>\n        </div>\n        <div v-if=\"syncLogs.length === 0\" class=\"log-empty\">\n          No hay registros de sincronización.\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\nimport {\n  runAddInformacionPagoMigration,\n  syncBusinessInfoWithBackend,\n  fetchBusinessInfoFromBackend,\n  startBusinessInfoSyncInterval,\n  stopBusinessInfoSyncInterval,\n  checkForBusinessInfoChanges,\n  invalidateBusinessInfoCache\n} from '../../services/businessInfoService';\nimport { getBusinessInfo } from '../../services/storageService';\nimport eventBus from '../../utils/eventBus';\n\nexport default {\n  name: 'SyncBusinessInfo',\n  \n  setup() {\n    const loading = ref(false);\n    const success = ref(false);\n    const message = ref('');\n    const businessInfo = ref(null);\n    const lastSync = ref(null);\n    const lastUpdate = ref(null);\n    const isAutoSyncEnabled = ref(true);\n    const syncInterval = ref('30000');\n    const syncLogs = ref([]);\n    \n    // Formatear la fecha de última sincronización\n    const lastSyncFormatted = computed(() => {\n      if (!lastSync.value) return 'Nunca';\n      return formatTimestamp(lastSync.value);\n    });\n    \n    // Formatear la fecha de última actualización\n    const lastUpdateFormatted = computed(() => {\n      if (!lastUpdate.value) return '';\n      return `Actualizado: ${formatTimestamp(lastUpdate.value)}`;\n    });\n    \n    // Formatear timestamp en fecha legible\n    const formatTimestamp = (timestamp) => {\n      if (!timestamp) return '';\n      const date = new Date(timestamp);\n      return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;\n    };\n    \n    // Añadir entrada al registro de sincronización\n    const addSyncLog = (logMessage, isSuccess = true) => {\n      syncLogs.value.unshift({\n        message: logMessage,\n        success: isSuccess,\n        timestamp: Date.now()\n      });\n      \n      // Limitar a 10 entradas\n      if (syncLogs.value.length > 10) {\n        syncLogs.value = syncLogs.value.slice(0, 10);\n      }\n    };\n    \n    // Manejar evento de actualización de información\n    const handleBusinessInfoUpdate = (updatedInfo) => {\n      businessInfo.value = updatedInfo;\n      lastUpdate.value = Date.now();\n      addSyncLog('Información del negocio actualizada');\n    };\n    \n    // Cargar la información del negocio al montar el componente\n    onMounted(async () => {\n      try {\n        // Suscribirse al evento de actualización\n        eventBus.on('business-info-updated', handleBusinessInfoUpdate);\n        \n        // Cargar la información del negocio\n        await loadBusinessInfo();\n        \n        // Iniciar sincronización automática\n        if (isAutoSyncEnabled.value) {\n          startBusinessInfoSyncInterval();\n          addSyncLog('Sincronización automática iniciada');\n        }\n      } catch (error) {\n        console.error('Error al montar el componente:', error);\n        message.value = 'Error al cargar información del negocio';\n        success.value = false;\n        addSyncLog('Error al cargar información del negocio', false);\n      }\n    });\n    \n    onUnmounted(() => {\n      // Cancelar suscripción al evento\n      eventBus.off('business-info-updated', handleBusinessInfoUpdate);\n      \n      // Detener sincronización automática\n      stopBusinessInfoSyncInterval();\n    });\n    \n    // Cargar la información del negocio\n    const loadBusinessInfo = async () => {\n      try {\n        loading.value = true;\n        businessInfo.value = await getBusinessInfo();\n        lastUpdate.value = Date.now();\n      } catch (error) {\n        console.error('Error al cargar información del negocio:', error);\n        message.value = 'Error al cargar información del negocio';\n        success.value = false;\n        addSyncLog('Error al cargar información del negocio', false);\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // Ejecutar la migración para añadir la columna informacion_pago\n    const runMigration = async () => {\n      try {\n        loading.value = true;\n        message.value = 'Ejecutando migración...';\n        \n        const result = await runAddInformacionPagoMigration();\n        \n        success.value = result.success;\n        message.value = result.message;\n        \n        if (result.success) {\n          addSyncLog('Migración ejecutada con éxito');\n        } else {\n          addSyncLog(`Error en migración: ${result.message}`, false);\n        }\n      } catch (error) {\n        console.error('Error al ejecutar migración:', error);\n        success.value = false;\n        message.value = error.message || 'Error al ejecutar migración';\n        addSyncLog(`Error en migración: ${error.message}`, false);\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // Sincronizar la información del negocio con el backend\n    const syncBusinessInfo = async () => {\n      try {\n        loading.value = true;\n        message.value = 'Sincronizando información...';\n        \n        const result = await syncBusinessInfoWithBackend();\n        \n        success.value = result.success;\n        message.value = result.message;\n        \n        if (result.success) {\n          lastSync.value = result.timestamp || Date.now();\n          await loadBusinessInfo();\n          addSyncLog('Sincronización completada con éxito');\n        } else {\n          addSyncLog(`Error en sincronización: ${result.message}`, false);\n        }\n      } catch (error) {\n        console.error('Error al sincronizar información:', error);\n        success.value = false;\n        message.value = error.message || 'Error al sincronizar información';\n        addSyncLog(`Error en sincronización: ${error.message}`, false);\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // Obtener la información del negocio desde el backend\n    const fetchFromBackend = async () => {\n      try {\n        loading.value = true;\n        message.value = 'Obteniendo información desde el servidor...';\n        \n        // Invalidar la caché primero\n        invalidateBusinessInfoCache();\n        \n        // Forzar la actualización desde el backend\n        businessInfo.value = await fetchBusinessInfoFromBackend(true);\n        \n        success.value = true;\n        message.value = 'Información actualizada desde el servidor';\n        lastUpdate.value = Date.now();\n        addSyncLog('Información actualizada desde el servidor');\n      } catch (error) {\n        console.error('Error al obtener información desde el servidor:', error);\n        success.value = false;\n        message.value = error.message || 'Error al obtener información desde el servidor';\n        addSyncLog(`Error al obtener información: ${error.message}`, false);\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // Sincronizar y verificar cambios\n    const syncAndRefresh = async () => {\n      try {\n        loading.value = true;\n        message.value = 'Sincronizando y verificando cambios...';\n        \n        // Sincronizar la información actual con el backend\n        await syncBusinessInfoWithBackend();\n        \n        // Verificar si hay cambios\n        const hasChanges = await checkForBusinessInfoChanges();\n        \n        if (hasChanges) {\n          success.value = true;\n          message.value = 'Se detectaron y aplicaron cambios en la información';\n          addSyncLog('Se detectaron y aplicaron cambios');\n        } else {\n          success.value = true;\n          message.value = 'No se detectaron cambios en la información';\n          addSyncLog('No se detectaron cambios');\n        }\n        \n        // Actualizar la información\n        await loadBusinessInfo();\n        lastSync.value = Date.now();\n      } catch (error) {\n        console.error('Error al sincronizar y verificar cambios:', error);\n        success.value = false;\n        message.value = error.message || 'Error al sincronizar y verificar cambios';\n        addSyncLog(`Error al sincronizar: ${error.message}`, false);\n      } finally {\n        loading.value = false;\n      }\n    };\n    \n    // Alternar sincronización automática\n    const toggleAutoSync = () => {\n      if (isAutoSyncEnabled.value) {\n        startBusinessInfoSyncInterval();\n        addSyncLog('Sincronización automática activada');\n      } else {\n        stopBusinessInfoSyncInterval();\n        addSyncLog('Sincronización automática desactivada');\n      }\n    };\n    \n    // Actualizar intervalo de sincronización\n    const updateSyncInterval = () => {\n      // Detener el intervalo actual\n      stopBusinessInfoSyncInterval();\n      \n      // Actualizar SYNC_INTERVAL en businessInfoService.js\n      // Esto es solo visual, ya que no podemos modificar directamente la constante\n      addSyncLog(`Intervalo de sincronización actualizado a ${parseInt(syncInterval.value) / 1000} segundos`);\n      \n      // Reiniciar si está habilitado\n      if (isAutoSyncEnabled.value) {\n        startBusinessInfoSyncInterval();\n      }\n    };\n    \n    return {\n      loading,\n      success,\n      message,\n      businessInfo,\n      lastSync,\n      lastSyncFormatted,\n      lastUpdateFormatted,\n      isAutoSyncEnabled,\n      syncInterval,\n      syncLogs,\n      runMigration,\n      syncBusinessInfo,\n      fetchFromBackend,\n      syncAndRefresh,\n      toggleAutoSync,\n      updateSyncInterval,\n      formatTimestamp\n    };\n  }\n};\n</script>\n\n<style scoped>\n.sync-business-info {\n  padding: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  margin-bottom: 20px;\n  box-shadow: 0 2px 10px rgba(0,0,0,0.05);\n}\n\n.sync-business-info h2 {\n  color: #333;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #dee2e6;\n}\n\n.alert {\n  padding: 12px;\n  margin: 15px 0;\n  border-radius: 6px;\n}\n\n.alert-success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n.alert-danger {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.status-info {\n  background: #fff;\n  padding: 15px;\n  border-radius: 6px;\n  margin-bottom: 20px;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20px;\n  border: 1px solid #e9ecef;\n}\n\n.status-item {\n  padding: 8px 0;\n}\n\n.status-active {\n  color: #28a745;\n  font-weight: bold;\n}\n\n.status-inactive {\n  color: #dc3545;\n  font-weight: bold;\n}\n\n.settings-section {\n  background: #fff;\n  padding: 15px;\n  border-radius: 6px;\n  margin-bottom: 20px;\n  border: 1px solid #e9ecef;\n}\n\n.settings-section h3 {\n  font-size: 1.2rem;\n  margin-bottom: 15px;\n  color: #495057;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: 500;\n}\n\n.form-group select {\n  width: 100%;\n  max-width: 300px;\n  padding: 8px;\n  border-radius: 4px;\n  border: 1px solid #ced4da;\n}\n\n.toggle-switch {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.toggle-switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.slider {\n  position: relative;\n  cursor: pointer;\n  width: 50px;\n  height: 24px;\n  background-color: #ccc;\n  transition: .4s;\n  border-radius: 24px;\n  margin-right: 10px;\n}\n\n.slider:before {\n  position: absolute;\n  content: \"\";\n  height: 16px;\n  width: 16px;\n  left: 4px;\n  bottom: 4px;\n  background-color: white;\n  transition: .4s;\n  border-radius: 50%;\n}\n\ninput:checked + .slider {\n  background-color: #28a745;\n}\n\ninput:checked + .slider:before {\n  transform: translateX(26px);\n}\n\n.toggle-label {\n  font-weight: 500;\n}\n\n.actions {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px;\n  margin: 20px 0;\n}\n\n.current-info {\n  margin-top: 30px;\n}\n\n.info-card {\n  background-color: #fff;\n  border-radius: 6px;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  overflow: hidden;\n}\n\n.info-header {\n  background-color: #f8f9fa;\n  padding: 15px;\n  border-bottom: 1px solid #dee2e6;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.info-header h4 {\n  margin: 0;\n  color: #343a40;\n  font-size: 1.2rem;\n}\n\n.info-badge {\n  font-size: 0.85rem;\n  color: #6c757d;\n}\n\n.info-content {\n  padding: 15px;\n}\n\n.info-row {\n  margin-bottom: 12px;\n  border-bottom: 1px solid #f0f0f0;\n  padding-bottom: 12px;\n}\n\n.info-row strong {\n  color: #495057;\n  margin-right: 5px;\n}\n\n.logo-thumbnail {\n  max-width: 100px;\n  max-height: 60px;\n  margin-top: 5px;\n  border-radius: 4px;\n  display: block;\n}\n\n.payment-info {\n  margin-top: 5px;\n  padding-left: 15px;\n  border-left: 2px solid #e9ecef;\n}\n\n.sync-log {\n  margin-top: 30px;\n}\n\n.sync-log h3 {\n  color: #333;\n  margin-bottom: 15px;\n}\n\n.log-container {\n  background-color: #fff;\n  border-radius: 6px;\n  border: 1px solid #dee2e6;\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.log-entry {\n  padding: 10px 15px;\n  border-bottom: 1px solid #f0f0f0;\n  display: flex;\n  align-items: center;\n}\n\n.log-success {\n  border-left: 4px solid #28a745;\n}\n\n.log-error {\n  border-left: 4px solid #dc3545;\n}\n\n.log-timestamp {\n  font-size: 0.85rem;\n  color: #6c757d;\n  width: 180px;\n  flex-shrink: 0;\n}\n\n.log-message {\n  flex-grow: 1;\n}\n\n.log-empty {\n  padding: 15px;\n  color: #6c757d;\n  text-align: center;\n  font-style: italic;\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 120px;\n}\n\n.btn-primary {\n  background-color: #007bff;\n  color: white;\n}\n\n.btn-success {\n  background-color: #28a745;\n  color: white;\n}\n\n.btn-info {\n  background-color: #17a2b8;\n  color: white;\n}\n\n.btn-warning {\n  background-color: #ffc107;\n  color: #212529;\n}\n\n.btn:disabled {\n  opacity: 0.65;\n  cursor: not-allowed;\n}\n\n.spinner-border-sm {\n  display: inline-block;\n  width: 1rem;\n  height: 1rem;\n  border: 0.2em solid currentColor;\n  border-right-color: transparent;\n  border-radius: 50%;\n  animation: spinner-border .75s linear infinite;\n  margin-right: 5px;\n}\n\n@keyframes spinner-border {\n  to { transform: rotate(360deg); }\n}\n\n@media (max-width: 768px) {\n  .actions {\n    flex-direction: column;\n  }\n  \n  .btn {\n    width: 100%;\n  }\n  \n  .status-info {\n    flex-direction: column;\n    gap: 10px;\n  }\n}\n</style>\n","// src/services/businessInfoService.js\n\nimport apiService from './apiService';\nimport { getBusinessInfo, saveBusinessInfo } from './storageService';\nimport eventBus from '../utils/eventBus';\n\n// Constantes para la sincronización\nconst SYNC_INTERVAL = 30000; // 30 segundos\nconst CACHE_DURATION = 300000; // 5 minutos\nlet syncIntervalId = null;\nlet lastSyncTimestamp = 0;\nlet lastFetchTimestamp = 0;\nlet businessInfoCache = null;\nlet isInitialized = false;\n\n/**\n * Sincroniza la información del negocio guardada en IndexedDB con el backend\n * @returns {Promise<Object>} - Resultado de la sincronización\n */\nexport async function syncBusinessInfoWithBackend() {\n  try {\n    // Obtener la información del negocio desde IndexedDB\n    const businessInfo = await getBusinessInfo();\n    \n    if (!businessInfo || Object.keys(businessInfo).length === 0) {\n      console.log('No hay información del negocio para sincronizar');\n      return {\n        success: false,\n        message: 'No hay información del negocio para sincronizar'\n      };\n    }\n    \n    console.log('Sincronizando información del negocio con el backend:', businessInfo);\n    \n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Obtener el ID del restaurante del usuario actual\n    const userResponse = await apiService.get('/auth/me');\n    if (!userResponse || !userResponse.success || !userResponse.user || !userResponse.user.restaurante_id) {\n      console.warn('No se pudo obtener el restaurante del usuario actual');\n      return {\n        success: false,\n        message: 'No se pudo obtener el restaurante del usuario actual'\n      };\n    }\n    \n    const restauranteId = userResponse.user.restaurante_id;\n    \n    // Preparar los datos para actualizar el restaurante\n    const restauranteData = {\n      nombre: businessInfo.name,\n      descripcion: businessInfo.description,\n      direccion: businessInfo.address,\n      telefono: businessInfo.contact,\n      logo: businessInfo.logo,\n      // Guardar la información de pago como un campo JSON\n      informacion_pago: JSON.stringify(businessInfo.paymentInfo || {})\n    };\n    \n    // Actualizar el restaurante en el backend\n    const response = await apiService.put(`/restaurantes/${restauranteId}`, restauranteData);\n    \n    if (response && response.success) {\n      console.log('Información del negocio sincronizada con éxito');\n      lastSyncTimestamp = Date.now();\n      \n      // Notificar a todos los componentes que la información ha sido sincronizada\n      eventBus.emit('business-info-updated', businessInfo);\n      \n      return {\n        success: true,\n        message: 'Información del negocio sincronizada con éxito',\n        timestamp: lastSyncTimestamp\n      };\n    } else {\n      console.warn('Error al sincronizar información del negocio:', response);\n      return {\n        success: false,\n        message: response.message || 'Error al sincronizar información del negocio'\n      };\n    }\n  } catch (error) {\n    console.error('Error al sincronizar información del negocio:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al sincronizar información del negocio'\n    };\n  }\n}\n\n/**\n * Obtiene la información del negocio desde el backend y la guarda en IndexedDB\n * @param {boolean} forceUpdate - Forzar la actualización aunque esté en caché\n * @returns {Promise<Object>} - Información del negocio\n */\nexport async function fetchBusinessInfoFromBackend(forceUpdate = false) {\n  try {\n    // Si tenemos información en caché y no ha pasado el tiempo de caché, usarla\n    const now = Date.now();\n    if (businessInfoCache && !forceUpdate && (now - lastFetchTimestamp) < CACHE_DURATION) {\n      console.log('Usando información de negocio en caché');\n      return businessInfoCache;\n    }\n    \n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Obtener el ID del restaurante del usuario actual\n    const userResponse = await apiService.get('/auth/me');\n    if (!userResponse || !userResponse.success || !userResponse.user || !userResponse.user.restaurante_id) {\n      console.warn('No se pudo obtener el restaurante del usuario actual');\n      throw new Error('No se pudo obtener el restaurante del usuario actual');\n    }\n    \n    const restauranteId = userResponse.user.restaurante_id;\n    \n    // Obtener el restaurante del backend\n    const response = await apiService.get(`/restaurantes/${restauranteId}`);\n    \n    if (response && response.success && response.restaurante) {\n      const restaurante = response.restaurante;\n      \n      // Convertir la información a formato de negocio\n      let paymentInfo = {};\n      try {\n        if (restaurante.informacion_pago) {\n          paymentInfo = JSON.parse(restaurante.informacion_pago);\n        }\n      } catch (e) {\n        console.warn('Error al parsear información de pago:', e);\n      }\n      \n      const businessInfo = {\n        name: restaurante.nombre,\n        description: restaurante.descripcion,\n        address: restaurante.direccion,\n        contact: restaurante.telefono,\n        logo: restaurante.logo,\n        paymentInfo\n      };\n      \n      // Guardar en IndexedDB\n      await saveBusinessInfo(businessInfo);\n      \n      // Actualizar caché y timestamp\n      businessInfoCache = businessInfo;\n      lastFetchTimestamp = now;\n      \n      // Notificar a todos los componentes que la información ha sido actualizada\n      eventBus.emit('business-info-updated', businessInfo);\n      \n      console.log('Información del negocio obtenida con éxito:', businessInfo);\n      return businessInfo;\n    } else {\n      console.warn('Error al obtener información del negocio:', response);\n      throw new Error(response?.message || 'Error al obtener información del negocio');\n    }\n  } catch (error) {\n    console.error('Error al obtener información del negocio desde el backend:', error);\n    \n    // Si hay un error, intentar obtener la información desde IndexedDB\n    try {\n      const businessInfo = await getBusinessInfo();\n      if (businessInfo) {\n        return businessInfo;\n      }\n    } catch (localError) {\n      console.error('Error al obtener información local:', localError);\n    }\n    \n    throw error;\n  }\n}\n\n/**\n * Actualiza la información del negocio en IndexedDB y la sincroniza con el backend\n * @param {Object} businessInfo - Nueva información del negocio\n * @returns {Promise<Object>} - Resultado de la actualización\n */\nexport async function updateBusinessInfo(businessInfo) {\n  try {\n    // Guardar en IndexedDB\n    await saveBusinessInfo(businessInfo);\n    \n    // Actualizar caché y timestamp\n    businessInfoCache = businessInfo;\n    lastFetchTimestamp = Date.now();\n    \n    // Notificar a todos los componentes que la información ha sido actualizada\n    eventBus.emit('business-info-updated', businessInfo);\n    \n    // Sincronizar con el backend\n    const syncResult = await syncBusinessInfoWithBackend();\n    \n    return {\n      success: true,\n      message: 'Información del negocio actualizada con éxito',\n      syncResult\n    };\n  } catch (error) {\n    console.error('Error al actualizar información del negocio:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al actualizar información del negocio'\n    };\n  }\n}\n\n/**\n * Verifica si hay cambios en la información del negocio\n * @returns {Promise<boolean>} - True si hay cambios, false si no\n */\nexport async function checkForBusinessInfoChanges() {\n  try {\n    // Obtener información actual desde IndexedDB\n    const localInfo = await getBusinessInfo();\n    \n    // Obtener información desde el backend\n    const backendInfo = await fetchBusinessInfoFromBackend(true);\n    \n    // Comparar ambas informaciones\n    const localString = JSON.stringify(localInfo);\n    const backendString = JSON.stringify(backendInfo);\n    \n    const hasChanges = localString !== backendString;\n    \n    if (hasChanges) {\n      console.log('Se detectaron cambios en la información del negocio');\n      \n      // Actualizar la información local con la del backend\n      await saveBusinessInfo(backendInfo);\n      \n      // Notificar a todos los componentes\n      eventBus.emit('business-info-updated', backendInfo);\n    }\n    \n    return hasChanges;\n  } catch (error) {\n    console.error('Error al verificar cambios en información del negocio:', error);\n    return false;\n  }\n}\n\n/**\n * Inicia la verificación periódica de cambios en la información del negocio\n * @param {boolean} disableSync - Si es true, la sincronización se desactiva (útil para vistas compartidas)\n */\nexport function startBusinessInfoSyncInterval(disableSync = false) {\n  // Si se solicita deshabilitar la sincronización (por ejemplo, en vistas compartidas), salir\n  if (disableSync) {\n    console.log('Sincronización de información del negocio desactivada (modo vista compartida)');\n    return;\n  }\n\n  if (syncIntervalId) {\n    clearInterval(syncIntervalId);\n  }\n  \n  // Inicializar con una primera sincronización\n  if (!isInitialized) {\n    fetchBusinessInfoFromBackend()\n      .catch(error => console.error('Error en sincronización inicial:', error));\n    isInitialized = true;\n  }\n  \n  syncIntervalId = setInterval(() => {\n    checkForBusinessInfoChanges()\n      .catch(error => console.error('Error en verificación periódica:', error));\n  }, SYNC_INTERVAL);\n  \n  console.log('Verificación periódica de información del negocio iniciada');\n}\n\n/**\n * Detiene la verificación periódica\n */\nexport function stopBusinessInfoSyncInterval() {\n  if (syncIntervalId) {\n    clearInterval(syncIntervalId);\n    syncIntervalId = null;\n    console.log('Verificación periódica de información del negocio detenida');\n  }\n}\n\n/**\n * Ejecuta la migración para añadir la columna informacion_pago a la tabla restaurantes\n * @returns {Promise<Object>} - Resultado de la migración\n */\nexport async function runAddInformacionPagoMigration() {\n  try {\n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    const response = await apiService.get('/restaurantes/migrate/add-informacion-pago');\n    \n    if (response && response.success) {\n      console.log('Migración ejecutada con éxito:', response.message);\n      return {\n        success: true,\n        message: response.message || 'Migración ejecutada con éxito'\n      };\n    } else {\n      console.warn('Error al ejecutar migración:', response);\n      return {\n        success: false,\n        message: response.message || 'Error al ejecutar migración'\n      };\n    }\n  } catch (error) {\n    console.error('Error al ejecutar migración:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al ejecutar migración'\n    };\n  }\n}\n\n/**\n * Limpia la caché y fuerza una nueva carga desde el backend\n */\nexport function invalidateBusinessInfoCache() {\n  businessInfoCache = null;\n  lastFetchTimestamp = 0;\n}\n\nexport default {\n  syncBusinessInfoWithBackend,\n  fetchBusinessInfoFromBackend,\n  updateBusinessInfo,\n  checkForBusinessInfoChanges,\n  startBusinessInfoSyncInterval,\n  stopBusinessInfoSyncInterval,\n  runAddInformacionPagoMigration,\n  invalidateBusinessInfoCache\n};\n","import { render } from \"./SyncBusinessInfo.vue?vue&type=template&id=36ce8d12&scoped=true\"\nimport script from \"./SyncBusinessInfo.vue?vue&type=script&lang=js\"\nexport * from \"./SyncBusinessInfo.vue?vue&type=script&lang=js\"\n\nimport \"./SyncBusinessInfo.vue?vue&type=style&index=0&id=36ce8d12&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-36ce8d12\"]])\n\nexport default __exports__"],"names":["class","key","role","_createElementBlock","_hoisted_1","_createElementVNode","$setup","message","_normalizeClass","success","_createCommentVNode","_hoisted_2","_hoisted_3","isAutoSyncEnabled","_hoisted_4","_toDisplayString","lastSyncFormatted","_hoisted_5","_hoisted_6","_hoisted_7","type","_cache","$event","onChange","args","toggleAutoSync","_hoisted_8","syncInterval","updateSyncInterval","disabled","value","_hoisted_9","_hoisted_10","onClick","runMigration","loading","_hoisted_12","_createTextVNode","_hoisted_11","syncBusinessInfo","_hoisted_14","_hoisted_13","fetchFromBackend","_hoisted_16","_hoisted_15","syncAndRefresh","_hoisted_18","_hoisted_17","businessInfo","_hoisted_19","_hoisted_20","_hoisted_21","name","_hoisted_22","lastUpdateFormatted","_hoisted_23","_hoisted_24","description","_hoisted_25","address","_hoisted_26","contact","logo","_hoisted_27","src","alt","_hoisted_28","paymentInfo","_hoisted_29","_hoisted_30","qrTitle","_hoisted_31","nequiNumber","_hoisted_32","bankInfo","_hoisted_33","_hoisted_34","_hoisted_35","_Fragment","_renderList","syncLogs","log","index","_hoisted_36","formatTimestamp","timestamp","_hoisted_37","length","_hoisted_38","SYNC_INTERVAL","CACHE_DURATION","syncIntervalId","lastSyncTimestamp","lastFetchTimestamp","businessInfoCache","isInitialized","async","syncBusinessInfoWithBackend","getBusinessInfo","Object","keys","console","token","localStorage","getItem","apiService","setToken","userResponse","get","user","restaurante_id","warn","restauranteId","restauranteData","nombre","descripcion","direccion","telefono","informacion_pago","JSON","stringify","response","put","Date","now","eventBus","emit","error","fetchBusinessInfoFromBackend","forceUpdate","Error","restaurante","parse","e","saveBusinessInfo","localError","checkForBusinessInfoChanges","localInfo","backendInfo","localString","backendString","hasChanges","startBusinessInfoSyncInterval","disableSync","clearInterval","catch","setInterval","stopBusinessInfoSyncInterval","runAddInformacionPagoMigration","invalidateBusinessInfoCache","setup","ref","lastSync","lastUpdate","computed","date","toLocaleDateString","toLocaleTimeString","addSyncLog","logMessage","isSuccess","unshift","slice","handleBusinessInfoUpdate","updatedInfo","onMounted","on","loadBusinessInfo","onUnmounted","off","result","parseInt","__exports__","render"],"sourceRoot":""}