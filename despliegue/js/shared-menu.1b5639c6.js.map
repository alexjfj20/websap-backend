{"version":3,"file":"js/shared-menu.1b5639c6.js","mappings":"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","sources":["webpack://websap/./src/services/businessInfoService.js","webpack://websap/./src/views/SharedMenuView.vue","webpack://websap/./src/services/menuService.js","webpack://websap/./src/components/reservas/ReservaForm.vue","webpack://websap/./src/components/reservas/ReservaForm.vue?888d","webpack://websap/./src/views/SharedMenuView.vue?e8e7","webpack://websap/./node_modules/core-js/modules/es.iterator.reduce.js"],"sourcesContent":["// src/services/businessInfoService.js\n\nimport apiService from './apiService';\nimport { getBusinessInfo, saveBusinessInfo } from './storageService';\nimport eventBus from '../utils/eventBus';\n\n// Constantes para la sincronización\nconst SYNC_INTERVAL = 30000; // 30 segundos\nconst CACHE_DURATION = 300000; // 5 minutos\nlet syncIntervalId = null;\nlet lastSyncTimestamp = 0;\nlet lastFetchTimestamp = 0;\nlet businessInfoCache = null;\nlet isInitialized = false;\n\n/**\n * Sincroniza la información del negocio guardada en IndexedDB con el backend\n * @returns {Promise<Object>} - Resultado de la sincronización\n */\nexport async function syncBusinessInfoWithBackend() {\n  try {\n    // Obtener la información del negocio desde IndexedDB\n    const businessInfo = await getBusinessInfo();\n    \n    if (!businessInfo || Object.keys(businessInfo).length === 0) {\n      console.log('No hay información del negocio para sincronizar');\n      return {\n        success: false,\n        message: 'No hay información del negocio para sincronizar'\n      };\n    }\n    \n    console.log('Sincronizando información del negocio con el backend:', businessInfo);\n    \n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Obtener el ID del restaurante del usuario actual\n    const userResponse = await apiService.get('/auth/me');\n    if (!userResponse || !userResponse.success || !userResponse.user || !userResponse.user.restaurante_id) {\n      console.warn('No se pudo obtener el restaurante del usuario actual');\n      return {\n        success: false,\n        message: 'No se pudo obtener el restaurante del usuario actual'\n      };\n    }\n    \n    const restauranteId = userResponse.user.restaurante_id;\n    \n    // Preparar los datos para actualizar el restaurante\n    const restauranteData = {\n      nombre: businessInfo.name,\n      descripcion: businessInfo.description,\n      direccion: businessInfo.address,\n      telefono: businessInfo.contact,\n      logo: businessInfo.logo,\n      // Guardar la información de pago como un campo JSON\n      informacion_pago: JSON.stringify(businessInfo.paymentInfo || {})\n    };\n    \n    // Actualizar el restaurante en el backend\n    const response = await apiService.put(`/restaurantes/${restauranteId}`, restauranteData);\n    \n    if (response && response.success) {\n      console.log('Información del negocio sincronizada con éxito');\n      lastSyncTimestamp = Date.now();\n      \n      // Notificar a todos los componentes que la información ha sido sincronizada\n      eventBus.emit('business-info-updated', businessInfo);\n      \n      return {\n        success: true,\n        message: 'Información del negocio sincronizada con éxito',\n        timestamp: lastSyncTimestamp\n      };\n    } else {\n      console.warn('Error al sincronizar información del negocio:', response);\n      return {\n        success: false,\n        message: response.message || 'Error al sincronizar información del negocio'\n      };\n    }\n  } catch (error) {\n    console.error('Error al sincronizar información del negocio:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al sincronizar información del negocio'\n    };\n  }\n}\n\n/**\n * Obtiene la información del negocio desde el backend y la guarda en IndexedDB\n * @param {boolean} forceUpdate - Forzar la actualización aunque esté en caché\n * @returns {Promise<Object>} - Información del negocio\n */\nexport async function fetchBusinessInfoFromBackend(forceUpdate = false) {\n  try {\n    // Si tenemos información en caché y no ha pasado el tiempo de caché, usarla\n    const now = Date.now();\n    if (businessInfoCache && !forceUpdate && (now - lastFetchTimestamp) < CACHE_DURATION) {\n      console.log('Usando información de negocio en caché');\n      return businessInfoCache;\n    }\n    \n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Obtener el ID del restaurante del usuario actual\n    const userResponse = await apiService.get('/auth/me');\n    if (!userResponse || !userResponse.success || !userResponse.user || !userResponse.user.restaurante_id) {\n      console.warn('No se pudo obtener el restaurante del usuario actual');\n      throw new Error('No se pudo obtener el restaurante del usuario actual');\n    }\n    \n    const restauranteId = userResponse.user.restaurante_id;\n    \n    // Obtener el restaurante del backend\n    const response = await apiService.get(`/restaurantes/${restauranteId}`);\n    \n    if (response && response.success && response.restaurante) {\n      const restaurante = response.restaurante;\n      \n      // Convertir la información a formato de negocio\n      let paymentInfo = {};\n      try {\n        if (restaurante.informacion_pago) {\n          paymentInfo = JSON.parse(restaurante.informacion_pago);\n        }\n      } catch (e) {\n        console.warn('Error al parsear información de pago:', e);\n      }\n      \n      const businessInfo = {\n        name: restaurante.nombre,\n        description: restaurante.descripcion,\n        address: restaurante.direccion,\n        contact: restaurante.telefono,\n        logo: restaurante.logo,\n        paymentInfo\n      };\n      \n      // Guardar en IndexedDB\n      await saveBusinessInfo(businessInfo);\n      \n      // Actualizar caché y timestamp\n      businessInfoCache = businessInfo;\n      lastFetchTimestamp = now;\n      \n      // Notificar a todos los componentes que la información ha sido actualizada\n      eventBus.emit('business-info-updated', businessInfo);\n      \n      console.log('Información del negocio obtenida con éxito:', businessInfo);\n      return businessInfo;\n    } else {\n      console.warn('Error al obtener información del negocio:', response);\n      throw new Error(response?.message || 'Error al obtener información del negocio');\n    }\n  } catch (error) {\n    console.error('Error al obtener información del negocio desde el backend:', error);\n    \n    // Si hay un error, intentar obtener la información desde IndexedDB\n    try {\n      const businessInfo = await getBusinessInfo();\n      if (businessInfo) {\n        return businessInfo;\n      }\n    } catch (localError) {\n      console.error('Error al obtener información local:', localError);\n    }\n    \n    throw error;\n  }\n}\n\n/**\n * Actualiza la información del negocio en IndexedDB y la sincroniza con el backend\n * @param {Object} businessInfo - Nueva información del negocio\n * @returns {Promise<Object>} - Resultado de la actualización\n */\nexport async function updateBusinessInfo(businessInfo) {\n  try {\n    // Guardar en IndexedDB\n    await saveBusinessInfo(businessInfo);\n    \n    // Actualizar caché y timestamp\n    businessInfoCache = businessInfo;\n    lastFetchTimestamp = Date.now();\n    \n    // Notificar a todos los componentes que la información ha sido actualizada\n    eventBus.emit('business-info-updated', businessInfo);\n    \n    // Sincronizar con el backend\n    const syncResult = await syncBusinessInfoWithBackend();\n    \n    return {\n      success: true,\n      message: 'Información del negocio actualizada con éxito',\n      syncResult\n    };\n  } catch (error) {\n    console.error('Error al actualizar información del negocio:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al actualizar información del negocio'\n    };\n  }\n}\n\n/**\n * Verifica si hay cambios en la información del negocio\n * @returns {Promise<boolean>} - True si hay cambios, false si no\n */\nexport async function checkForBusinessInfoChanges() {\n  try {\n    // Obtener información actual desde IndexedDB\n    const localInfo = await getBusinessInfo();\n    \n    // Obtener información desde el backend\n    const backendInfo = await fetchBusinessInfoFromBackend(true);\n    \n    // Comparar ambas informaciones\n    const localString = JSON.stringify(localInfo);\n    const backendString = JSON.stringify(backendInfo);\n    \n    const hasChanges = localString !== backendString;\n    \n    if (hasChanges) {\n      console.log('Se detectaron cambios en la información del negocio');\n      \n      // Actualizar la información local con la del backend\n      await saveBusinessInfo(backendInfo);\n      \n      // Notificar a todos los componentes\n      eventBus.emit('business-info-updated', backendInfo);\n    }\n    \n    return hasChanges;\n  } catch (error) {\n    console.error('Error al verificar cambios en información del negocio:', error);\n    return false;\n  }\n}\n\n/**\n * Inicia la verificación periódica de cambios en la información del negocio\n * @param {boolean} disableSync - Si es true, la sincronización se desactiva (útil para vistas compartidas)\n */\nexport function startBusinessInfoSyncInterval(disableSync = false) {\n  // Si se solicita deshabilitar la sincronización (por ejemplo, en vistas compartidas), salir\n  if (disableSync) {\n    console.log('Sincronización de información del negocio desactivada (modo vista compartida)');\n    return;\n  }\n\n  if (syncIntervalId) {\n    clearInterval(syncIntervalId);\n  }\n  \n  // Inicializar con una primera sincronización\n  if (!isInitialized) {\n    fetchBusinessInfoFromBackend()\n      .catch(error => console.error('Error en sincronización inicial:', error));\n    isInitialized = true;\n  }\n  \n  syncIntervalId = setInterval(() => {\n    checkForBusinessInfoChanges()\n      .catch(error => console.error('Error en verificación periódica:', error));\n  }, SYNC_INTERVAL);\n  \n  console.log('Verificación periódica de información del negocio iniciada');\n}\n\n/**\n * Detiene la verificación periódica\n */\nexport function stopBusinessInfoSyncInterval() {\n  if (syncIntervalId) {\n    clearInterval(syncIntervalId);\n    syncIntervalId = null;\n    console.log('Verificación periódica de información del negocio detenida');\n  }\n}\n\n/**\n * Ejecuta la migración para añadir la columna informacion_pago a la tabla restaurantes\n * @returns {Promise<Object>} - Resultado de la migración\n */\nexport async function runAddInformacionPagoMigration() {\n  try {\n    // Asegurarse de que el token esté configurado en apiService\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    const response = await apiService.get('/restaurantes/migrate/add-informacion-pago');\n    \n    if (response && response.success) {\n      console.log('Migración ejecutada con éxito:', response.message);\n      return {\n        success: true,\n        message: response.message || 'Migración ejecutada con éxito'\n      };\n    } else {\n      console.warn('Error al ejecutar migración:', response);\n      return {\n        success: false,\n        message: response.message || 'Error al ejecutar migración'\n      };\n    }\n  } catch (error) {\n    console.error('Error al ejecutar migración:', error);\n    return {\n      success: false,\n      message: error.message || 'Error al ejecutar migración'\n    };\n  }\n}\n\n/**\n * Limpia la caché y fuerza una nueva carga desde el backend\n */\nexport function invalidateBusinessInfoCache() {\n  businessInfoCache = null;\n  lastFetchTimestamp = 0;\n}\n\nexport default {\n  syncBusinessInfoWithBackend,\n  fetchBusinessInfoFromBackend,\n  updateBusinessInfo,\n  checkForBusinessInfoChanges,\n  startBusinessInfoSyncInterval,\n  stopBusinessInfoSyncInterval,\n  runAddInformacionPagoMigration,\n  invalidateBusinessInfoCache\n};\n","<template>\r\n  <div class=\"shared-menu-container\" :id=\"menuId\">\r\n    <div v-if=\"isLoading\" class=\"loading\">\r\n      <div class=\"spinner\"></div>\r\n      <p>Cargando menú...</p>\r\n    </div>\r\n    \r\n    <div v-else-if=\"error\" class=\"error\">\r\n      <p>{{ error }}</p>\r\n    </div>\r\n    \r\n    <div v-else class=\"menu-content\">\r\n      <!-- Información del negocio -->\r\n      <div v-if=\"menuData?.businessInfo\" class=\"business-info\">\r\n        <img v-if=\"menuData.businessInfo.logo && isValidImage(menuData.businessInfo.logo)\" :src=\"fixImageFormat(menuData.businessInfo.logo)\" alt=\"Logo\" class=\"business-logo\">\r\n        <h1>{{ menuData.businessInfo.name }}</h1>\r\n        <p class=\"description\">{{ menuData.businessInfo.description }}</p>\r\n        <div class=\"contact-info\" v-if=\"menuData.businessInfo.contact || menuData.businessInfo.address\">\r\n          <p v-if=\"menuData.businessInfo.contact\"><strong>Contacto:</strong> {{ menuData.businessInfo.contact }}</p>\r\n          <p v-if=\"menuData.businessInfo.address\"><strong>Dirección:</strong> {{ menuData.businessInfo.address }}</p>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Lista de productos -->\r\n      <div>\r\n        <!-- Platos regulares -->\r\n        <div class=\"menu-list\">\r\n          <h2>Nuestro Menú</h2>\r\n          <div class=\"menu-items\">\r\n            <div v-for=\"(item, index) in regularItems\" :key=\"index\" class=\"menu-item\">\r\n              <div class=\"item-image-container\">\r\n                <img v-if=\"item.image && isValidImage(item.image)\" :src=\"fixImageFormat(item.image)\" alt=\"Imagen del producto\" class=\"item-image\">\r\n                <img v-else src=\"https://via.placeholder.com/150?text=Sin+Imagen\" alt=\"Sin imagen disponible\" class=\"item-image\">\r\n              </div>\r\n              <div class=\"item-details\">\r\n                <h3>{{ item.name }}</h3>\r\n                <p class=\"item-description\">{{ item.description }}</p>\r\n                <p class=\"item-price\">${{ formatPrice(item.price) }}</p>\r\n                <p class=\"includes-drink\" v-if=\"item.includesDrink\">Incluye refresco</p>\r\n                <button \r\n                  @click=\"addToCart(item)\" \r\n                  class=\"add-to-cart-btn\"\r\n                  :disabled=\"!item.realAvailability || item.realAvailability <= 0\"\r\n                  :class=\"{ 'disabled-btn': !item.realAvailability || item.realAvailability <= 0 }\"\r\n                >\r\n                  <span v-if=\"!item.realAvailability || item.realAvailability <= 0\" class=\"btn-icon\">❌</span>\r\n                  <span v-else class=\"btn-icon\">🛒</span>\r\n                  {{ !item.realAvailability || item.realAvailability <= 0 ? 'No disponible' : 'Añadir al pedido' }}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Platos especiales (solo se muestra si hay platos especiales) -->\r\n        <div v-if=\"specialItems.length > 0\" class=\"menu-list special-menu-list\">\r\n          <h2>Platos Especiales</h2>\r\n          <div class=\"menu-items\">\r\n            <div v-for=\"(item, index) in specialItems\" :key=\"index\" class=\"menu-item special-item\">\r\n              <div class=\"item-image-container\">\r\n                <img v-if=\"item.image && isValidImage(item.image)\" :src=\"fixImageFormat(item.image)\" alt=\"Imagen del producto\" class=\"item-image\">\r\n                <img v-else src=\"https://via.placeholder.com/150?text=Sin+Imagen\" alt=\"Sin imagen disponible\" class=\"item-image\">\r\n              </div>\r\n              <div class=\"item-details\">\r\n                <h3>{{ item.name }}</h3>\r\n                <p class=\"item-description\">{{ item.description }}</p>\r\n                <p class=\"item-price\">${{ formatPrice(item.price) }}</p>\r\n                <p class=\"includes-drink\" v-if=\"item.includesDrink\">Incluye refresco</p>\r\n                <button \r\n                  @click=\"addToCart(item)\" \r\n                  class=\"add-to-cart-btn special-button\"\r\n                  :disabled=\"!item.realAvailability || item.realAvailability <= 0\"\r\n                  :class=\"{ 'disabled-btn': !item.realAvailability || item.realAvailability <= 0 }\"\r\n                >\r\n                  <span v-if=\"!item.realAvailability || item.realAvailability <= 0\" class=\"btn-icon\">❌</span>\r\n                  <span v-else class=\"btn-icon\">🛒</span>\r\n                  {{ !item.realAvailability || item.realAvailability <= 0 ? 'No disponible' : 'Añadir al pedido' }}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Sección de \"Tu Pedido\" - Siempre visible aunque vacía -->\r\n        <div class=\"order-section\" ref=\"orderSection\">\r\n          <h2>Tu Pedido</h2>\r\n          \r\n          <div v-if=\"cartItems.length === 0\" class=\"empty-cart\">\r\n            <p>Tu pedido está vacío</p>\r\n            <p class=\"empty-cart-message\">Añade productos del menú para comenzar tu pedido</p>\r\n          </div>\r\n          \r\n          <div v-else class=\"cart-items\">\r\n            <div v-for=\"(item, index) in cartItems\" :key=\"index\" class=\"cart-item\">\r\n              <div class=\"cart-item-details\">\r\n                <h3>{{ item.name }}</h3>\r\n                <p>${{ formatPrice(item.price) }} x {{ item.quantity }}</p>\r\n              </div>\r\n              <div class=\"cart-item-actions\">\r\n                <button @click=\"decreaseQuantity(index)\" class=\"quantity-btn\">-</button>\r\n                <span class=\"quantity-display\">{{ item.quantity }}</span>\r\n                <button @click=\"increaseQuantity(index)\" class=\"quantity-btn\">+</button>\r\n                <button @click=\"removeFromCart(index)\" class=\"remove-btn\">\r\n                  <span class=\"btn-icon\">🗑️</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"cart-total\">\r\n              <h3>Total: ${{ formatPrice(cartTotal) }}</h3>\r\n              \r\n              <!-- Formulario de datos del cliente -->\r\n              <div class=\"customer-form\">\r\n                <h4>Datos del Cliente</h4>\r\n                <div class=\"form-row\">\r\n                  <input type=\"text\" v-model=\"customerInfo.name\" placeholder=\"Nombres completos\" class=\"form-input\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                  <input type=\"tel\" v-model=\"customerInfo.phone\" placeholder=\"Teléfono\" class=\"form-input\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                  <input type=\"email\" v-model=\"customerInfo.email\" placeholder=\"Correo electrónico\" class=\"form-input\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                  <input type=\"text\" v-model=\"customerInfo.address\" placeholder=\"Dirección de entrega\" class=\"form-input\">\r\n                </div>\r\n                \r\n                <!-- Lista horizontal de métodos de pago -->\r\n                <div class=\"payment-methods-selection\">\r\n                  <h4>Forma de Pago</h4>\r\n                  <div class=\"payment-options\">\r\n                    <label class=\"payment-option\">\r\n                      <input type=\"radio\" v-model=\"selectedPaymentMethod\" value=\"qr\" name=\"paymentMethod\">\r\n                      <span class=\"payment-option-text\">QR</span>\r\n                    </label>\r\n                    <label class=\"payment-option\">\r\n                      <input type=\"radio\" v-model=\"selectedPaymentMethod\" value=\"nequi\" name=\"paymentMethod\">\r\n                      <span class=\"payment-option-text\">Nequi</span>\r\n                    </label>\r\n                    <label class=\"payment-option\">\r\n                      <input type=\"radio\" v-model=\"selectedPaymentMethod\" value=\"cash\" name=\"paymentMethod\">\r\n                      <span class=\"payment-option-text\">Contra entrega</span>\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n                \r\n                <!-- Campo de mensaje adicional -->\r\n                <div class=\"form-row\">\r\n                  <textarea v-model=\"additionalMessage\" placeholder=\"Mensaje o instrucciones adicionales\" class=\"form-textarea\"></textarea>\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"order-actions\">\r\n                <button @click=\"completeOrder\" class=\"complete-order-btn\">\r\n                  <span class=\"btn-icon\">📱</span> Enviar por WhatsApp\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Botón flotante para ver pedido (visible cuando hay items y se hace scroll) -->\r\n        <div v-if=\"cartItems.length > 0\" class=\"floating-cart-button\" @click=\"scrollToOrder\">\r\n          <span class=\"cart-items-count\">{{ totalItems }}</span>\r\n          <span>Ver Pedido</span>\r\n        </div>\r\n        \r\n        <!-- Nueva sección: Forma de Pago -->\r\n        <div v-if=\"hasPaymentInfo\" class=\"payment-section\">\r\n          <h2>Forma de Pago</h2>\r\n          <div class=\"payment-methods\">\r\n            <div v-if=\"menuData?.businessInfo?.paymentInfo?.qrImage\" class=\"payment-method\">\r\n              <h3>{{ menuData?.businessInfo?.paymentInfo?.qrTitle || 'Código QR de Pago' }}</h3>\r\n              <img \r\n                v-if=\"menuData?.businessInfo?.paymentInfo?.qrImage && isValidImage(menuData?.businessInfo?.paymentInfo?.qrImage)\" \r\n                :src=\"fixImageFormat(menuData?.businessInfo?.paymentInfo?.qrImage)\" \r\n                alt=\"QR de Pago\" \r\n                class=\"payment-image\"\r\n              >\r\n            </div>\r\n            \r\n            <div v-if=\"menuData?.businessInfo?.paymentInfo?.nequiNumber || menuData?.businessInfo?.paymentInfo?.nequiImage\" class=\"payment-method\">\r\n              <h3>Pago con Nequi</h3>\r\n              <img \r\n                v-if=\"menuData?.businessInfo?.paymentInfo?.nequiImage && isValidImage(menuData?.businessInfo?.paymentInfo?.nequiImage)\" \r\n                :src=\"fixImageFormat(menuData?.businessInfo?.paymentInfo?.nequiImage)\" \r\n                alt=\"Nequi\" \r\n                class=\"payment-image\"\r\n              >\r\n              <p v-if=\"menuData?.businessInfo?.paymentInfo?.nequiNumber\" class=\"payment-detail\">\r\n                <strong>Número:</strong> {{ menuData?.businessInfo?.paymentInfo?.nequiNumber }}\r\n              </p>\r\n            </div>\r\n            \r\n            <div v-if=\"menuData?.businessInfo?.paymentInfo?.bankInfo\" class=\"payment-method\">\r\n              <h3>Pago Bancario</h3>\r\n              <p class=\"payment-detail\">\r\n                <strong>Información Bancaria:</strong> {{ menuData?.businessInfo?.paymentInfo?.bankInfo }}\r\n              </p>\r\n            </div>\r\n            \r\n            <div v-if=\"menuData?.businessInfo?.paymentInfo?.otherPaymentMethods\" class=\"payment-method\">\r\n              <h3>Otras Formas de Pago</h3>\r\n              <p class=\"payment-detail\">\r\n                <strong>Métodos Adicionales:</strong> {{ menuData?.businessInfo?.paymentInfo?.otherPaymentMethods }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Añadir el componente ReservaForm en una sección visible -->\r\n        <div class=\"reserva-section container mt-5\">\r\n          <h3 class=\"text-center mb-4\">¿Quieres hacer una reserva?</h3>\r\n          <ReservaForm />\r\n        </div>\r\n        \r\n        <!-- Sistema de notificaciones toast -->\r\n        <div v-if=\"toast.visible\" \r\n             class=\"toast-notification\" \r\n             :class=\"toast.type\">\r\n          {{ toast.message }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted, reactive, onUnmounted } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport { getSharedMenu } from '../services/menuService';\r\nimport { saveReservation } from '../services/reservaService'; // Importamos el servicio de reservas\r\nimport { getMenuItems, updateItemAvailability } from '../services/storageService'; // Importar funciones necesarias\r\nimport ReservaForm from '../components/reservas/ReservaForm.vue';\r\nimport eventBus from '../utils/eventBus';\r\nimport { \r\n  fetchBusinessInfoFromBackend, \r\n  startBusinessInfoSyncInterval, \r\n  stopBusinessInfoSyncInterval \r\n} from '../services/businessInfoService';\r\n\r\nexport default {\r\n  name: 'SharedMenuView',\r\n  components: {\r\n    ReservaForm,\r\n  },\r\n  props: {\r\n    // Añade id como prop si lo necesitas\r\n    id: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  setup(props) {\r\n    const route = useRoute();\r\n    const menuId = computed(() => props.id || route.params.id);\r\n    const menuData = ref({\r\n      items: [],\r\n      businessInfo: {\r\n        name: 'Restaurante WebSAP',\r\n        description: 'Deliciosa comida para todos los gustos',\r\n        contact: 'info@websap.com',\r\n        address: 'Calle Principal #123',\r\n        logo: null,\r\n        paymentInfo: {\r\n          qrImage: null,\r\n          qrTitle: 'Escanea para pagar',\r\n          nequiNumber: null,\r\n          nequiImage: null,\r\n          bankInfo: 'Banco XYZ - Cuenta 123456789',\r\n          otherPaymentMethods: 'Aceptamos efectivo y tarjetas'\r\n        }\r\n      }\r\n    });\r\n    const isLoading = ref(true);\r\n    const error = ref(null);\r\n    const cartItems = ref([]);\r\n    const orderRef = ref(null);\r\n    const isProcessingOrder = ref(false);\r\n    const lastBusinessInfoUpdate = ref(null);\r\n    \r\n    console.log(\"SharedMenuView montado, ID del menú:\", route.params.id);\r\n\r\n    // Sistema de notificaciones toast\r\n    const toast = ref({\r\n      visible: false,\r\n      message: '',\r\n      type: 'success', // 'success', 'warning', 'error'\r\n      timeoutId: null\r\n    });\r\n\r\n    // Cargar menú cuando el componente se monte\r\n    onMounted(() => {\r\n      loadMenu();\r\n      \r\n      // Suscribirse al evento de actualización de información del negocio\r\n      eventBus.on('business-info-updated', handleBusinessInfoUpdate);\r\n      \r\n      // Iniciar la sincronización periódica con parámetro true para desactivarla en vista compartida\r\n      startBusinessInfoSyncInterval(true);\r\n    });\r\n    \r\n    // Al desmontar el componente, cancelar suscripciones y detener intervalos\r\n    onUnmounted(() => {\r\n      eventBus.off('business-info-updated', handleBusinessInfoUpdate);\r\n      stopBusinessInfoSyncInterval();\r\n      \r\n      // Limpiar timeout del toast si existe\r\n      if (toast.value.timeoutId) {\r\n        clearTimeout(toast.value.timeoutId);\r\n      }\r\n    });\r\n    \r\n    // Manejar la actualización de información del negocio\r\n    const handleBusinessInfoUpdate = (updatedInfo) => {\r\n      console.log('Nueva información del negocio recibida en SharedMenuView:', updatedInfo);\r\n      \r\n      if (!updatedInfo) return;\r\n      \r\n      // Actualizar la información del negocio en menuData\r\n      menuData.value.businessInfo = {\r\n        ...updatedInfo\r\n      };\r\n      \r\n      lastBusinessInfoUpdate.value = Date.now();\r\n      \r\n      // Mostrar notificación sutil\r\n      showToast('Información del negocio actualizada', 'info');\r\n    };\r\n\r\n    // Cargar el menú desde la API\r\n    async function loadMenu() {\r\n      try {\r\n        isLoading.value = true;\r\n        error.value = null; // Resetear error al inicio\r\n        console.log(\"Cargando menú con ID:\", route.params.id);\r\n        \r\n        if (!route.params.id) {\r\n          error.value = 'ID de menú no especificado';\r\n          isLoading.value = false;\r\n          return;\r\n        }\r\n        \r\n        // Intenta cargar desde localStorage primero (por si hay un carrito guardado)\r\n        const savedCart = localStorage.getItem(`cart_${route.params.id}`);\r\n        if (savedCart) {\r\n          try {\r\n            cartItems.value = JSON.parse(savedCart);\r\n            console.log(\"Carrito recuperado de localStorage:\", cartItems.value);\r\n          } catch (e) {\r\n            console.error(\"Error al parsear carrito de localStorage:\", e);\r\n          }\r\n        }\r\n        \r\n        try {\r\n          // Cargar el menú y los items\r\n          const data = await getSharedMenu(route.params.id);\r\n          \r\n          if (data && data.items) {\r\n            // Asignar los items al menuData\r\n            menuData.value.items = data.items;\r\n            \r\n            // Intentar cargar la información del negocio desde el backend\r\n            try {\r\n              const businessInfo = await fetchBusinessInfoFromBackend();\r\n              if (businessInfo) {\r\n                menuData.value.businessInfo = businessInfo;\r\n                lastBusinessInfoUpdate.value = Date.now();\r\n                console.log(\"Información del negocio cargada del backend:\", businessInfo);\r\n              }\r\n            } catch (businessInfoError) {\r\n              console.warn(\"No se pudo cargar información del negocio desde backend:\", businessInfoError);\r\n              // Mantener la información que vino con el menú si existe\r\n              if (data.businessInfo) {\r\n                menuData.value.businessInfo = data.businessInfo;\r\n              }\r\n            }\r\n            \r\n            console.log(\"Menú cargado con éxito:\", menuData.value);\r\n            \r\n            // Inicializar disponibilidad para cada ítem\r\n            menuData.value.items.forEach(item => {\r\n              // Si la disponibilidad es explícitamente 0, mantenerla así\r\n              // Si es undefined o null, usar 0 en lugar de un valor predeterminado de 10\r\n              item.availableQuantity = item.availableQuantity !== undefined ? \r\n                Number(item.availableQuantity) : 0;\r\n              item.realAvailability = item.availableQuantity;\r\n            });\r\n            \r\n            // Actualizar disponibilidad real considerando el carrito\r\n            updateAvailabilityInMenu();\r\n            \r\n            // Guardar en localStorage como respaldo\r\n            try {\r\n              localStorage.setItem(`menu_${route.params.id}`, JSON.stringify(menuData.value));\r\n            } catch (saveError) {\r\n              console.warn('No se pudo guardar el menú en localStorage:', saveError);\r\n            }\r\n          } else {\r\n            throw new Error('Datos de menú no válidos');\r\n          }\r\n        } catch (apiError) {\r\n          console.error(\"Error al cargar el menú desde la API:\", apiError);\r\n          \r\n          // Intentar recuperar desde localStorage como respaldo\r\n          try {\r\n            const cachedMenu = localStorage.getItem(`menu_${route.params.id}`);\r\n            if (cachedMenu) {\r\n              menuData.value = JSON.parse(cachedMenu);\r\n              console.log(\"Menú recuperado desde localStorage:\", menuData.value);\r\n              \r\n              if (menuData.value && menuData.value.items) {\r\n                // Inicializar disponibilidad para cada ítem\r\n                menuData.value.items.forEach(item => {\r\n                  item.availableQuantity = item.availableQuantity !== undefined ? \r\n                    Number(item.availableQuantity) : 0;\r\n                  item.realAvailability = item.availableQuantity;\r\n                });\r\n                \r\n                // Actualizar disponibilidad real considerando el carrito\r\n                updateAvailabilityInMenu();\r\n                \r\n                // Mostrar notificación de que se está usando datos en caché\r\n                showToast('Usando datos almacenados localmente. Algunas funciones pueden estar limitadas.', 'warning');\r\n              } else {\r\n                throw new Error('Datos de menú en caché no válidos');\r\n              }\r\n            } else {\r\n              throw new Error('No se encontró el menú en caché');\r\n            }\r\n          } catch (cacheError) {\r\n            console.error(\"Error al recuperar menú desde caché:\", cacheError);\r\n            error.value = 'No se encontró el menú solicitado. Por favor, verifica el enlace o intenta más tarde.';\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Error general al cargar el menú:\", e);\r\n        error.value = e.message || 'Error al cargar el menú';\r\n      } finally {\r\n        isLoading.value = false;\r\n      }\r\n    }\r\n\r\n    // Verificar si hay información de pago\r\n    const hasPaymentInfo = computed(() => {\r\n      const paymentInfo = menuData.value?.businessInfo?.paymentInfo;\r\n      \r\n      if (!paymentInfo) return false;\r\n      \r\n      // Verificar si hay al menos un campo de información de pago con datos\r\n      return !!(\r\n        (paymentInfo.qrImage && isValidImage(paymentInfo.qrImage)) || \r\n        paymentInfo.qrTitle || \r\n        paymentInfo.nequiNumber || \r\n        (paymentInfo.nequiImage && isValidImage(paymentInfo.nequiImage)) || \r\n        paymentInfo.bankInfo || \r\n        paymentInfo.otherPaymentMethods\r\n      );\r\n    });\r\n    \r\n    // Contador total de items\r\n    const totalItems = computed(() => {\r\n      return cartItems.value.reduce((total, item) => total + item.quantity, 0);\r\n    });\r\n\r\n    // Total del carrito\r\n    const cartTotal = computed(() => {\r\n      return cartItems.value.reduce((total, item) => {\r\n        return total + (item.price * item.quantity);\r\n      }, 0);\r\n    });\r\n\r\n    // Formatear precio\r\n    function formatPrice(price) {\r\n      if (isNaN(Number(price))) return '0,00';\r\n      \r\n      // Convertir a número y formatear con 2 decimales fijos\r\n      const numero = Number(price).toFixed(2);\r\n      \r\n      // Separar parte entera y decimal\r\n      const [parteEntera, parteDecimal] = numero.split('.');\r\n      \r\n      // Formatear parte entera con puntos como separadores de miles\r\n      const parteEnteraFormateada = parteEntera.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\r\n      \r\n      // Unir con coma como separador decimal\r\n      return `${parteEnteraFormateada},${parteDecimal}`;\r\n    }\r\n\r\n    // Agregar al carrito con verificación de disponibilidad\r\n    async function addToCart(item) {\r\n      // Verificación directa antes de hacer la comprobación completa\r\n      if (Number(item.availableQuantity) <= 0) {\r\n        showToast(`Lo sentimos, \"${item.name}\" no está disponible actualmente. Intente más tarde por favor.`, 'error');\r\n        return;\r\n      }\r\n      \r\n      const isAvailable = await checkAvailability(item);\r\n      if (!isAvailable) return;\r\n      \r\n      const existingItem = cartItems.value.find(i => {\r\n        // Asegurar que ambos items tienen ID y compararlos, o comparar por nombre si no hay ID\r\n        if (item.id && i.id) {\r\n          return i.id === item.id;\r\n        }\r\n        return i.name === item.name;\r\n      });\r\n      \r\n      if (existingItem) {\r\n        existingItem.quantity++;\r\n      } else {\r\n        cartItems.value.push({\r\n          id: item.id || Date.now().toString(),\r\n          name: item.name,\r\n          price: item.price,\r\n          quantity: 1,\r\n          availableQuantity: item.availableQuantity || 0 // Usar 0 como valor por defecto\r\n        });\r\n      }\r\n      \r\n      // Guardar carrito en localStorage\r\n      saveCartToLocalStorage();\r\n      \r\n      // Actualizar la disponibilidad en tiempo real\r\n      updateAvailabilityInMenu();\r\n      \r\n      // Mostrar notificación de éxito\r\n      showToast(`${item.name} añadido al carrito`, 'success');\r\n    }\r\n    \r\n    // Mostrar notificaciones toast\r\n    function showToast(message, type = 'success', duration = 5000) { // Aumentar a 5 segundos\r\n      console.log(`[Toast] Mostrando notificación: ${message} (${type})`);\r\n      \r\n      // Si ya hay un toast visible, limpiamos su timeout\r\n      if (toast.value.timeoutId) {\r\n        clearTimeout(toast.value.timeoutId);\r\n      }\r\n      \r\n      // Configurar el nuevo toast\r\n      toast.value.message = message;\r\n      toast.value.type = type;\r\n      toast.value.visible = true;\r\n      \r\n      // Debug: verificar que el estado del toast cambió\r\n      console.log(`[Toast] Estado: visible=${toast.value.visible}, message=${toast.value.message}`);\r\n      \r\n      // Configurar timeout para ocultar después de la duración\r\n      toast.value.timeoutId = setTimeout(() => {\r\n        console.log(`[Toast] Ocultando notificación después de ${duration}ms`);\r\n        toast.value.visible = false;\r\n      }, duration);\r\n    }\r\n\r\n    // Guardar carrito en localStorage\r\n    function saveCartToLocalStorage() {\r\n      try {\r\n        localStorage.setItem(`cart_${route.params.id}`, JSON.stringify(cartItems.value));\r\n      } catch (e) {\r\n        console.error(\"Error al guardar carrito en localStorage:\", e);\r\n      }\r\n    }\r\n\r\n    // Incrementar cantidad\r\n    function increaseQuantity(index) {\r\n      const item = cartItems.value[index];\r\n      \r\n      // Buscar el ítem en el menú\r\n      const menuItem = menuData.value.items?.find(i => i.id === item.id);\r\n      if (menuItem) {\r\n        // Verificar disponibilidad\r\n        const availableQuantity = menuItem.availableQuantity || 0;\r\n        if (item.quantity >= availableQuantity) {\r\n          showToast(`No hay más unidades disponibles de \"${item.name}\"`, 'warning');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Incrementar cantidad\r\n      item.quantity++;\r\n      \r\n      // Guardar carrito y actualizar disponibilidad\r\n      saveCartToLocalStorage();\r\n      updateAvailabilityInMenu();\r\n    }\r\n\r\n    // Reemplazar la función decreaseQuantity (líneas 409-416)\r\n    function decreaseQuantity(index) {\r\n      if (cartItems.value[index].quantity > 1) {\r\n        cartItems.value[index].quantity--;\r\n        saveCartToLocalStorage();\r\n        updateAvailabilityInMenu(); // Actualizar disponibilidad\r\n      } else {\r\n        removeFromCart(index);\r\n      }\r\n    }\r\n\r\n    // Reemplazar la función removeFromCart (líneas 419-422)\r\n    function removeFromCart(index) {\r\n      cartItems.value.splice(index, 1);\r\n      saveCartToLocalStorage();\r\n      updateAvailabilityInMenu(); // Actualizar disponibilidad\r\n    }\r\n    \r\n    // Completar pedido con actualización de inventario\r\n    async function completeOrder() {\r\n      try {\r\n        // Validaciones básicas\r\n        if (cartItems.value.length === 0) {\r\n          showToast('No hay ítems en el pedido', 'error');\r\n          return;\r\n        }\r\n        \r\n        if (!customerInfo.value.name || !customerInfo.value.phone) {\r\n          showToast('Por favor complete su nombre y teléfono', 'error');\r\n          return;\r\n        }\r\n      \r\n        // Indicar que está procesando\r\n        isProcessingOrder.value = true;\r\n        \r\n        // Actualizar inventario - Usar el carrito correcto\r\n        await updateInventory();\r\n        \r\n        // Compartir en WhatsApp\r\n        openWhatsAppShare();\r\n        \r\n        showToast('¡Pedido completado! Gracias por tu compra.', 'success');\r\n        \r\n        // Limpiar carrito y datos del cliente después de completar\r\n        setTimeout(() => {\r\n          // Limpiar carrito\r\n          cartItems.value = [];\r\n          \r\n          // Limpiar localStorage\r\n          localStorage.removeItem(`cart_${route.params.id}`);\r\n          \r\n          // Limpiar datos del cliente\r\n          customerInfo.value = {\r\n            name: '',\r\n            phone: '',\r\n            email: '',\r\n            address: ''\r\n          };\r\n          additionalMessage.value = '';\r\n          isProcessingOrder.value = false;\r\n        }, 2000);\r\n      } catch (error) {\r\n        console.error('Error al completar el pedido:', error);\r\n        showToast('Error al procesar el pedido', 'error');\r\n        isProcessingOrder.value = false;\r\n      }\r\n    }\r\n    \r\n    // Compartir pedido por WhatsApp sin actualizar inventario\r\nfunction shareOrderByWhatsApp() {\r\n  // Validaciones básicas\r\n  if (cartItems.value.length === 0) {\r\n    showToast('No hay ítems en el pedido', 'error');\r\n    return;\r\n  }\r\n\r\n  if (!customerInfo.value.name || !customerInfo.value.phone) {\r\n    showToast('Por favor complete su nombre y teléfono', 'error');\r\n    return;\r\n  }\r\n\r\n  // Compartir directamente en WhatsApp sin actualizar inventario\r\n  openWhatsAppShare();\r\n\r\n  showToast('Pedido compartido por WhatsApp', 'success');\r\n}\r\n\r\nfunction openWhatsAppShare() {\r\n  // Construir mensaje de pedido para WhatsApp\r\n  let whatsappMessage = `🛒 *Pedido de ${customerInfo.value.name}*\\n\\n`;\r\n  whatsappMessage += `📦 *Productos:*\\n`;\r\n\r\n  cartItems.value.forEach(item => {\r\n    const subtotal = (item.price * item.quantity).toFixed(2);\r\n    whatsappMessage += `🍽️ ${item.quantity}x ${item.name} = $${formatPrice(subtotal)}\\n`;\r\n  });\r\n\r\n  whatsappMessage += `\\n💵 *Total:* $${formatPrice(cartTotal.value)}\\n`;\r\n\r\n  if (customerInfo.value.phone) {\r\n    whatsappMessage += `📞 *Teléfono:* ${customerInfo.value.phone}\\n`;\r\n  }\r\n\r\n  if (customerInfo.value.email) {\r\n    whatsappMessage += `✉️ *Email:* ${customerInfo.value.email}\\n`;\r\n  }\r\n\r\n  if (customerInfo.value.address) {\r\n    whatsappMessage += `📍 *Dirección:* ${customerInfo.value.address}\\n`;\r\n  }\r\n\r\n  if (additionalMessage.value) {\r\n    whatsappMessage += `📝 *Notas adicionales:*\\n${additionalMessage.value}\\n`;\r\n  }\r\n\r\n  // Añadir método de pago seleccionado\r\n  const formaPago = selectedPaymentMethod.value === 'qr' ? 'Código QR' :\r\n                    selectedPaymentMethod.value === 'nequi' ? 'Nequi' :\r\n                    'Contra entrega';\r\n\r\n  whatsappMessage += `\\n💳 *Forma de pago:* ${formaPago}`;\r\n\r\n  // Codificar y generar la URL de WhatsApp\r\n  const encodedMessage = encodeURIComponent(whatsappMessage);\r\n  const whatsappUrl = `https://api.whatsapp.com/send?text=${encodedMessage}`;\r\n\r\n  // Abrir WhatsApp en una nueva ventana\r\n  window.open(whatsappUrl, '_blank');\r\n}\r\n\r\n    // Desplazarse a la sección del pedido\r\n    function scrollToOrder() {\r\n      const orderSection = document.querySelector('.order-section');\r\n      if (orderSection) {\r\n        orderSection.scrollIntoView({ behavior: 'smooth' });\r\n      }\r\n    }\r\n\r\n    // Verificar disponibilidad de inventario\r\n    async function checkAvailability(item) {\r\n      // Obtener la disponibilidad base (valor original del inventario)\r\n      // Importante: asegurarse que sea un número\r\n      const baseAvailability = Number(item.availableQuantity) || 0;\r\n      \r\n      // Verificación directa: si no hay stock, mostrar mensaje de error\r\n      if (baseAvailability <= 0) {\r\n        showToast(`Lo sentimos, \"${item.name}\" no está disponible actualmente. Intente más tarde por favor.`, 'error');\r\n        return false;\r\n      }\r\n      \r\n      // Obtener la cantidad actual en el carrito\r\n      const cartItem = cartItems.value.find(i => i.id === item.id);\r\n      const cartQuantity = cartItem ? cartItem.quantity : 0;\r\n      \r\n      // Calcular disponibilidad real\r\n      const realAvailability = baseAvailability - cartQuantity;\r\n      \r\n      // Verificar la disponibilidad considerando lo que ya está en el carrito\r\n      if (realAvailability <= 0) {\r\n        showToast(`No hay más unidades disponibles de \"${item.name}\"`, 'warning');\r\n        return false;\r\n      } else if (realAvailability <= 5) {\r\n        showToast(`¡Solo quedan ${realAvailability} unidades de \"${item.name}\"!`, 'warning');\r\n      }\r\n      \r\n      return true;\r\n    }\r\n\r\n    // Actualizar inventario al completar pedido\r\n    async function updateInventory() {\r\n      try {\r\n        // Validaciones iniciales\r\n        if (!cartItems.value || cartItems.value.length === 0) {\r\n          console.warn('Intentando actualizar inventario con carrito vacío');\r\n          return;\r\n        }\r\n        \r\n        console.log(`Iniciando actualización de inventario para ${cartItems.value.length} productos...`);\r\n        \r\n        // Obtener los elementos actuales del menú para actualizar cantidades\r\n        const currentMenu = await getMenuItems();\r\n        if (!currentMenu || !Array.isArray(currentMenu)) {\r\n          console.error('No se pudo obtener el menú actual');\r\n          return false;\r\n        }\r\n        \r\n        // Crear una copia profunda del carrito para procesar (evitar modificaciones durante el procesamiento)\r\n        const itemsToProcess = JSON.parse(JSON.stringify(cartItems.value));\r\n        const updateResults = [];\r\n        let hasErrors = false;\r\n        \r\n        // Importar función para guardar elementos vendidos\r\n        const { getSoldItems, saveSoldItems } = await import('../services/storageService');\r\n        \r\n        // Obtener la lista actual de elementos vendidos\r\n        let soldItemsList = [];\r\n        try {\r\n          soldItemsList = await getSoldItems() || [];\r\n          if (!Array.isArray(soldItemsList)) {\r\n            soldItemsList = [];\r\n          }\r\n          console.log('Lista de elementos vendidos obtenida:', soldItemsList.length);\r\n        } catch (soldItemsError) {\r\n          console.warn('Error al obtener elementos vendidos:', soldItemsError);\r\n          soldItemsList = [];\r\n        }\r\n        \r\n        // Procesar cada elemento del carrito de forma secuencial para evitar condiciones de carrera\r\n        for (let i = 0; i < itemsToProcess.length; i++) {\r\n          const cartItem = itemsToProcess[i];\r\n          console.log(`Procesando item ${i+1}/${itemsToProcess.length}: ${cartItem.name} (ID: ${cartItem.id})`);\r\n          \r\n          try {\r\n            // Buscar el ítem correspondiente en el menú actual\r\n            const menuItem = currentMenu.find(item => item.id === cartItem.id);\r\n            \r\n            if (!menuItem) {\r\n              console.warn(`Elemento no encontrado en el menú: ${cartItem.name} (ID: ${cartItem.id})`);\r\n              updateResults.push({\r\n                name: cartItem.name,\r\n                success: false,\r\n                error: 'Elemento no encontrado en el menú'\r\n              });\r\n              continue;\r\n            }\r\n            \r\n            // Garantizar que estamos trabajando con números enteros válidos\r\n            const currentQuantity = parseInt(Number(menuItem.availableQuantity || 0), 10);\r\n            const soldQuantity = parseInt(Number(cartItem.quantity || 0), 10);\r\n            \r\n            if (isNaN(currentQuantity) || isNaN(soldQuantity)) {\r\n              const error = `Cantidades inválidas para ${cartItem.name}: disponible=${menuItem.availableQuantity}, vendido=${cartItem.quantity}`;\r\n              console.error(error);\r\n              updateResults.push({\r\n                name: cartItem.name,\r\n                success: false,\r\n                error: error\r\n              });\r\n              hasErrors = true;\r\n              continue;\r\n            }\r\n            \r\n            // Calcular nueva cantidad exacta como entero\r\n            const newQuantity = Math.max(0, currentQuantity - soldQuantity);\r\n            \r\n            console.log(`Actualizando ${cartItem.name}: ${currentQuantity} - ${soldQuantity} = ${newQuantity} (currentQuantity tipo: ${typeof currentQuantity}, soldQuantity tipo: ${typeof soldQuantity})`);\r\n            \r\n            // Actualizar disponibilidad usando la función mejorada - forzar como número entero\r\n            const updateSuccess = await updateItemAvailability(menuItem.id, newQuantity);\r\n            \r\n            // Registrar resultado detallado\r\n            updateResults.push({\r\n              name: cartItem.name,\r\n              oldQuantity: currentQuantity,\r\n              soldQuantity: soldQuantity,\r\n              newQuantity: newQuantity,\r\n              success: updateSuccess,\r\n              error: updateSuccess ? null : 'Error al actualizar disponibilidad'\r\n            });\r\n            \r\n            if (!updateSuccess) {\r\n              hasErrors = true;\r\n            } else {\r\n              // Registrar en la lista de platos vendidos si la actualización fue exitosa\r\n              const currentDate = new Date().toISOString();\r\n              const existingSoldItem = soldItemsList.find(item => item.name === cartItem.name);\r\n              \r\n              if (existingSoldItem) {\r\n                existingSoldItem.quantity += soldQuantity;\r\n                existingSoldItem.date = currentDate;\r\n              } else {\r\n                soldItemsList.push({\r\n                  name: cartItem.name,\r\n                  quantity: soldQuantity,\r\n                  price: cartItem.price,\r\n                  includesDrink: menuItem.includesDrink || false,\r\n                  date: currentDate\r\n                });\r\n              }\r\n              console.log(`Elemento registrado en lista de vendidos: ${cartItem.name} x${soldQuantity}`);\r\n            }\r\n          } catch (itemError) {\r\n            console.error(`Error procesando ${cartItem.name}:`, itemError);\r\n            updateResults.push({\r\n              name: cartItem.name,\r\n              success: false,\r\n              error: itemError.message || 'Error desconocido'\r\n            });\r\n            hasErrors = true;\r\n          }\r\n        }\r\n        \r\n        // Guardar la lista actualizada de elementos vendidos\r\n        try {\r\n          await saveSoldItems(soldItemsList);\r\n          console.log(`Lista de elementos vendidos actualizada con ${soldItemsList.length} elementos`);\r\n        } catch (saveError) {\r\n          console.error('Error al guardar elementos vendidos:', saveError);\r\n        }\r\n        \r\n        // Mostrar resumen de la operación\r\n        const successCount = updateResults.filter(r => r.success).length;\r\n        console.log(`Actualización de inventario completada. Éxitos: ${successCount}/${itemsToProcess.length}`);\r\n        \r\n        // Registrar detalles completos de la actualización\r\n        console.log('Detalles de actualización de inventario:', updateResults);\r\n        \r\n        if (hasErrors) {\r\n          const failedItems = updateResults.filter(r => !r.success).map(r => r.name).join(', ');\r\n          console.warn(`Algunos productos no se pudieron actualizar: ${failedItems}`);\r\n        }\r\n        \r\n        return successCount > 0;\r\n      } catch (error) {\r\n        console.error('Error general al actualizar inventario:', error);\r\n        return false;\r\n      }\r\n    }\r\n\r\n    // Añadir después de la función checkAvailability (línea 585)\r\n    // Función para actualizar la disponibilidad en tiempo real\r\n    function updateAvailabilityInMenu() {\r\n      if (!menuData.value?.items) return;\r\n      \r\n      // Actualizar la disponibilidad de todos los ítems\r\n      menuData.value.items.forEach(menuItem => {\r\n        // Encontrar si este ítem está en el carrito\r\n        const cartItem = cartItems.value.find(i => i.id === menuItem.id);\r\n        const cartQuantity = cartItem ? cartItem.quantity : 0;\r\n        \r\n        // Asegurarse de que availableQuantity sea un número exacto, no undefined o null\r\n        const baseAvailability = Number(menuItem.availableQuantity) || 0;\r\n        \r\n        // Calcular disponibilidad real\r\n        menuItem.realAvailability = baseAvailability - cartQuantity;\r\n        \r\n        console.log(`Disponibilidad actualizada para ${menuItem.name}: ${menuItem.realAvailability} unidades (base: ${baseAvailability}, carrito: ${cartQuantity})`);\r\n      });\r\n    }\r\n\r\n    // Verificar si una cadena de imagen es válida\r\n    function isValidImage(imageString) {\r\n      if (!imageString) return false;\r\n      \r\n      // Verificar si es una URL\r\n      if (imageString.startsWith('http://') || imageString.startsWith('https://')) {\r\n        return true;\r\n      }\r\n      \r\n      // Verificar si es una imagen en base64\r\n      if (imageString.startsWith('data:image/')) {\r\n        return true;\r\n      }\r\n      \r\n      return false;\r\n    }\r\n    \r\n    // Corregir formato de imagen si es necesario\r\n    function fixImageFormat(imageString) {\r\n      if (!imageString) return '';\r\n      \r\n      // Si ya es una URL o base64 válido, devolverlo tal cual\r\n      if (isValidImage(imageString)) {\r\n        return imageString;\r\n      }\r\n      \r\n      // Intentar convertir a base64 si no tiene el prefijo correcto\r\n      if (imageString.includes('/9j/') && !imageString.startsWith('data:image/')) {\r\n        return `data:image/jpeg;base64,${imageString}`;\r\n      }\r\n      \r\n      // Si no se puede arreglar, devolver una imagen por defecto\r\n      return '';\r\n    }\r\n\r\n    // Datos del cliente\r\n    const customerInfo = ref({\r\n      name: '',\r\n      phone: '',\r\n      email: '',\r\n      address: ''\r\n    });\r\n\r\n    // Método de pago seleccionado\r\n    const selectedPaymentMethod = ref('cash'); // Por defecto contra entrega\r\n\r\n    // Mensaje adicional\r\n    const additionalMessage = ref('');\r\n\r\n    // Filtrar items regulares y especiales\r\n    const regularItems = computed(() => {\r\n      if (!menuData.value || !menuData.value.items) return [];\r\n      const filtered = menuData.value.items.filter(item => !item.isSpecial);\r\n      console.log('Platos regulares:', filtered.length, filtered.map(i => i.name));\r\n      return filtered;\r\n    });\r\n\r\n    const specialItems = computed(() => {\r\n      if (!menuData.value || !menuData.value.items) return [];\r\n      const filtered = menuData.value.items.filter(item => item.isSpecial === true);\r\n      console.log('Platos especiales:', filtered.length, filtered.map(i => i.name));\r\n      return filtered;\r\n    });\r\n\r\n    // Estado para el formulario de reserva\r\n    const showReservationForm = ref(false);\r\n    const isProcessingReservation = ref(false);\r\n    const reservationSuccess = ref(false);\r\n    const reservationError = ref(null);\r\n    \r\n    const reservationData = ref({\r\n      fullName: '',\r\n      mobilePhone: '',\r\n      landlinePhone: '',\r\n      address: '',\r\n      email: '',\r\n      orderDate: getCurrentDate(), // Set the initial value here\r\n      reservationDate: '',\r\n      reservationTime: '',\r\n      peopleCount: 1,\r\n      additionalNotes: ''\r\n    });\r\n    \r\n    // Función para obtener la fecha actual en formato YYYY-MM-DD\r\n    function getCurrentDate() {\r\n      const today = new Date();\r\n      const year = today.getFullYear();\r\n      const month = String(today.getMonth() + 1).padStart(2, '0');\r\n      const day = String(today.getDate()).padStart(2, '0');\r\n      return `${year}-${month}-${day}`;\r\n    }\r\n    \r\n    // Función para enviar la reserva\r\n    async function submitReservation() {\r\n      isProcessingReservation.value = true;\r\n      reservationSuccess.value = false;\r\n      reservationError.value = null;\r\n      \r\n      try {\r\n        // Utilizamos el servicio de reservas para guardar los datos\r\n        const result = await saveReservation(reservationData.value);\r\n        \r\n        if (result.success) {\r\n          // Reserva guardada correctamente\r\n          reservationSuccess.value = true;\r\n          showToast('¡Reserva enviada con éxito! Recibirá un correo de confirmación en breve.', 'success');\r\n          \r\n          // Enviar correo de confirmación (simulado)\r\n          console.log('Enviando correo de confirmación a:', reservationData.value.email);\r\n          \r\n          // Limpiar el formulario y ocultarlo después de un tiempo\r\n          setTimeout(() => {\r\n            resetReservationForm();\r\n            showReservationForm.value = false;\r\n          }, 3000);\r\n        } else {\r\n          // Error al guardar la reserva\r\n          throw new Error(result.error || 'Error al procesar la reserva');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error al enviar la reserva:', error);\r\n        reservationError.value = 'Ocurrió un error al procesar su reserva. Por favor, intente nuevamente.';\r\n        showToast('Error al procesar la reserva. Por favor, intente nuevamente.', 'error');\r\n      } finally {\r\n        isProcessingReservation.value = false;\r\n      }\r\n    }\r\n    \r\n    // Función para cancelar la reserva\r\n    function cancelReservation() {\r\n      resetReservationForm();\r\n      showReservationForm.value = false;\r\n    }\r\n    \r\n    // Función para reiniciar el formulario\r\n    function resetReservationForm() {\r\n      reservationData.value.fullName = '';\r\n      reservationData.value.mobilePhone = '';\r\n      reservationData.value.landlinePhone = '';\r\n      reservationData.value.address = '';\r\n      reservationData.value.email = '';\r\n      reservationData.value.orderDate = getCurrentDate();\r\n      reservationData.value.reservationDate = '';\r\n      reservationData.value.reservationTime = '';\r\n      reservationData.value.peopleCount = 1;\r\n      reservationData.value.additionalNotes = '';\r\n      reservationSuccess.value = false;\r\n      reservationError.value = null;\r\n    }\r\n\r\n    // Refrescar información del negocio manualmente\r\n    async function refreshBusinessInfo() {\r\n      try {\r\n        const businessInfo = await fetchBusinessInfoFromBackend(true);\r\n        if (businessInfo) {\r\n          menuData.value.businessInfo = businessInfo;\r\n          lastBusinessInfoUpdate.value = Date.now();\r\n          showToast('Información del negocio actualizada', 'success');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error al refrescar información del negocio:', error);\r\n        showToast('Error al actualizar información del negocio', 'error');\r\n      }\r\n    }\r\n\r\n    return {\r\n      menuId,\r\n      isLoading,\r\n      error,\r\n      menuData,\r\n      regularItems,\r\n      specialItems,\r\n      cartItems,\r\n      cartTotal,\r\n      totalItems,\r\n      customerInfo,\r\n      selectedPaymentMethod,\r\n      additionalMessage,\r\n      addToCart,\r\n      removeFromCart,\r\n      increaseQuantity,\r\n      decreaseQuantity,\r\n      formatPrice,\r\n      completeOrder,\r\n      shareOrderByWhatsApp,\r\n      scrollToOrder,\r\n      isValidImage,\r\n      fixImageFormat,\r\n      hasPaymentInfo,\r\n      // Reservas\r\n      showReservationForm,\r\n      reservationData,\r\n      isProcessingReservation,\r\n      reservationSuccess,\r\n      reservationError,\r\n      submitReservation,\r\n      cancelReservation,\r\n      getCurrentDate,\r\n      // Añadir el objeto toast para que esté disponible en la plantilla\r\n      toast,\r\n      // Función para refrescar información del negocio\r\n      refreshBusinessInfo,\r\n      // Última actualización de la información del negocio\r\n      lastBusinessInfoUpdate\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.shared-menu-container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  font-family: 'Arial', sans-serif;\r\n}\r\n\r\n.loading, .error {\r\n  text-align: center;\r\n  padding: 50px;\r\n  font-size: 18px;\r\n}\r\n\r\n.error {\r\n  color: #d9534f;\r\n}\r\n\r\n.business-info {\r\n  text-align: center;\r\n  margin-bottom: 40px;\r\n  padding: 20px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n}\r\n\r\n.business-logo {\r\n  max-width: 100%;\r\n  max-height: 150px;\r\n  object-fit: contain;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.business-info h1 {\r\n  color: #343a40;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.description {\r\n  font-style: italic;\r\n  color: #6c757d;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.contact-info {\r\n  font-size: 14px;\r\n  color: #495057;\r\n}\r\n\r\n.menu-list {\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.menu-list h2 {\r\n  color: #28a745;\r\n  font-size: 24px;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  padding-bottom: 10px;\r\n  border-bottom: 2px solid #28a745;\r\n}\r\n\r\n.menu-items {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\r\n  gap: 20px;\r\n}\r\n\r\n.menu-item {\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\r\n}\r\n\r\n.menu-item:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 5px 15px rgba(0,0,0,0.2);\r\n}\r\n\r\n.item-image-container {\r\n  width: 100%;\r\n  height: 200px;\r\n  overflow: hidden;\r\n}\r\n\r\n.item-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n.no-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #f8f9fa;\r\n  color: #6c757d;\r\n  font-style: italic;\r\n}\r\n\r\n.item-details {\r\n  padding: 15px;\r\n}\r\n\r\n.item-details h3 {\r\n  margin-top: 0;\r\n  color: #343a40;\r\n  font-size: 18px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.item-description {\r\n  color: #6c757d;\r\n  font-size: 14px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.item-price {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #28a745;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.includes-drink {\r\n  font-size: 14px;\r\n  color: #6c757d;\r\n  font-style: italic;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.add-to-cart-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 100%;\r\n  padding: 10px 15px;\r\n  background-color: #28a745;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n  font-weight: bold;\r\n}\r\n\r\n.add-to-cart-btn:hover {\r\n  background-color: #218838;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.quantity-display {\r\n  min-width: 30px;\r\n  text-align: center;\r\n  font-weight: bold;\r\n}\r\n\r\n/* Estilos para acciones de pedido */\r\n.order-actions {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  margin-top: 15px;\r\n  gap: 10px;\r\n}\r\n\r\n.complete-order-btn,\r\n.whatsapp-order-btn {\r\n  border: none;\r\n  padding: 12px 20px;\r\n  border-radius: 4px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n  gap: 8px;\r\n  height: 48px;\r\n  font-size: 17px;\r\n  width: 100%;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  letter-spacing: 0.5px;\r\n  text-shadow: 0 1px 2px rgba(0,0,0,0.3);\r\n}\r\n\r\n.complete-order-btn {\r\n  background-color: #218838;\r\n  color: white;\r\n  margin: 0;\r\n  border: 2px solid #1e7e34;\r\n}\r\n\r\n.complete-order-btn:hover {\r\n  background-color: #1e7e34;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 8px rgba(0,0,0,0.2);\r\n}\r\n\r\n.whatsapp-order-btn {\r\n  height: 48px;\r\n  font-size: 17px;\r\n  width: 100%;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  letter-spacing: 0.5px;\r\n  text-shadow: 0 1px 2px rgba(0,0,0,0.3);\r\n}\r\n\r\n.complete-order-btn {\r\n  background-color: #218838;\r\n  color: white;\r\n  margin: 0;\r\n  border: 2px solid #1e7e34;\r\n}\r\n\r\n.complete-order-btn:hover {\r\n  background-color: #1e7e34;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 8px rgba(0,0,0,0.2);\r\n}\r\n\r\n.whatsapp-order-btn {\r\n  background-color: #128C7E;\r\n  color: white;\r\n  margin: 0;\r\n  border: 2px solid #075E54;\r\n}\r\n\r\n.whatsapp-order-btn:hover {\r\n  background-color: #075E54;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 8px rgba(0,0,0,0.2);\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 18px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-right: 8px;\r\n}\r\n\r\n/* Estilos para la sección de \"Tu Pedido\" */\r\n.order-section {\r\n  margin: 30px auto;\r\n  padding: 20px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n  max-width: 800px;\r\n  border: 2px solid #28a745;\r\n  position: relative;\r\n}\r\n\r\n.order-section::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: -10px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 10px solid transparent;\r\n  border-right: 10px solid transparent;\r\n  border-bottom: 10px solid #28a745;\r\n}\r\n\r\n.order-section h2 {\r\n  color: #343a40;\r\n  font-size: 24px;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  padding-bottom: 10px;\r\n  border-bottom: 2px solid #28a745;\r\n}\r\n\r\n.cart-items {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.cart-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 15px;\r\n  border-bottom: 1px solid #dee2e6;\r\n  animation: fadeIn 0.3s ease;\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from { opacity: 0; transform: translateY(-10px); }\r\n  to { opacity: 1; transform: translateY(0); }\r\n}\r\n\r\n.cart-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.cart-item-details h3 {\r\n  margin: 0 0 5px 0;\r\n  font-size: 16px;\r\n}\r\n\r\n.cart-item-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.quantity-btn {\r\n  width: 30px;\r\n  height: 30px;\r\n  border-radius: 50%;\r\n  background-color: #f8f9fa;\r\n  border: 1px solid #28a745;\r\n  color: #28a745;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.quantity-btn:hover {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.remove-btn {\r\n  padding: 5px 10px;\r\n  background-color: #dc3545;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.remove-btn:hover {\r\n  background-color: #c82333;\r\n}\r\n\r\n.cart-total {\r\n  text-align: right;\r\n  padding-top: 15px;\r\n  border-top: 2px solid #28a745;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-end;\r\n  gap: 10px;\r\n}\r\n\r\n.cart-total h3 {\r\n  color: #343a40;\r\n  margin: 0;\r\n}\r\n\r\n/* Estilos para el formulario de datos del cliente */\r\n.customer-form {\r\n  width: 100%;\r\n  margin-top: 20px;\r\n  padding: 15px;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n  border: 1px solid #dee2e6;\r\n}\r\n\r\n.customer-form h4 {\r\n  color: #343a40;\r\n  margin-top: 0;\r\n  margin-bottom: 15px;\r\n  text-align: center;\r\n  font-size: 16px;\r\n  border-bottom: 1px solid #e9ecef;\r\n  padding-bottom: 8px;\r\n}\r\n\r\n.form-row {\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.form-input, .form-textarea {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.form-input:focus, .form-textarea:focus {\r\n  border-color: #28a745;\r\n  outline: none;\r\n}\r\n\r\n.form-textarea {\r\n  min-height: 80px;\r\n  resize: vertical;\r\n}\r\n\r\n/* Estilos para las opciones de pago */\r\n.payment-methods-selection {\r\n  width: 100%;\r\n  margin: 15px 0;\r\n}\r\n\r\n.payment-methods-selection h4 {\r\n  color: #343a40;\r\n  margin-top: 10px;\r\n  margin-bottom: 15px;\r\n  text-align: center;\r\n  font-size: 16px;\r\n  border-bottom: 1px solid #e9ecef;\r\n  padding-bottom: 8px;\r\n}\r\n\r\n.payment-options {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  flex-wrap: wrap;\r\n  gap: 10px;\r\n}\r\n\r\n.payment-option {\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  padding: 8px 15px;\r\n  background-color: #f0f0f0;\r\n  border-radius: 4px;\r\n  transition: all 0.2s;\r\n  flex: 1;\r\n  min-width: 100px;\r\n  justify-content: center;\r\n  border: 2px solid transparent;\r\n}\r\n\r\n.payment-option:hover {\r\n  background-color: #e9ecef;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n}\r\n\r\n.payment-option input[type=\"radio\"] {\r\n  margin-right: 8px;\r\n  accent-color: #28a745;\r\n}\r\n\r\n.payment-option input[type=\"radio\"]:checked + .payment-option-text {\r\n  font-weight: bold;\r\n  color: #28a745;\r\n}\r\n\r\n.payment-option-text {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n}\r\n\r\n/* Estilo para opción seleccionada */\r\n.payment-option input[type=\"radio\"]:checked ~ .payment-option {\r\n  border-color: #28a745;\r\n  background-color: rgba(40, 167, 69, 0.1);\r\n}\r\n\r\n/* Botón flotante para ver pedido */\r\n.floating-cart-button {\r\n  position: fixed;\r\n  bottom: 20px;\r\n  right: 20px;\r\n  background-color: #28a745;\r\n  color: white;\r\n  border-radius: 50px;\r\n  padding: 10px 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.2);\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n  z-index: 98; /* Mantener por debajo del toast (9999) */\r\n  font-weight: bold;\r\n}\r\n\r\n/* Sistema de notificaciones toast */\r\n.toast-notification {\r\n  position: fixed;\r\n  bottom: 20px;\r\n  right: 20px;\r\n  padding: 15px 25px;\r\n  border-radius: 4px;\r\n  color: white;\r\n  z-index: 1000;\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.15);\r\n  animation: slideIn 0.3s ease-out forwards;\r\n}\r\n\r\n@keyframes slideIn {\r\n  from {\r\n    transform: translateY(100%);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateY(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n.toast-notification.success {\r\n  background-color: #28a745;\r\n}\r\n\r\n.toast-notification.error {\r\n  background-color: #dc3545;\r\n}\r\n\r\n.toast-notification.info {\r\n  background-color: #17a2b8;\r\n}\r\n\r\n.toast-notification.warning {\r\n  background-color: #ffc107;\r\n  color: #212529;\r\n}\r\n\r\n/* Estilos para la sección de formas de pago */\r\n.payment-section {\r\n  margin: 30px 0;\r\n  padding: 20px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n}\r\n\r\n.payment-section h2 {\r\n  color: #343a40;\r\n  font-size: 24px;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  padding-bottom: 10px;\r\n  border-bottom: 2px solid #28a745;\r\n}\r\n\r\n.payment-methods {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20px;\r\n  justify-content: center;\r\n}\r\n\r\n.payment-method {\r\n  flex: 1;\r\n  min-width: 200px;\r\n  max-width: 300px;\r\n  padding: 15px;\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 5px rgba(0,0,0,0.1);\r\n  text-align: center;\r\n}\r\n\r\n.payment-method h3 {\r\n  margin-top: 0;\r\n  color: #343a40;\r\n  font-size: 18px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.payment-image {\r\n  max-width: 100%;\r\n  max-height: 200px;\r\n  object-fit: contain;\r\n  margin: 0 auto;\r\n  display: block;\r\n}\r\n\r\n/* Específicamente reducir el tamaño de la imagen de Nequi */\r\n.payment-method img[alt=\"Nequi\"] {\r\n  max-height: 150px;\r\n  width: auto;\r\n}\r\n\r\n.payment-detail {\r\n  margin-top: 10px;\r\n  font-size: 14px;\r\n  color: #6c757d;\r\n}\r\n</style>\r\n","import { getBusinessInfo, compressImage, checkItemAvailability } from './storageService';\n\nconst DB_NAME = 'websapDatabase';\nconst DB_VERSION = 3; // Debe coincidir con el resto de servicios\nconst SHARED_MENU_STORE = 'sharedMenus';\nconst IMAGE_STORE = 'menuImages';\n\n// Abrir la conexión a la base de datos\nfunction openDatabase() {\n  return new Promise((resolve, reject) => {\n    try {\n      console.log(\"Intentando abrir la base de datos con versión:\", DB_VERSION);\n      const request = indexedDB.open(DB_NAME, DB_VERSION);\n      \n      request.onerror = (event) => {\n        console.error(\"Error al abrir la base de datos:\", event.target.error);\n        reject('Error al abrir la base de datos: ' + event.target.errorCode);\n      };\n      \n      request.onsuccess = (event) => {\n        const db = event.target.result;\n        console.log(\"Base de datos abierta con éxito, versión:\", db.version);\n        \n        // Verificar que todos los almacenes necesarios existen\n        const existingStores = Array.from(db.objectStoreNames);\n        console.log(\"Almacenes existentes:\", existingStores);\n        \n        if (!existingStores.includes(SHARED_MENU_STORE)) {\n          console.error(`El almacén ${SHARED_MENU_STORE} no existe en la base de datos`);\n          reject(new Error(`El almacén ${SHARED_MENU_STORE} no existe en la base de datos`));\n          return;\n        }\n        \n        resolve(db);\n      };\n      \n      request.onupgradeneeded = (event) => {\n        console.log(\"Actualizando estructura de la base de datos a versión:\", event.newVersion);\n        const db = event.target.result;\n        \n        // Crear almacén para menús compartidos si no existe\n        if (!db.objectStoreNames.contains(SHARED_MENU_STORE)) {\n          console.log('Creando almacén:', SHARED_MENU_STORE);\n          db.createObjectStore(SHARED_MENU_STORE, { keyPath: 'id' });\n        }\n        \n        // Crear almacén para imágenes si no existe\n        if (!db.objectStoreNames.contains(IMAGE_STORE)) {\n          console.log('Creando almacén:', IMAGE_STORE);\n          db.createObjectStore(IMAGE_STORE, { keyPath: 'id' });\n        }\n      };\n    } catch (error) {\n      console.error(\"Error crítico en IndexedDB:\", error);\n      reject(error);\n    }\n  });\n}\n\n/**\n * Genera un ID único para un menú\n * @returns {string} Un ID único\n */\nfunction generateMenuId() {\n  return Math.random().toString(36).substring(2, 10) + \n         Math.random().toString(36).substring(2, 10);\n}\n\n/**\n * Guarda un menú compartido y devuelve su ID\n * @param {Array} menuItems - Elementos del menú a guardar\n * @returns {Promise<String>} - ID del menú compartido\n */\nexport async function saveMenu(menuItems) {\n  try {\n    // Generar un ID único para el menú compartido\n    const menuId = generateMenuId();\n    \n    // Obtener información del negocio para incluirla en el menú compartido\n    const businessInfo = await getBusinessInfo();\n    \n    // Preprocesar los elementos del menú - comprimir imágenes y normalizar isSpecial\n    const processedItems = await Promise.all(menuItems.map(async (item) => {\n      const processedItem = { ...item };\n      processedItem.isSpecial = Boolean(item.isSpecial);\n      console.log(`[saveMenu] Guardando ${item.name} con isSpecial=${processedItem.isSpecial}`);\n      \n      // Comprimir la imagen si existe\n      if (processedItem.image && typeof processedItem.image === 'string' && processedItem.image.length > 0) {\n        try {\n          // Usar una calidad más baja para compartir\n          processedItem.image = await compressImage(processedItem.image, 400, 300, 0.5);\n        } catch (err) {\n          console.warn('Error al comprimir imagen:', err);\n          processedItem.image = null;\n        }\n      }\n      \n      return processedItem;\n    }));\n    \n    // Crear objeto del menú con información del negocio incluida\n    const menuData = {\n      id: menuId,\n      items: processedItems,\n      businessInfo: businessInfo, // Incluir la información del negocio (con datos de pago)\n      createdAt: new Date().toISOString()\n    };\n    \n    // Verificar tamaño del objeto\n    try {\n      const jsonSize = JSON.stringify(menuData).length / (1024 * 1024); // Tamaño en MB\n      console.log(`Tamaño del menú a guardar: ${jsonSize.toFixed(2)} MB`);\n      \n      if (jsonSize > 50) {\n        throw new Error(`El menú es demasiado grande (${jsonSize.toFixed(2)} MB). Reduce el tamaño de las imágenes.`);\n      }\n    } catch (error) {\n      console.error('Error al verificar tamaño del menú:', error);\n      throw new Error('Error al verificar tamaño del menú');\n    }\n    \n    // Guardar en IndexedDB\n    const db = await openDatabase();\n    const transaction = db.transaction([SHARED_MENU_STORE], 'readwrite');\n    const store = transaction.objectStore(SHARED_MENU_STORE);\n    \n    await new Promise((resolve, reject) => {\n      const request = store.put(menuData);\n      \n      request.onsuccess = () => {\n        console.log(`Menú guardado exitosamente con ID: ${menuId}`);\n        resolve();\n      };\n      \n      request.onerror = (e) => {\n        console.error('Error al guardar el menú:', e.target.error);\n        reject(e.target.error);\n      };\n    });\n    \n    // Añadir logs de depuración\n    console.log('[saveMenu] Items a guardar:', menuItems.length);\n    console.log('[saveMenu] Items especiales:', menuItems.filter(item => item.isSpecial).length);\n    console.log('[saveMenu] Items regulares:', menuItems.filter(item => !item.isSpecial).length);\n    \n    // Sincronizar información del negocio con el backend\n    await syncBusinessInfoWithBackend();\n    \n    return menuId;\n  } catch (error) {\n    console.error('Error al guardar el menú compartido:', error);\n    throw error;\n  }\n}\n\n/**\n * Obtiene un menú compartido por su ID\n * @param {String} menuId - ID del menú compartido\n * @returns {Promise<Object>} - Datos del menú compartido\n */\nexport async function getSharedMenu(menuId) {\n  try {\n    console.log(`Intentando recuperar menú con ID: ${menuId}`);\n    \n    // Verificar que tenemos un ID válido\n    if (!menuId) {\n      console.error('ID de menú no proporcionado');\n      return null;\n    }\n\n    // Intentar primero recuperar el menú desde IndexedDB como respaldo\n    let menuData = null;\n    try {\n      const menuUtils = await import('./menuUtils');\n      const localMenu = await menuUtils.getMenuFromIndexedDB(menuId);\n      if (localMenu && localMenu.items && localMenu.items.length > 0) {\n        console.log('Menú recuperado desde IndexedDB:', localMenu);\n        menuData = localMenu;\n      }\n    } catch (localError) {\n      console.warn('No se pudo obtener el menú desde IndexedDB:', localError);\n    }\n\n    // Si no hay datos locales o queremos asegurarnos de tener la versión más reciente,\n    // intentamos obtener el menú desde el servidor\n    if (!menuData || !menuData.items || menuData.items.length === 0) {\n      console.log(`Obteniendo menú desde el servidor con ID: ${menuId}`);\n      \n      try {\n        // Importamos apiService usando import dinámico para evitar problemas de dependencia circular\n        const apiService = await import('./apiService');\n        \n        // Hacemos la petición al servidor para obtener el menú\n        const response = await apiService.default.get(`/platos/menu/${menuId}`);\n        \n        if (response && response.success && response.data) {\n          console.log('Menú recuperado desde el servidor:', response.data);\n          menuData = response.data;\n        } else {\n          console.warn('No se pudo obtener el menú desde el servidor:', response);\n          \n          // Si no pudimos obtener el menú desde el servidor y tenemos datos locales, usamos los datos locales\n          if (!menuData) {\n            throw new Error('No se pudo obtener el menú');\n          }\n        }\n      } catch (serverError) {\n        console.error('Error al obtener el menú desde el servidor:', serverError);\n        \n        // Si no pudimos obtener el menú desde el servidor y no tenemos datos locales, intentamos obtenerlo desde la caché\n        if (!menuData) {\n          // Intentar recuperar de localStorage como último recurso\n          try {\n            const cachedMenu = localStorage.getItem(`menu_${menuId}`);\n            if (cachedMenu) {\n              menuData = JSON.parse(cachedMenu);\n              console.log('Menú recuperado desde localStorage:', menuData);\n            } else {\n              throw new Error('No se encontró el menú en la caché');\n            }\n          } catch (cacheError) {\n            console.error('Error al recuperar menú desde la caché:', cacheError);\n            throw new Error('No se pudo obtener el menú');\n          }\n        }\n      }\n    }\n    \n    // Si el menú no tiene información de negocio, intentar obtenerla\n    if (menuData && !menuData.businessInfo) {\n      try {\n        const businessInfo = await getBusinessInfo();\n        menuData.businessInfo = businessInfo;\n      } catch (businessError) {\n        console.warn('No se pudo obtener información del negocio:', businessError);\n        // Usar información por defecto si no se puede obtener\n        menuData.businessInfo = {\n          name: 'Restaurante WebSAP',\n          description: 'Deliciosa comida para todos los gustos',\n          contact: 'info@websap.com',\n          address: 'Calle Principal #123',\n          logo: null,\n          paymentInfo: {\n            qrImage: null,\n            qrTitle: 'Escanea para pagar',\n            nequiNumber: null,\n            nequiImage: null,\n            bankInfo: 'Banco XYZ - Cuenta 123456789',\n            otherPaymentMethods: 'Aceptamos efectivo y tarjetas'\n          }\n        };\n      }\n    }\n    \n    // Asegurarse de que businessInfo siempre tenga un objeto paymentInfo\n    if (menuData && menuData.businessInfo && !menuData.businessInfo.paymentInfo) {\n      menuData.businessInfo.paymentInfo = {\n        qrImage: null,\n        qrTitle: 'Escanea para pagar',\n        nequiNumber: null,\n        nequiImage: null,\n        bankInfo: 'Banco XYZ - Cuenta 123456789',\n        otherPaymentMethods: 'Aceptamos efectivo y tarjetas'\n      };\n    }\n    \n    // Guardar en localStorage para tener un respaldo\n    try {\n      localStorage.setItem(`menu_${menuId}`, JSON.stringify(menuData));\n    } catch (saveError) {\n      console.warn('No se pudo guardar el menú en localStorage:', saveError);\n    }\n    \n    // Añadir logs de depuración con verificaciones de seguridad\n    console.log('[getSharedMenu] Menú recuperado:', menuData);\n    \n    // Usar el operador de encadenamiento opcional para evitar errores\n    const specialItems = menuData?.items?.filter(i => i.isSpecial) || [];\n    const regularItems = menuData?.items?.filter(i => !i.isSpecial) || [];\n    \n    console.log('[getSharedMenu] Items especiales:', specialItems.length);\n    console.log('[getSharedMenu] Items regulares:', regularItems.length);\n    \n    return menuData;\n  } catch (error) {\n    console.error('Error al obtener el menú compartido:', error);\n    throw error;\n  }\n}\n\n/**\n * Alias para getSharedMenu para mantener compatibilidad con código existente\n * @param {String} menuId - ID del menú compartido\n * @returns {Promise<Object>} - Datos del menú compartido\n */\nexport async function getMenu(menuId) {\n  console.log('Intentando recuperar menú con ID:', menuId);\n  try {\n    const db = await openDatabase();\n    const tx = db.transaction('sharedMenus', 'readonly');\n    const store = tx.objectStore('sharedMenus');\n    \n    // Obtener el menú de la base de datos\n    const request = store.get(menuId);\n    const result = await new Promise((resolve, reject) => {\n      request.onsuccess = () => {\n        console.log('Resultado de búsqueda del menú:', request.result);\n        resolve(request.result);\n      };\n      \n      request.onerror = (e) => {\n        console.error('Error al recuperar el menú:', e.target.error);\n        reject(e.target.error);\n      };\n    });\n    \n    // Verificar si se encontró el menú\n    if (!result) {\n      console.warn(`No se encontró menú con ID: ${menuId}`);\n      return null;\n    }\n    \n    // Verificar si el menú tiene items y es un array\n    if (result && result.items && Array.isArray(result.items)) {\n      console.log('[menuService] Procesando items en getMenu()');\n      \n      // Procesar cada item para normalizar isSpecial\n      const processedItems = result.items.map(item => {\n        // Si isSpecial no existe, asignar false por defecto\n        if (item.isSpecial === undefined) {\n          console.log(`[menuService] Item ${item.name || 'sin nombre'} sin propiedad isSpecial, asignando false`);\n          return { ...item, isSpecial: false };\n        }\n        \n        // Normalizar isSpecial a un valor booleano\n        const normalizedIsSpecial = \n          item.isSpecial === true || \n          item.isSpecial === 'true' || \n          item.isSpecial === 1 || \n          item.isSpecial === '1';\n        \n        if (typeof item.isSpecial !== 'boolean') {\n          console.log(`[menuService] Normalizando isSpecial para ${item.name}: ${item.isSpecial} (${typeof item.isSpecial}) → ${normalizedIsSpecial}`);\n        }\n        \n        return { ...item, isSpecial: normalizedIsSpecial };\n      });\n      \n      console.log(`[menuService] Procesados ${processedItems.length} items:`, \n        processedItems.map(i => ({ name: i.name, isSpecial: i.isSpecial })));\n      \n      // Devolver el objeto completo con los items procesados\n      return {\n        ...result,\n        items: processedItems\n      }; // Devuelve el objeto completo con los items procesados\n    } else {\n      console.warn('El menú no tiene items o no es un array:', result);\n      \n      // Si no tiene items, devolver el resultado tal cual\n      return result;\n    }\n  } catch (error) {\n    console.error('Error al obtener menú compartido:', error);\n    throw error;\n  }\n}\n\n/**\n * Guarda un menú compartido en IndexedDB\n * @param {Object} menuData - Datos del menú a guardar\n * @returns {Promise<void>}\n */\nexport async function saveSharedMenu(menuData) {\n  try {\n    if (!menuData || !menuData.id) {\n      throw new Error('Datos de menú inválidos');\n    }\n    \n    console.log(`Guardando menú compartido con ID: ${menuData.id}`);\n    \n    // Guardar en IndexedDB\n    const db = await openDatabase();\n    const transaction = db.transaction([SHARED_MENU_STORE], 'readwrite');\n    const store = transaction.objectStore(SHARED_MENU_STORE);\n    \n    await new Promise((resolve, reject) => {\n      const request = store.put(menuData);\n      \n      request.onsuccess = () => {\n        console.log(`Menú compartido guardado exitosamente con ID: ${menuData.id}`);\n        resolve();\n      };\n      \n      request.onerror = (e) => {\n        console.error('Error al guardar el menú compartido:', e.target.error);\n        reject(e.target.error);\n      };\n    });\n    \n    console.log('[saveSharedMenu] Menú guardado en IndexedDB');\n    \n  } catch (error) {\n    console.error('Error al guardar el menú compartido en IndexedDB:', error);\n    throw error;\n  }\n}\n\n/**\n * Limpia menús antiguos que ya no son necesarios\n * @returns {Promise<void>}\n */\nexport async function cleanOldMenus() {\n  try {\n    const db = await openDatabase();\n    const transaction = db.transaction([SHARED_MENU_STORE], 'readwrite');\n    const store = transaction.objectStore(SHARED_MENU_STORE);\n    \n    const now = new Date();\n    const allMenus = await new Promise((resolve, reject) => {\n      const request = store.getAll();\n      \n      request.onsuccess = () => {\n        resolve(request.result);\n      };\n      \n      request.onerror = (e) => {\n        console.error('Error al obtener menús:', e.target.error);\n        reject(e.target.error);\n      };\n    });\n    \n    // Eliminar menús más antiguos de 7 días\n    const menusToDelete = allMenus.filter(menu => {\n      const createdDate = new Date(menu.createdAt);\n      const diff = now.getTime() - createdDate.getTime();\n      const days = Math.ceil(diff / (1000 * 3600 * 24));\n      return days > 7;\n    });\n    \n    for (const menu of menusToDelete) {\n      store.delete(menu.id);\n    }\n    \n    console.log(`Se eliminaron ${menusToDelete.length} menús antiguos`);\n  } catch (error) {\n    console.error('Error al limpiar menús antiguos:', error);\n  }\n}\n\n// Añadir después de getSharedMenu\nexport async function syncMenuAvailability(menuId) {\n  try {\n    const sharedMenu = await getSharedMenu(menuId);\n    if (!sharedMenu || !sharedMenu.items) return null;\n\n    // Actualizar la disponibilidad de cada item\n    const updatedItems = await Promise.all(sharedMenu.items.map(async (item) => {\n      const availability = await checkItemAvailability(item.id);\n      return {\n        ...item,\n        availableQuantity: availability.quantity\n      };\n    }));\n\n    // Actualizar el menú con las nuevas disponibilidades\n    const db = await openDatabase();\n    const transaction = db.transaction([SHARED_MENU_STORE], 'readwrite');\n    const store = transaction.objectStore(SHARED_MENU_STORE);\n\n    const updatedMenu = {\n      ...sharedMenu,\n      items: updatedItems,\n      lastSync: new Date().toISOString()\n    };\n\n    await store.put(updatedMenu);\n    return updatedMenu;\n  } catch (error) {\n    console.error('Error al sincronizar disponibilidad:', error);\n    return null;\n  }\n}\n\n/**\n * Sincroniza la información del negocio con el backend\n * @param {Object} businessInfo - Información del negocio a sincronizar\n * @returns {Promise<Object>} - Resultado de la sincronización\n */\nexport async function syncBusinessInfoWithBackend(businessInfo) {\n  try {\n    console.log('Sincronizando información del negocio con el backend:', businessInfo);\n    \n    // Verificar que tenemos información válida\n    if (!businessInfo || Object.keys(businessInfo).length === 0) {\n      console.error('No hay información del negocio para sincronizar');\n      return { success: false, message: 'No hay información del negocio para sincronizar' };\n    }\n    \n    // Importar apiService dinámicamente para evitar dependencias circulares\n    const apiServiceModule = await import('./apiService');\n    const apiService = apiServiceModule.default;\n    \n    // Asegurarse de que el token esté configurado\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.setToken(token);\n    }\n    \n    // Obtener el ID del restaurante del usuario actual\n    const userResponse = await apiService.get('/auth/me');\n    if (!userResponse || !userResponse.success || !userResponse.user || !userResponse.user.restaurante_id) {\n      console.warn('No se pudo obtener el restaurante del usuario actual');\n      return { success: false, message: 'No se pudo obtener el restaurante del usuario actual' };\n    }\n    \n    const restauranteId = userResponse.user.restaurante_id;\n    \n    // Asegurarse de que paymentInfo sea un objeto válido\n    const paymentInfo = businessInfo.paymentInfo || {\n      qrImage: null,\n      qrTitle: 'Escanea para pagar',\n      nequiNumber: null,\n      nequiImage: null,\n      bankInfo: 'Banco XYZ - Cuenta 123456789',\n      otherPaymentMethods: 'Aceptamos efectivo y tarjetas'\n    };\n    \n    // Preparar los datos para actualizar el restaurante\n    const restauranteData = {\n      nombre: businessInfo.name || '',\n      descripcion: businessInfo.description || '',\n      direccion: businessInfo.address || '',\n      telefono: businessInfo.contact || '',\n      logo: businessInfo.logo || null,\n      informacion_pago: JSON.stringify(paymentInfo)\n    };\n    \n    console.log('Datos a enviar al backend:', restauranteData);\n    \n    // Actualizar el restaurante en el backend\n    const response = await apiService.put(`/restaurantes/${restauranteId}`, restauranteData);\n    \n    if (response && response.success) {\n      console.log('Información del negocio sincronizada con éxito');\n      return { success: true, message: 'Información del negocio sincronizada con éxito' };\n    } else {\n      console.warn('Error al sincronizar información del negocio:', response);\n      return { success: false, message: response.message || 'Error al sincronizar información del negocio' };\n    }\n  } catch (error) {\n    console.error('Error al sincronizar información del negocio:', error);\n    return { success: false, message: error.message || 'Error al sincronizar información del negocio' };\n  }\n}\n","<template>\n  <div class=\"reservas-section\">\n    <button @click=\"toggleReservaForm\" class=\"toggle-reserva-button\">\n      {{ showReservaForm ? 'Ocultar Formulario de Reserva' : 'Hacer una Reserva' }}\n    </button>\n    \n    <div v-if=\"showReservaForm\" class=\"reserva-form-container\">\n      <h3>Reserva tu Mesa</h3>\n      <form @submit.prevent=\"processReservation\" class=\"reserva-form\">\n        <div class=\"form-group\">\n          <label for=\"fullName\">Nombre Completo *</label>\n          <input \n            type=\"text\" \n            id=\"fullName\" \n            v-model=\"reservationData.fullName\" \n            placeholder=\"Ingresa tu nombre completo\"\n            required\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"mobilePhone\">Teléfono Móvil *</label>\n          <input \n            type=\"tel\" \n            id=\"mobilePhone\" \n            v-model=\"reservationData.mobilePhone\" \n            placeholder=\"Ej. 612345678\"\n            required\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"landlinePhone\">Teléfono Fijo</label>\n          <input \n            type=\"tel\" \n            id=\"landlinePhone\" \n            v-model=\"reservationData.landlinePhone\" \n            placeholder=\"Opcional\"\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"address\">Dirección</label>\n          <input \n            type=\"text\" \n            id=\"address\" \n            v-model=\"reservationData.address\" \n            placeholder=\"Tu dirección (opcional)\"\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"email\">Correo Electrónico</label>\n          <input \n            type=\"email\" \n            id=\"email\" \n            v-model=\"reservationData.email\" \n            placeholder=\"ejemplo@correo.com (opcional)\"\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"reservationDate\">Fecha de Reserva *</label>\n          <input \n            type=\"date\" \n            id=\"reservationDate\" \n            v-model=\"reservationData.date\" \n            required\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"reservationTime\">Hora de Reserva *</label>\n          <input \n            type=\"time\" \n            id=\"reservationTime\" \n            v-model=\"reservationData.time\" \n            required\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"peopleCount\">Número de Personas *</label>\n          <input \n            type=\"number\" \n            id=\"peopleCount\" \n            v-model=\"reservationData.peopleCount\" \n            min=\"1\" \n            max=\"20\" \n            required\n          >\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"specialNotes\">Notas Adicionales</label>\n          <textarea \n            id=\"specialNotes\" \n            v-model=\"reservationData.notes\" \n            placeholder=\"Instrucciones especiales, preferencias, etc.\"\n            rows=\"3\"\n          ></textarea>\n        </div>\n        \n        <div class=\"form-actions\">\n          <button \n            type=\"submit\" \n            class=\"submit-button\" \n            :disabled=\"isProcessing\"\n          >\n            {{ isProcessing ? 'Procesando...' : 'Reservar Mesa' }}\n          </button>\n          <button \n            type=\"button\" \n            class=\"clear-button\" \n            @click=\"clearForm\"\n            :disabled=\"isProcessing\"\n          >\n            Limpiar\n          </button>\n        </div>\n      </form>\n    </div>\n    \n    <!-- Toast de notificación -->\n    <div v-if=\"toast.show\" class=\"toast-notification\" :class=\"toast.type\">\n      {{ toast.message }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, watch } from 'vue';\nimport eventBus from '@/utils/eventBus';\nimport { saveReservation, saveWhatsAppReservation } from '../../services/reservaService';\n\nexport default {\n  name: 'ReservaForm',\n  setup() {\n    console.log('ReservaForm montado');\n    // Estado para mostrar/ocultar el formulario\n    const showReservaForm = ref(false);\n    \n    // Estado para los datos de la reserva\n    const reservationData = reactive({\n      fullName: '',\n      mobilePhone: '',\n      landlinePhone: '',\n      address: '',\n      email: '',\n      date: '',\n      time: '',\n      peopleCount: 1,\n      notes: ''\n    });\n    \n    // Estado para el procesamiento de la reserva\n    const isProcessing = ref(false);\n    \n    // Estado para las notificaciones toast\n    const toast = reactive({\n      show: false,\n      message: '',\n      type: 'info'\n    });\n    \n    // Función para alternar la visibilidad del formulario\n    const toggleReservaForm = () => {\n      showReservaForm.value = !showReservaForm.value;\n    };\n    \n    // Función para mostrar mensajes toast\n    const showToast = (message, type = 'info') => {\n      toast.message = message;\n      toast.type = type;\n      toast.show = true;\n      \n      // Ocultar el toast después de 5 segundos\n      setTimeout(() => {\n        toast.show = false;\n      }, 5000);\n    };\n    \n    // Función para validar el formulario\n    const validateForm = () => {\n      if (!reservationData.fullName.trim()) {\n        showToast('Por favor, ingresa tu nombre completo', 'error');\n        return false;\n      }\n      \n      if (!reservationData.mobilePhone.trim()) {\n        showToast('Por favor, ingresa un número de teléfono móvil', 'error');\n        return false;\n      }\n      \n      if (!reservationData.date) {\n        showToast('Por favor, selecciona una fecha para la reserva', 'error');\n        return false;\n      }\n      \n      if (!reservationData.time) {\n        showToast('Por favor, selecciona una hora para la reserva', 'error');\n        return false;\n      }\n      \n      if (!reservationData.peopleCount || reservationData.peopleCount < 1) {\n        showToast('Por favor, indica el número de personas', 'error');\n        return false;\n      }\n      \n      return true;\n    };\n    \n    // Función para procesar la reserva\n    const processReservation = async () => {\n      if (!validateForm()) return;\n      \n      try {\n        isProcessing.value = true;\n        \n        // Construir el objeto de reserva para el sistema\n        const reservationObject = {\n          fullName: reservationData.fullName,\n          mobilePhone: reservationData.mobilePhone,\n          landlinePhone: reservationData.landlinePhone || '',\n          email: reservationData.email || '',\n          address: reservationData.address || '',\n          date: reservationData.date,\n          time: reservationData.time,\n          peopleCount: reservationData.peopleCount,\n          notes: reservationData.notes || '',\n          status: 'pending',\n          source: 'menu'\n        };\n        \n        console.log('Enviando reserva al sistema:', reservationObject);\n        \n        // Preparar datos para WhatsApp (formato que espera el handler)\n        const whatsappData = {\n          nombre: reservationData.fullName,\n          telefono: reservationData.mobilePhone,\n          email: reservationData.email || '',\n          fecha: reservationData.date,\n          hora: reservationData.time,\n          personas: reservationData.peopleCount,\n          notas: `Reserva desde menú compartido: ${reservationData.notes || 'Sin notas adicionales'}`\n        };\n        \n        console.log('Enviando reserva como mensaje de WhatsApp:', whatsappData);\n        \n        // Enviar la reserva al sistema como si viniera de WhatsApp\n        // Esto garantiza que aparezca en la sección de Gestión de Reservas\n        const whatsappResult = await saveWhatsAppReservation(whatsappData);\n        \n        console.log('Resultado de envío como WhatsApp:', whatsappResult);\n        \n        if (!whatsappResult.success) {\n          throw new Error(whatsappResult.error || 'Error al guardar la reserva');\n        }\n        \n        // Construir mensaje para WhatsApp (opcional, para que el cliente pueda confirmar)\nconst message = `\n📅 *NUEVA RESERVA DE MESA*\n---------------------------\n👤 *Nombre:* ${reservationData.fullName}\n📱 *Teléfono móvil:* ${reservationData.mobilePhone}\n${reservationData.landlinePhone ? `☎️ *Teléfono fijo:* ${reservationData.landlinePhone}` : ''}\n${reservationData.email ? `✉️ *Email:* ${reservationData.email}` : ''}\n📆 *Fecha:* ${reservationData.date}\n⏰ *Hora:* ${reservationData.time}\n👥 *Personas:* ${reservationData.peopleCount}\n${reservationData.notes ? `📝 *Notas:* ${reservationData.notes}` : ''}\n---------------------------\n🌐 Esta reserva fue realizada a través del sistema de reservas online.\n`;\n\n        \n        // Abrir WhatsApp con el mensaje (opcional)\n          const encodedMessage = encodeURIComponent(message);\n          const whatsappUrl = `https://api.whatsapp.com/send?text=${encodedMessage}`;\n          window.open(whatsappUrl, '_blank');\n\n        \n        // Mostrar mensaje de éxito\n        showToast('¡Reserva enviada correctamente! También puedes confirmarla por WhatsApp.', 'success');\n        \n        // Limpiar el formulario\n        clearForm();\n        \n      } catch (error) {\n        console.error('Error al procesar la reserva:', error);\n        showToast('Hubo un error al procesar tu reserva. Por favor, intenta nuevamente.', 'error');\n      } finally {\n        isProcessing.value = false;\n      }\n    };\n    \n    // Función para limpiar el formulario\n    const clearForm = () => {\n      reservationData.fullName = '';\n      reservationData.mobilePhone = '';\n      reservationData.landlinePhone = '';\n      reservationData.address = '';\n      reservationData.email = '';\n      reservationData.date = '';\n      reservationData.time = '';\n      reservationData.peopleCount = 1;\n      reservationData.notes = '';\n    };\n    \n    return {\n      showReservaForm,\n      reservationData,\n      isProcessing,\n      toast,\n      toggleReservaForm,\n      processReservation,\n      clearForm\n    };\n  }\n};\n</script>\n\n<style scoped>\n.reservas-section {\n  margin: 40px 0;\n  position: relative;\n  border: 5px solid red;  /* Borde rojo brillante para depuración */\n  padding: 20px;\n  background-color: rgb(165, 229, 245);  /* Fondo amarillo para depuración */\n}\n\n.toggle-reserva-button {\n  background-color: #4CAF50;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 10px 15px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  display: block;\n  margin: 0 auto 20px;\n}\n\n.toggle-reserva-button:hover {\n  background-color: #388E3C;\n}\n\n.reserva-form-container {\n  background-color: #f8f8f8;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 30px;\n  border: 1px solid #e0e0e0;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.reserva-form-container h3 {\n  color: #333;\n  margin-top: 0;\n  margin-bottom: 20px;\n  border-bottom: 2px solid #4CAF50;\n  padding-bottom: 10px;\n}\n\n.reserva-form {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 15px;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n  color: #333;\n}\n\n.form-group input,\n.form-group textarea {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 16px;\n  transition: border-color 0.3s;\n}\n\n.form-group input:focus,\n.form-group textarea:focus {\n  border-color: #4CAF50;\n  outline: none;\n}\n\n.form-actions {\n  grid-column: 1 / -1;\n  display: flex;\n  justify-content: center;\n  gap: 10px;\n  margin-top: 20px;\n}\n\n.submit-button {\n  background-color: #4CAF50;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 12px 24px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.submit-button:hover {\n  background-color: #388E3C;\n}\n\n.clear-button {\n  background-color: #f44336;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 12px 24px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.clear-button:hover {\n  background-color: #d32f2f;\n}\n\n.toast-notification {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  padding: 15px 20px;\n  border-radius: 4px;\n  color: white;\n  font-weight: bold;\n  z-index: 1000;\n  animation: slideIn 0.3s ease, fadeOut 0.5s 4.5s ease forwards;\n  max-width: 300px;\n}\n\n.toast-notification.info {\n  background-color: #2196F3;\n}\n\n.toast-notification.success {\n  background-color: #4CAF50;\n}\n\n.toast-notification.error {\n  background-color: #f44336;\n}\n\n@keyframes slideIn {\n  from { transform: translateX(100%); }\n  to { transform: translateX(0); }\n}\n\n@keyframes fadeOut {\n  from { opacity: 1; }\n  to { opacity: 0; }\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n  .reserva-form {\n    grid-template-columns: 1fr;\n  }\n  \n  .form-actions {\n    flex-direction: column;\n  }\n  \n  .submit-button, .clear-button {\n    width: 100%;\n  }\n}\n</style>","import { render } from \"./ReservaForm.vue?vue&type=template&id=732333be&scoped=true\"\nimport script from \"./ReservaForm.vue?vue&type=script&lang=js\"\nexport * from \"./ReservaForm.vue?vue&type=script&lang=js\"\n\nimport \"./ReservaForm.vue?vue&type=style&index=0&id=732333be&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-732333be\"]])\n\nexport default __exports__","import { render } from \"./SharedMenuView.vue?vue&type=template&id=50a3da36&scoped=true\"\nimport script from \"./SharedMenuView.vue?vue&type=script&lang=js\"\nexport * from \"./SharedMenuView.vue?vue&type=script&lang=js\"\n\nimport \"./SharedMenuView.vue?vue&type=style&index=0&id=50a3da36&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-50a3da36\"]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\n\nvar $TypeError = TypeError;\n\n// `Iterator.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.reduce\n$({ target: 'Iterator', proto: true, real: true }, {\n  reduce: function reduce(reducer /* , initialValue */) {\n    anObject(this);\n    aCallable(reducer);\n    var record = getIteratorDirect(this);\n    var noInitial = arguments.length < 2;\n    var accumulator = noInitial ? undefined : arguments[1];\n    var counter = 0;\n    iterate(record, function (value) {\n      if (noInitial) {\n        noInitial = false;\n        accumulator = value;\n      } else {\n        accumulator = reducer(accumulator, value, counter);\n      }\n      counter++;\n    }, { IS_RECORD: true });\n    if (noInitial) throw new $TypeError('Reduce of empty iterator with no initial value');\n    return accumulator;\n  }\n});\n"],"names":["SYNC_INTERVAL","CACHE_DURATION","syncIntervalId","lastSyncTimestamp","lastFetchTimestamp","businessInfoCache","isInitialized","async","syncBusinessInfoWithBackend","businessInfo","getBusinessInfo","Object","keys","length","console","log","success","message","token","localStorage","getItem","apiService","setToken","userResponse","get","user","restaurante_id","warn","restauranteId","restauranteData","nombre","name","descripcion","description","direccion","address","telefono","contact","logo","informacion_pago","JSON","stringify","paymentInfo","response","put","Date","now","eventBus","emit","timestamp","error","fetchBusinessInfoFromBackend","forceUpdate","Error","restaurante","parse","e","saveBusinessInfo","localError","checkForBusinessInfoChanges","localInfo","backendInfo","localString","backendString","hasChanges","startBusinessInfoSyncInterval","disableSync","clearInterval","catch","setInterval","stopBusinessInfoSyncInterval","runAddInformacionPagoMigration","invalidateBusinessInfoCache","key","class","src","alt","ref","_createElementBlock","id","$setup","menuId","isLoading","_hoisted_2","_cache","_createElementVNode","_hoisted_3","_toDisplayString","_hoisted_4","menuData","_hoisted_5","isValidImage","fixImageFormat","_hoisted_6","_createCommentVNode","_hoisted_7","_hoisted_8","_hoisted_9","_createTextVNode","_hoisted_10","_hoisted_11","_hoisted_12","_Fragment","_renderList","regularItems","item","index","_hoisted_13","image","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","formatPrice","price","includesDrink","_hoisted_19","onClick","$event","addToCart","_normalizeClass","realAvailability","disabled","_hoisted_21","_hoisted_22","_hoisted_20","specialItems","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_33","_hoisted_34","_hoisted_32","_hoisted_35","cartItems","_hoisted_36","_hoisted_37","_hoisted_38","quantity","_hoisted_39","decreaseQuantity","_hoisted_40","_hoisted_41","increaseQuantity","_hoisted_42","removeFromCart","_hoisted_43","_hoisted_44","cartTotal","_hoisted_45","_hoisted_46","type","customerInfo","placeholder","_hoisted_47","phone","_hoisted_48","email","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","selectedPaymentMethod","value","_hoisted_53","_hoisted_54","_hoisted_55","additionalMessage","_hoisted_56","args","completeOrder","scrollToOrder","_hoisted_57","totalItems","hasPaymentInfo","_hoisted_58","_hoisted_59","qrImage","_hoisted_60","qrTitle","_hoisted_61","nequiNumber","nequiImage","_hoisted_62","_hoisted_63","_hoisted_64","bankInfo","_hoisted_65","_hoisted_66","otherPaymentMethods","_hoisted_67","_hoisted_68","_hoisted_69","_createVNode","_component_ReservaForm","toast","visible","_hoisted_1","getSharedMenu","menuUtils","localMenu","getMenuFromIndexedDB","items","default","data","serverError","cachedMenu","cacheError","businessError","setItem","saveError","filter","i","isSpecial","toggleReservaForm","showReservaForm","onSubmit","_withModifiers","processReservation","for","reservationData","fullName","required","mobilePhone","landlinePhone","date","time","peopleCount","min","max","notes","rows","isProcessing","clearForm","show","setup","reactive","showToast","setTimeout","validateForm","trim","reservationObject","status","source","whatsappData","fecha","hora","personas","notas","whatsappResult","saveWhatsAppReservation","encodedMessage","encodeURIComponent","whatsappUrl","window","open","__exports__","components","ReservaForm","props","String","route","useRoute","computed","params","isProcessingOrder","lastBusinessInfoUpdate","timeoutId","onMounted","loadMenu","on","handleBusinessInfoUpdate","onUnmounted","off","clearTimeout","updatedInfo","savedCart","businessInfoError","forEach","availableQuantity","undefined","Number","updateAvailabilityInMenu","apiError","reduce","total","isNaN","numero","toFixed","parteEntera","parteDecimal","split","parteEnteraFormateada","replace","isAvailable","checkAvailability","existingItem","find","push","toString","saveCartToLocalStorage","duration","menuItem","splice","updateInventory","openWhatsAppShare","removeItem","shareOrderByWhatsApp","whatsappMessage","subtotal","formaPago","orderSection","document","querySelector","scrollIntoView","behavior","baseAvailability","cartItem","cartQuantity","currentMenu","getMenuItems","Array","isArray","itemsToProcess","updateResults","hasErrors","getSoldItems","saveSoldItems","soldItemsList","soldItemsError","currentQuantity","parseInt","soldQuantity","newQuantity","Math","updateSuccess","updateItemAvailability","oldQuantity","currentDate","toISOString","existingSoldItem","itemError","successCount","r","failedItems","map","join","imageString","startsWith","includes","filtered","showReservationForm","isProcessingReservation","reservationSuccess","reservationError","orderDate","getCurrentDate","reservationDate","reservationTime","additionalNotes","today","year","getFullYear","month","getMonth","padStart","day","getDate","submitReservation","result","saveReservation","resetReservationForm","cancelReservation","refreshBusinessInfo","render","$","iterate","aCallable","anObject","getIteratorDirect","$TypeError","TypeError","target","proto","real","reducer","this","record","noInitial","arguments","accumulator","counter","IS_RECORD"],"sourceRoot":""}